<html>
<!-- Mirrored from www.redsaga.com/spring_ref/2.0RC2/html/aop.html by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 17 Oct 2006 16:56:31 GMT -->
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;6.&nbsp;&#20351;&#29992;Spring&#36827;&#34892;&#38754;&#21521;&#20999;&#38754;&#32534;&#31243;&#65288;AOP&#65289;</title><link rel="stylesheet" href="http://www.redsaga.com/spring_ref/2.0RC2/styles/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.60.1"><link rel="home" href="index.html" title="Spring Framework &#24320;&#21457;&#21442;&#32771;&#25163;&#20876;"><link rel="up" href="pt01.html" title="Part&nbsp;I.&nbsp;&#26680;&#24515;&#25216;&#26415;"><link rel="previous" href="validation.html" title="Chapter&nbsp;5.&nbsp;&#23646;&#24615;&#32534;&#36753;&#22120;&#65292;&#25968;&#25454;&#32465;&#23450;&#65292;&#26657;&#39564;&#19982;BeanWrapper"><link rel="next" href="aop-api.html" title="Chapter&nbsp;7.&nbsp;Spring AOP APIs"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" style="background-color:#31430f;border:none;height:110px;border:1px solid black;"><a style="border:none;background: url();" href="http://www.springframework.org/" title="The Spring Framework"><img style="border:none;" src="images/banner4.jpg"></a><a style="border:none;background: url();" href="http://www.interface21.com/" title="Interface21 - Spring from the Source"><img style="border:none;position:absolute;right:32px;" src="images/bannerR.gif"></a></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="aop"></a>Chapter&nbsp;6.&nbsp;&#20351;&#29992;Spring&#36827;&#34892;&#38754;&#21521;&#20999;&#38754;&#32534;&#31243;&#65288;AOP&#65289;</h2></div></div><div></div></div>
   <table align="center">
<tr>
<td>
<script type="text/javascript"><!--
google_ad_client = "pub-2627642070897863";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text_image";
//2006-10-13: com_336x280
google_ad_channel = "7652836435";
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
<td>
<script type="text/javascript"><!--
google_ad_client = "pub-2627642070897863";
google_ad_width = 336;
google_ad_height = 280;
google_ad_format = "336x280_as";
google_ad_type = "text_image";
//2006-10-13: com_336x280
google_ad_channel = "7652836435";
google_color_border = "FFFFFF";
google_color_bg = "FFFFFF";
google_color_link = "0000FF";
google_color_text = "000000";
google_color_url = "000000";
//--></script>
<script type="text/javascript"
  src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</td>
</tr>
</table>
   <div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-introduction"></a>6.1.&nbsp;&#31616;&#20171;</h2></div></div><div></div></div><p>
			<span class="emphasis"><em>&#38754;&#21521;&#20999;&#38754;&#32534;&#31243;</em></span>&#65288;<span class="emphasis"><em>AOP</em></span>&#65289;&#25552;&#20379;&#21478;&#22806;&#19968;&#31181;&#35282;&#24230;&#26469;&#24605;&#32771;&#31243;&#24207;&#32467;&#26500;&#65292;&#36890;&#36807;&#36825;&#31181;&#26041;&#24335;&#24357;&#34917;&#20102;&#38754;&#21521;&#23545;&#35937;&#32534;&#31243;&#65288;OOP&#65289;&#30340;&#19981;&#36275;&#12290;
			&#38500;&#20102;&#31867;&#65288;classes&#65289;&#20197;&#22806;&#65292;AOP&#25552;&#20379;&#20102; <span class="emphasis"><em>&#20999;&#38754;</em></span>&#12290;&#20999;&#38754;&#23545;&#20851;&#27880;&#28857;&#36827;&#34892;&#27169;&#22359;&#21270;&#65292;&#20363;&#22914;&#27178;&#20999;&#22810;&#20010;&#31867;&#22411;&#21644;&#23545;&#35937;&#30340;&#20107;&#21153;&#31649;&#29702;&#12290;
			&#65288;&#36825;&#20123;&#20851;&#27880;&#28857;&#26415;&#35821;&#36890;&#24120;&#31216;&#20316; <span class="emphasis"><em>&#27178;&#20999;&#65288;crosscutting&#65289;</em></span> &#20851;&#27880;&#28857;&#12290;&#65289;
			</p><p>
		Spring&#30340;&#19968;&#20010;&#20851;&#38190;&#30340;&#32452;&#20214;&#23601;&#26159; <span class="emphasis"><em>AOP&#26694;&#26550;</em></span>&#12290;
		&#23613;&#31649;&#22914;&#27492;&#65292;Spring IoC&#23481;&#22120;&#24182;&#19981;&#20381;&#36182;&#20110;AOP&#65292;&#36825;&#24847;&#21619;&#30528;&#20320;&#21487;&#20197;&#33258;&#30001;&#36873;&#25321;&#26159;&#21542;&#20351;&#29992;AOP&#65292;AOP&#25552;&#20379;&#24378;&#22823;&#30340;&#20013;&#38388;&#20214;&#35299;&#20915;&#26041;&#26696;&#65292;&#36825;&#20351;&#24471;Spring IoC&#23481;&#22120;&#26356;&#21152;&#23436;&#21892;&#12290;
		</p><div class="sidebar"><p class="title"><b>Spring 2.0 AOP</b></p><p>
			Spring 2.0 &#24341;&#20837;&#20102;&#19968;&#31181;&#26356;&#21152;&#31616;&#21333;&#24182;&#19988;&#26356;&#24378;&#22823;&#30340;&#26041;&#24335;&#26469;&#33258;&#23450;&#20041;&#20999;&#38754;&#65292;&#29992;&#25143;&#21487;&#20197;&#36873;&#25321;&#20351;&#29992;&#22522;&#20110;&#27169;&#24335;&#65288;schema-based&#65289;&#30340;&#26041;&#24335;&#25110;&#32773;&#20351;&#29992;@AspectJ&#27880;&#35299;&#12290;
			&#23545;&#20110;&#26032;&#30340;&#24212;&#29992;&#31243;&#24207;&#65292;&#22914;&#26524;&#29992;&#25143;&#20351;&#29992;Java 5&#24320;&#21457;&#65292;&#25105;&#20204;&#25512;&#33616;&#29992;&#25143;&#20351;&#29992;@AspectJ&#39118;&#26684;&#65292;&#21542;&#21017;&#21487;&#20197;&#20351;&#29992;&#22522;&#20110;&#27169;&#24335;&#30340;&#39118;&#26684;&#12290;
			&#36825;&#20004;&#31181;&#39118;&#26684;&#37117;&#23436;&#20840;&#25903;&#25345;&#36890;&#30693;&#65288;Advice&#65289;&#31867;&#22411;&#21644;AspectJ&#30340;&#20999;&#20837;&#28857;&#35821;&#35328;&#65292;&#34429;&#28982;&#23454;&#38469;&#19978;&#20173;&#28982;&#20351;&#29992;Spring AOP&#36827;&#34892;&#32455;&#20837;&#65288;Weaving&#65289;&#12290;
			</p><p>
			&#26412;&#31456;&#20027;&#35201;&#35752;&#35770;Spring 2.0&#23545;&#22522;&#20110;&#27169;&#24335;&#21644;&#22522;&#20110;@AspectJ&#30340;AOP&#25903;&#25345;&#12290;
			Spring 2.0&#23436;&#20840;&#20445;&#30041;&#20102;&#23545;Spring 1.2&#30340;&#21521;&#19979;&#20860;&#23481;&#24615;&#65292;<a href="aop-api.html" title="Chapter&nbsp;7.&nbsp;Spring AOP APIs">&#19979;&#19968;&#31456;</a> &#23558;&#35752;&#35770;Spring 1.2 API&#25152;&#25552;&#20379;&#30340;&#24213;&#23618;&#30340;AOP&#25903;&#25345;&#12290;
			</p></div><p>Spring&#20013;&#25152;&#20351;&#29992;&#30340;AOP&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>
				&#25552;&#20379;&#22768;&#26126;&#24335;&#20225;&#19994;&#26381;&#21153;&#65292;&#29305;&#21035;&#26159;&#20026;&#20102;&#26367;&#20195;EJB&#22768;&#26126;&#24335;&#26381;&#21153;&#12290;
				&#26368;&#37325;&#35201;&#30340;&#26381;&#21153;&#26159; <a href="transaction.html#transaction-declarative" title="9.5.&nbsp;&#22768;&#26126;&#24335;&#20107;&#21153;&#31649;&#29702;">
						<span class="emphasis"><em>&#22768;&#26126;&#24615;&#20107;&#21153;&#31649;&#29702;&#65288;declarative transaction management&#65289;</em></span>
					</a>&#65292;
				&#36825;&#20010;&#26381;&#21153;&#24314;&#31435;&#22312;Spring&#30340;&#25277;&#35937;&#20107;&#21153;&#31649;&#29702;&#65288;transaction abstraction&#65289;&#20043;&#19978;&#12290;
				</p></li><li><p>&#20801;&#35768;&#29992;&#25143;&#23454;&#29616;&#33258;&#23450;&#20041;&#30340;&#20999;&#38754;&#65292;&#29992;AOP&#26469;&#23436;&#21892;OOP&#30340;&#20351;&#29992;&#12290;</p></li></ul></div><p>
		&#36825;&#26679;&#20320;&#21487;&#20197;&#25226;Spring AOP&#30475;&#20316;&#26159;&#23545;Spring&#30340;&#19968;&#31181;&#22686;&#24378;&#65292;&#23427;&#20351;&#24471;Spring&#21487;&#20197;&#19981;&#38656;&#35201;EJB&#23601;&#33021;&#25552;&#20379;&#22768;&#26126;&#24335;&#20107;&#21153;&#31649;&#29702;&#65307;&#25110;&#32773;&#20063;&#21487;&#20197;&#20351;&#29992;Spring AOP&#26694;&#26550;&#30340;&#20840;&#37096;&#21151;&#33021;&#26469;&#23454;&#29616;&#33258;&#23450;&#20041;&#30340;&#20999;&#38754;&#12290;
		</p><p>
		&#26412;&#31456;&#39318;&#20808; <a href="aop.html#aop-introduction-defn" title="6.1.1.&nbsp;AOP&#27010;&#24565;"> &#20171;&#32461;&#20102;AOP&#30340;&#27010;&#24565;</a>&#65292;&#26080;&#35770;&#20320;&#25171;&#31639;&#37319;&#29992;&#21738;&#31181;&#39118;&#26684;&#30340;&#20999;&#38754;&#22768;&#26126;&#65292;&#36825;&#20010;&#37096;&#20998;&#37117;&#20540;&#24471;&#20320;&#19968;&#35835;&#12290;
		&#26412;&#31456;&#21097;&#19979;&#30340;&#37096;&#20998;&#23558;&#30528;&#37325;&#20110;Spring 2.0&#23545;AOP&#30340;&#25903;&#25345;&#65307;
		<a href="aop-api.html" title="Chapter&nbsp;7.&nbsp;Spring AOP APIs">&#19979;&#19968;&#31456;</a> &#25552;&#20379;&#20102;&#20851;&#20110;Spring 1.2&#39118;&#26684;&#30340;AOP&#27010;&#36848;&#65292;&#20063;&#35768;&#20320;&#24050;&#32463;&#22312;&#20854;&#20182;&#20070;&#26412;&#65292;&#25991;&#31456;&#20197;&#21450;&#24050;&#26377;&#30340;&#24212;&#29992;&#31243;&#24207;&#20013;&#30896;&#21040;&#36807;&#36825;&#31181;AOP&#39118;&#26684;&#12290;
		</p><i><span class="remark">
		&#22914;&#26524;&#20320;&#21482;&#25171;&#31639;&#20351;&#29992;&#36890;&#29992;&#30340;&#22768;&#26126;&#24335;&#26381;&#21153;&#25110;&#32773;&#39044;&#20808;&#25171;&#21253;&#30340;&#22768;&#26126;&#24335;&#20013;&#38388;&#20214;&#26381;&#21153;&#65292;&#20363;&#22914;&#32531;&#20914;&#27744;&#65288;pooling&#65289;&#65292;
		&#37027;&#20040;&#20320;&#19981;&#24517;&#19981;&#30452;&#25509;&#20351;&#29992;Spring AOP&#65292;&#32780;&#26412;&#31456;&#30340;&#22823;&#37096;&#20998;&#20869;&#23481;&#20063;&#21487;&#20197;&#30452;&#25509;&#36339;&#36807;&#12290;
		</span></i><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-introduction-defn"></a>6.1.1.&nbsp;AOP&#27010;&#24565;</h3></div></div><div></div></div><p>
			&#39318;&#20808;&#35753;&#25105;&#20204;&#20174;&#23450;&#20041;&#19968;&#20123;&#37325;&#35201;&#30340;AOP&#27010;&#24565;&#24320;&#22987;&#12290;&#36825;&#20123;&#26415;&#35821;&#19981;&#26159;Spring&#29305;&#26377;&#30340;&#12290;
			&#19981;&#24184;&#30340;&#26159;&#65292;Spring&#26415;&#35821;&#24182;&#19981;&#26159;&#29305;&#21035;&#30340;&#30452;&#35266;&#65307;&#22914;&#26524;Spring&#20351;&#29992;&#33258;&#24049;&#30340;&#26415;&#35821;&#65292;&#23558;&#20250;&#21464;&#24471;&#26356;&#21152;&#20196;&#20154;&#22256;&#24785;&#12290;
			</p><div class="itemizedlist"><ul type="disc"><li><p>
						<span class="emphasis"><em>&#20999;&#38754;&#65288;Aspect&#65289;</em></span>&#65306;
					&#19968;&#20010;&#20851;&#27880;&#28857;&#30340;&#27169;&#22359;&#21270;&#65292;&#36825;&#20010;&#20851;&#27880;&#28857;&#21487;&#33021;&#20250;&#27178;&#20999;&#22810;&#20010;&#23545;&#35937;&#12290;&#20107;&#21153;&#31649;&#29702;&#26159;J2EE&#24212;&#29992;&#20013;&#19968;&#20010;&#20851;&#20110;&#27178;&#20999;&#20851;&#27880;&#28857;&#30340;&#24456;&#22909;&#30340;&#20363;&#23376;&#12290;
					&#22312;Spring AOP&#20013;&#65292;&#20999;&#38754;&#21487;&#20197;&#20351;&#29992;&#36890;&#29992;&#31867;&#65288;&#22522;&#20110;&#27169;&#24335;&#30340;&#39118;&#26684;&#65289;
					&#25110;&#32773;&#22312;&#26222;&#36890;&#31867;&#20013;&#20197; <tt class="interfacename">@Aspect</tt> &#27880;&#35299;&#65288;<tt class="interfacename">@AspectJ</tt>&#39118;&#26684;&#65289;&#26469;&#23454;&#29616;&#12290;
				  </p></li><li><p>
						<span class="emphasis"><em>&#36830;&#25509;&#28857;&#65288;Joinpoint&#65289;</em></span>&#65306;
					&#22312;&#31243;&#24207;&#25191;&#34892;&#36807;&#31243;&#20013;&#26576;&#20010;&#29305;&#23450;&#30340;&#28857;&#65292;&#27604;&#22914;&#26576;&#26041;&#27861;&#35843;&#29992;&#30340;&#26102;&#20505;&#25110;&#32773;&#22788;&#29702;&#24322;&#24120;&#30340;&#26102;&#20505;&#12290;
					&#22312;Spring AOP&#20013;&#65292;&#19968;&#20010;&#36830;&#25509;&#28857; <span class="emphasis"><em>&#24635;&#26159;</em></span> &#20195;&#34920;&#19968;&#20010;&#26041;&#27861;&#30340;&#25191;&#34892;&#12290;
					&#36890;&#36807;&#22768;&#26126;&#19968;&#20010; <tt class="interfacename">org.aspectj.lang.JoinPoint</tt> &#31867;&#22411;&#30340;&#21442;&#25968;&#21487;&#20197;&#20351;&#36890;&#30693;&#65288;Advice&#65289;&#30340;&#20027;&#20307;&#37096;&#20998;&#33719;&#24471;&#36830;&#25509;&#28857;&#20449;&#24687;&#12290;
					</p></li><li><p>
						<span class="emphasis"><em>&#36890;&#30693;&#65288;Advice&#65289;</em></span>&#65306;
					&#22312;&#20999;&#38754;&#30340;&#26576;&#20010;&#29305;&#23450;&#30340;&#36830;&#25509;&#28857;&#65288;Joinpoint&#65289;&#19978;&#25191;&#34892;&#30340;&#21160;&#20316;&#12290;&#36890;&#30693;&#26377;&#21508;&#31181;&#31867;&#22411;&#65292;&#20854;&#20013;&#21253;&#25324;&#8220;around&#8221;&#12289;&#8220;before&#8221;&#21644;&#8220;after&#8221;&#31561;&#36890;&#30693;&#12290;
					&#36890;&#30693;&#30340;&#31867;&#22411;&#23558;&#22312;&#21518;&#38754;&#37096;&#20998;&#36827;&#34892;&#35752;&#35770;&#12290;&#35768;&#22810;AOP&#26694;&#26550;&#65292;&#21253;&#25324;Spring&#65292;&#37117;&#26159;&#20197;<span class="emphasis"><em>&#25318;&#25130;&#22120;</em></span>&#20570;&#36890;&#30693;&#27169;&#22411;&#65292;&#24182;&#32500;&#25252;&#19968;&#20010;&#20197;&#36830;&#25509;&#28857;&#20026;&#20013;&#24515;&#30340;&#25318;&#25130;&#22120;&#38142;&#12290;
					</p></li><li><p>
						<span class="emphasis"><em>&#20999;&#20837;&#28857;&#65288;Pointcut&#65289;</em></span>&#65306;
					&#21305;&#37197;&#36830;&#25509;&#28857;&#65288;Joinpoint&#65289;&#30340;&#26029;&#35328;&#12290;&#36890;&#30693;&#21644;&#19968;&#20010;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#20851;&#32852;&#65292;&#24182;&#22312;&#28385;&#36275;&#36825;&#20010;&#20999;&#20837;&#28857;&#30340;&#36830;&#25509;&#28857;&#19978;&#36816;&#34892;&#65288;&#20363;&#22914;&#65292;&#24403;&#25191;&#34892;&#26576;&#20010;&#29305;&#23450;&#21517;&#31216;&#30340;&#26041;&#27861;&#26102;&#65289;&#12290;
					&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#22914;&#20309;&#21644;&#36830;&#25509;&#28857;&#21305;&#37197;&#26159;AOP&#30340;&#26680;&#24515;&#65306;Spring&#32570;&#30465;&#20351;&#29992;AspectJ&#20999;&#20837;&#28857;&#35821;&#27861;&#12290;
					</p></li><li><p>
						<span class="emphasis"><em>&#24341;&#20837;&#65288;Introduction&#65289;</em></span>&#65306;
					&#65288;&#20063;&#34987;&#31216;&#20026;&#20869;&#37096;&#31867;&#22411;&#22768;&#26126;&#65288;inter-type declaration&#65289;&#65289;&#12290;&#22768;&#26126;&#39069;&#22806;&#30340;&#26041;&#27861;&#25110;&#32773;&#26576;&#20010;&#31867;&#22411;&#30340;&#23383;&#27573;&#12290;
					Spring&#20801;&#35768;&#24341;&#20837;&#26032;&#30340;&#25509;&#21475;&#65288;&#20197;&#21450;&#19968;&#20010;&#23545;&#24212;&#30340;&#23454;&#29616;&#65289;&#21040;&#20219;&#20309;&#34987;&#20195;&#29702;&#30340;&#23545;&#35937;&#12290;
					&#20363;&#22914;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;&#19968;&#20010;&#24341;&#20837;&#26469;&#20351;bean&#23454;&#29616; <tt class="literal">IsModified</tt> &#25509;&#21475;&#65292;&#20197;&#20415;&#31616;&#21270;&#32531;&#23384;&#26426;&#21046;&#12290;
					</p></li><li><p>
						<span class="emphasis"><em>&#30446;&#26631;&#23545;&#35937;&#65288;Target Object&#65289;</em></span>&#65306;
					&#34987;&#19968;&#20010;&#25110;&#32773;&#22810;&#20010;&#20999;&#38754;&#65288;aspect&#65289;&#25152;&#36890;&#30693;&#65288;advise&#65289;&#30340;&#23545;&#35937;&#12290;&#20063;&#26377;&#20154;&#25226;&#23427;&#21483;&#20570; <span class="emphasis"><em>&#34987;&#36890;&#30693;&#65288;advised&#65289;</em></span> &#23545;&#35937;&#12290;
					&#26082;&#28982;Spring AOP&#26159;&#36890;&#36807;&#36816;&#34892;&#26102;&#20195;&#29702;&#23454;&#29616;&#30340;&#65292;&#36825;&#20010;&#23545;&#35937;&#27704;&#36828;&#26159;&#19968;&#20010; <span class="emphasis"><em>&#34987;&#20195;&#29702;&#65288;proxied&#65289;</em></span> &#23545;&#35937;&#12290;
					</p></li><li><p>
						<span class="emphasis"><em>AOP&#20195;&#29702;&#65288;AOP Proxy&#65289;</em></span>&#65306;
					AOP&#26694;&#26550;&#21019;&#24314;&#30340;&#23545;&#35937;&#65292;&#29992;&#26469;&#23454;&#29616;&#20999;&#38754;&#22865;&#32422;&#65288;aspect contract&#65289;&#65288;&#21253;&#25324;&#36890;&#30693;&#26041;&#27861;&#25191;&#34892;&#31561;&#21151;&#33021;&#65289;&#12290;
					&#22312;Spring&#20013;&#65292;AOP&#20195;&#29702;&#21487;&#20197;&#26159;JDK&#21160;&#24577;&#20195;&#29702;&#25110;&#32773;CGLIB&#20195;&#29702;&#12290;
					<i><span class="remark">
					&#27880;&#24847;&#65306;Spring 2.0&#26368;&#26032;&#24341;&#20837;&#30340;&#22522;&#20110;&#27169;&#24335;&#65288;schema-based&#65289;&#39118;&#26684;&#21644;@AspectJ&#27880;&#35299;&#39118;&#26684;&#30340;&#20999;&#38754;&#22768;&#26126;&#65292;&#23545;&#20110;&#20351;&#29992;&#36825;&#20123;&#39118;&#26684;&#30340;&#29992;&#25143;&#26469;&#35828;&#65292;&#20195;&#29702;&#30340;&#21019;&#24314;&#26159;&#36879;&#26126;&#30340;&#12290;
					</span></i>
					</p></li><li><p>
						<span class="emphasis"><em>&#32455;&#20837;&#65288;Weaving&#65289;</em></span>&#65306;
					&#25226;&#20999;&#38754;&#65288;aspect&#65289;&#36830;&#25509;&#21040;&#20854;&#23427;&#30340;&#24212;&#29992;&#31243;&#24207;&#31867;&#22411;&#25110;&#32773;&#23545;&#35937;&#19978;&#65292;&#24182;&#21019;&#24314;&#19968;&#20010;&#34987;&#36890;&#30693;&#65288;advised&#65289;&#30340;&#23545;&#35937;&#12290;
					&#36825;&#20123;&#21487;&#20197;&#22312;&#32534;&#35793;&#26102;&#65288;&#20363;&#22914;&#20351;&#29992;AspectJ&#32534;&#35793;&#22120;&#65289;&#65292;&#31867;&#21152;&#36733;&#26102;&#21644;&#36816;&#34892;&#26102;&#23436;&#25104;&#12290;
					Spring&#21644;&#20854;&#20182;&#32431;Java AOP&#26694;&#26550;&#19968;&#26679;&#65292;&#22312;&#36816;&#34892;&#26102;&#23436;&#25104;&#32455;&#20837;&#12290;
					</p></li></ul></div><p>&#36890;&#30693;&#30340;&#31867;&#22411;&#65306;</p><div class="itemizedlist"><ul type="disc"><li><p>
						<span class="emphasis"><em>&#21069;&#32622;&#36890;&#30693;&#65288;Before advice&#65289;</em></span>&#65306;
						&#22312;&#26576;&#36830;&#25509;&#28857;&#65288;join point&#65289;&#20043;&#21069;&#25191;&#34892;&#30340;&#36890;&#30693;&#65292;&#20294;&#36825;&#20010;&#36890;&#30693;&#19981;&#33021;&#38459;&#27490;&#36830;&#25509;&#28857;&#21069;&#30340;&#25191;&#34892;&#65288;&#38500;&#38750;&#23427;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#65289;&#12290;
					</p></li><li><p>
						<span class="emphasis"><em>&#36820;&#22238;&#21518;&#36890;&#30693;&#65288;After returning advice&#65289;</em></span>&#65306;
						&#22312;&#26576;&#36830;&#25509;&#28857;&#65288;join point&#65289;&#27491;&#24120;&#23436;&#25104;&#21518;&#25191;&#34892;&#30340;&#36890;&#30693;&#65306;&#20363;&#22914;&#65292;&#19968;&#20010;&#26041;&#27861;&#27809;&#26377;&#25243;&#20986;&#20219;&#20309;&#24322;&#24120;&#65292;&#27491;&#24120;&#36820;&#22238;&#12290;
					</p></li><li><p>
						<span class="emphasis"><em>&#25243;&#20986;&#24322;&#24120;&#21518;&#36890;&#30693;&#65288;After throwing advice&#65289;</em></span>&#65306;
						&#22312;&#26041;&#27861;&#25243;&#20986;&#24322;&#24120;&#36864;&#20986;&#26102;&#25191;&#34892;&#30340;&#36890;&#30693;&#12290;
					</p></li><li><p>
						<span class="emphasis"><em>&#21518;&#36890;&#30693;&#65288;After (finally) advice&#65289;</em></span>&#65306;
						&#24403;&#26576;&#36830;&#25509;&#28857;&#36864;&#20986;&#30340;&#26102;&#20505;&#25191;&#34892;&#30340;&#36890;&#30693;&#65288;&#19981;&#35770;&#26159;&#27491;&#24120;&#36820;&#22238;&#36824;&#26159;&#24322;&#24120;&#36864;&#20986;&#65289;&#12290;
		  			</p></li><li><p>
						<span class="emphasis"><em>&#29615;&#32469;&#36890;&#30693;&#65288;Around Advice&#65289;</em></span>&#65306;
						&#21253;&#22260;&#19968;&#20010;&#36830;&#25509;&#28857;&#65288;join point&#65289;&#30340;&#36890;&#30693;&#65292;&#22914;&#26041;&#27861;&#35843;&#29992;&#12290;&#36825;&#26159;&#26368;&#24378;&#22823;&#30340;&#19968;&#31181;&#36890;&#30693;&#31867;&#22411;&#12290;
						&#29615;&#32469;&#36890;&#30693;&#21487;&#20197;&#22312;&#26041;&#27861;&#35843;&#29992;&#21069;&#21518;&#23436;&#25104;&#33258;&#23450;&#20041;&#30340;&#34892;&#20026;&#12290;&#23427;&#20063;&#20250;&#36873;&#25321;&#26159;&#21542;&#32487;&#32493;&#25191;&#34892;&#36830;&#25509;&#28857;&#25110;&#30452;&#25509;&#36820;&#22238;&#23427;&#20204;&#33258;&#24049;&#30340;&#36820;&#22238;&#20540;&#25110;&#25243;&#20986;&#24322;&#24120;&#26469;&#32467;&#26463;&#25191;&#34892;&#12290;
		  			</p></li></ul></div><p>
	  		&#29615;&#32469;&#36890;&#30693;&#26159;&#26368;&#24120;&#29992;&#30340;&#19968;&#31181;&#36890;&#30693;&#31867;&#22411;&#12290;&#22823;&#37096;&#20998;&#22522;&#20110;&#25318;&#25130;&#30340;AOP&#26694;&#26550;&#65292;&#20363;&#22914;Nanning&#21644;JBoss4&#65292;&#37117;&#21482;&#25552;&#20379;&#29615;&#32469;&#36890;&#30693;&#12290;
	  		</p><p>
			&#36319;AspectJ&#19968;&#26679;&#65292;Spring&#25552;&#20379;&#25152;&#26377;&#31867;&#22411;&#30340;&#36890;&#30693;&#65292;&#25105;&#20204;&#25512;&#33616;&#20320;&#20351;&#29992;&#23613;&#37327;&#31616;&#21333;&#30340;&#36890;&#30693;&#31867;&#22411;&#26469;&#23454;&#29616;&#38656;&#35201;&#30340;&#21151;&#33021;&#12290;
			&#20363;&#22914;&#65292;&#22914;&#26524;&#20320;&#21482;&#26159;&#38656;&#35201;&#29992;&#19968;&#20010;&#26041;&#27861;&#30340;&#36820;&#22238;&#20540;&#26469;&#26356;&#26032;&#32531;&#23384;&#65292;&#34429;&#28982;&#20351;&#29992;&#29615;&#32469;&#36890;&#30693;&#20063;&#33021;&#23436;&#25104;&#21516;&#26679;&#30340;&#20107;&#24773;&#65292;
			&#20294;&#26159;&#20320;&#26368;&#22909;&#20351;&#29992;After returning&#36890;&#30693;&#32780;&#19981;&#26159;&#29615;&#32469;&#36890;&#30693;&#12290;
			&#29992;&#26368;&#21512;&#36866;&#30340;&#36890;&#30693;&#31867;&#22411;&#21487;&#20197;&#20351;&#24471;&#32534;&#31243;&#27169;&#22411;&#21464;&#24471;&#31616;&#21333;&#65292;&#24182;&#19988;&#33021;&#22815;&#36991;&#20813;&#24456;&#22810;&#28508;&#22312;&#30340;&#38169;&#35823;&#12290;
			&#27604;&#22914;&#65292;&#20320;&#19981;&#38656;&#35201;&#35843;&#29992; <tt class="interfacename">JoinPoint</tt>&#65288;&#29992;&#20110;Around Advice&#65289;&#30340; <tt class="literal">proceed()</tt> &#26041;&#27861;&#65292;&#23601;&#19981;&#20250;&#26377;&#35843;&#29992;&#30340;&#38382;&#39064;&#12290;
			</p><p>
	  		&#22312;Spring 2.0&#20013;&#65292;&#25152;&#26377;&#30340;&#36890;&#30693;&#21442;&#25968;&#37117;&#26159;&#38745;&#24577;&#31867;&#22411;&#65292;&#22240;&#27492;&#20320;&#21487;&#20197;&#20351;&#29992;&#21512;&#36866;&#30340;&#31867;&#22411;&#65288;&#20363;&#22914;&#19968;&#20010;&#26041;&#27861;&#25191;&#34892;&#21518;&#30340;&#36820;&#22238;&#20540;&#31867;&#22411;&#65289;&#20316;&#20026;&#36890;&#30693;&#30340;&#21442;&#25968;&#32780;&#19981;&#26159;&#20351;&#29992;&#19968;&#20010;&#23545;&#35937;&#25968;&#32452;&#12290;
			</p><p> 
			&#20999;&#20837;&#28857;&#65288;pointcut&#65289;&#21644;&#36830;&#25509;&#28857;&#65288;join point&#65289;&#21305;&#37197;&#30340;&#27010;&#24565;&#26159;AOP&#30340;&#20851;&#38190;&#65292;&#36825;&#20351;&#24471;AOP&#19981;&#21516;&#20110;&#20854;&#23427;&#20165;&#20165;&#25552;&#20379;&#25318;&#25130;&#21151;&#33021;&#30340;&#26087;&#25216;&#26415;&#12290; &#20999;&#20837;&#28857;&#20351;&#24471;&#23450;&#20301;&#36890;&#30693;&#65288;advice&#65289;&#21487;&#29420;&#31435;&#20110;OO&#23618;&#27425;&#12290;
			&#20363;&#22914;&#65292;&#19968;&#20010;&#25552;&#20379;&#22768;&#26126;&#24335;&#20107;&#21153;&#31649;&#29702;&#30340;around&#36890;&#30693;&#21487;&#20197;&#34987;&#24212;&#29992;&#21040;&#19968;&#32452;&#27178;&#36328;&#22810;&#20010;&#23545;&#35937;&#20013;&#30340;&#26041;&#27861;&#19978;&#65288;&#20363;&#22914;&#26381;&#21153;&#23618;&#30340;&#25152;&#26377;&#19994;&#21153;&#25805;&#20316;&#65289;&#12290;
	  </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-introduction-spring-defn"></a>6.1.2.&nbsp;Spring AOP&#30340;&#21151;&#33021;&#21644;&#30446;&#26631;</h3></div></div><div></div></div><p>
			Spring AOP&#29992;&#32431;Java&#23454;&#29616;&#12290;&#23427;&#19981;&#38656;&#35201;&#19987;&#38376;&#30340;&#32534;&#35793;&#36807;&#31243;&#12290;Spring AOP&#19981;&#38656;&#35201;&#25511;&#21046;&#31867;&#35013;&#36733;&#22120;&#23618;&#27425;&#65292;&#22240;&#27492;&#23427;&#36866;&#29992;&#20110;J2EE web&#23481;&#22120;&#25110;&#24212;&#29992;&#26381;&#21153;&#22120;&#12290;
	  		</p><p>
			Spring&#30446;&#21069;&#20165;&#25903;&#25345;&#20351;&#29992;&#26041;&#27861;&#35843;&#29992;&#20316;&#20026;&#36830;&#25509;&#28857;&#65288;join point&#65289;&#65288;&#22312;Spring bean&#19978;&#36890;&#30693;&#26041;&#27861;&#30340;&#25191;&#34892;&#65289;&#12290;
			&#34429;&#28982;&#21487;&#20197;&#22312;&#19981;&#24433;&#21709;&#21040;Spring AOP&#26680;&#24515;API&#30340;&#24773;&#20917;&#19979;&#21152;&#20837;&#23545;&#25104;&#21592;&#21464;&#37327;&#25318;&#25130;&#22120;&#25903;&#25345;&#65292;&#20294;Spring&#24182;&#27809;&#26377;&#23454;&#29616;&#25104;&#21592;&#21464;&#37327;&#25318;&#25130;&#22120;&#12290;
			&#22914;&#26524;&#20320;&#38656;&#35201;&#25226;&#23545;&#25104;&#21592;&#21464;&#37327;&#30340;&#35775;&#38382;&#21644;&#26356;&#26032;&#20063;&#20316;&#20026;&#36890;&#30693;&#30340;&#36830;&#25509;&#28857;&#65292;&#21487;&#20197;&#32771;&#34385;&#20854;&#23427;&#35821;&#27861;&#30340;Java&#35821;&#35328;&#65292;&#20363;&#22914;AspectJ&#12290;
	  		</p><p>
			Spring&#23454;&#29616;AOP&#30340;&#26041;&#27861;&#36319;&#20854;&#20182;&#30340;&#26694;&#26550;&#19981;&#21516;&#12290;Spring&#24182;&#19981;&#26159;&#35201;&#23581;&#35797;&#25552;&#20379;&#26368;&#23436;&#25972;&#30340;AOP&#23454;&#29616;&#65288;&#23613;&#31649;Spring AOP&#26377;&#36825;&#20010;&#33021;&#21147;&#65289;&#65292;
			&#30456;&#21453;&#30340;&#65292;&#23427;&#20854;&#23454;&#20391;&#37325;&#20110;&#25552;&#20379;&#19968;&#31181;AOP&#23454;&#29616;&#21644;Spring IoC&#23481;&#22120;&#30340;&#25972;&#21512;&#65292;&#29992;&#20110;&#24110;&#21161;&#35299;&#20915;&#22312;&#20225;&#19994;&#32423;&#24320;&#21457;&#20013;&#30340;&#24120;&#35265;&#38382;&#39064;&#12290;
			</p><p>
			&#22240;&#27492;&#65292;Spring AOP&#36890;&#24120;&#37117;&#21644;Spring IoC&#23481;&#22120;&#19968;&#36215;&#20351;&#29992;&#12290;
			Aspect&#20351;&#29992;&#26222;&#36890;&#30340;bean&#23450;&#20041;&#35821;&#27861;&#65288;&#23613;&#31649;Spring&#25552;&#20379;&#20102;&#24378;&#22823;&#30340;&#8220;&#33258;&#21160;&#20195;&#29702;&#65288;autoproxying&#65289;&#8221;&#21151;&#33021;&#65289;&#65306;
			&#19982;&#20854;&#20182;AOP&#23454;&#29616;&#30456;&#27604;&#36825;&#26159;&#19968;&#20010;&#26174;&#33879;&#30340;&#21306;&#21035;&#12290;&#26377;&#20123;&#20107;&#20351;&#29992;Spring AOP&#26159;&#26080;&#27861;&#36731;&#26494;&#25110;&#32773;&#39640;&#25928;&#30340;&#23436;&#25104;&#30340;&#65292;&#27604;&#22914;&#35828;&#36890;&#30693;&#19968;&#20010;&#32454;&#31890;&#24230;&#30340;&#23545;&#35937;&#12290;
			&#36825;&#31181;&#26102;&#20505;&#65292;&#20351;&#29992;AspectJ&#26159;&#26368;&#22909;&#30340;&#36873;&#25321;&#12290;&#19981;&#36807;&#32463;&#39564;&#21578;&#35785;&#25105;&#20204;&#65306;
			&#20110;&#22823;&#22810;&#25968;&#22312;J2EE&#24212;&#29992;&#20013;&#36935;&#21040;&#30340;&#38382;&#39064;&#65292;&#21482;&#35201;&#36866;&#21512;AOP&#26469;&#35299;&#20915;&#30340;&#65292;Spring AOP&#37117;&#27809;&#26377;&#38382;&#39064;&#65292;Spring AOP&#25552;&#20379;&#20102;&#19968;&#20010;&#38750;&#24120;&#22909;&#30340;&#35299;&#20915;&#26041;&#26696;&#12290;
			</p><p>
			Spring AOP&#20174;&#26469;&#27809;&#26377;&#25171;&#31639;&#36890;&#36807;&#25552;&#20379;&#19968;&#31181;&#20840;&#38754;&#30340;AOP&#35299;&#20915;&#26041;&#26696;&#26469;&#21462;&#20195;AspectJ&#12290;
			&#25105;&#20204;&#30456;&#20449;&#26080;&#35770;&#26159;&#22522;&#20110;&#20195;&#29702;&#65288;proxy-based &#65289;&#30340;&#26694;&#26550;&#27604;&#22914;&#35828;Spring&#20134;&#25110;&#26159;full-blown&#30340;&#26694;&#26550;&#27604;&#22914;&#35828;&#26159;AspectJ&#37117;&#26159;&#24456;&#26377;&#20215;&#20540;&#30340;&#65292;&#20182;&#20204;&#20043;&#38388;&#30340;&#20851;&#31995;&#24212;&#35813;&#26159;&#20114;&#34917;&#32780;&#19981;&#26159;&#31454;&#20105;&#30340;&#20851;&#31995;&#12290;
			Spring 2.0&#21487;&#20197;&#26080;&#32541;&#30340;&#25972;&#21512;Spring AOP&#65292;IoC &#21644;AspectJ&#65292;&#20351;&#24471;&#25152;&#26377;&#30340;AOP&#24212;&#29992;&#23436;&#20840;&#34701;&#20837;&#22522;&#20110;Spring&#30340;&#24212;&#29992;&#20307;&#31995;&#12290;
			&#36825;&#26679;&#30340;&#38598;&#25104;&#19981;&#20250;&#24433;&#21709;Spring AOP API&#25110;&#32773;AOP Alliance API&#65307;Spring AOP&#20445;&#30041;&#20102;&#21521;&#19979;&#20860;&#23481;&#24615;&#12290;&#25509;&#19979;&#26469;&#30340;&#19968;&#31456;&#20250;&#35814;&#32454;&#35752;&#35770;Spring AOP API&#12290;
			</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-introduction-proxies"></a>6.1.3.&nbsp;Spring&#30340;AOP&#20195;&#29702;</h3></div></div><div></div></div><p>Spring&#32570;&#30465;&#20351;&#29992;J2SE <span class="emphasis"><em>&#21160;&#24577;&#20195;&#29702;&#65288;dynamic proxies&#65289;</em></span>&#26469;&#20316;&#20026;AOP&#30340;&#20195;&#29702;&#12290;&#36825;&#26679;&#20219;&#20309;&#25509;&#21475;&#37117;&#21487;&#20197;&#34987;&#20195;&#29702;&#12290;
	  </p><p>
			Spring&#20063;&#25903;&#25345;&#20351;&#29992;CGLIB&#20195;&#29702;. &#23545;&#20110;&#38656;&#35201;&#20195;&#29702;&#31867;&#32780;&#19981;&#26159;&#20195;&#29702;&#25509;&#21475;&#30340;&#26102;&#20505;CGLIB&#20195;&#29702;&#26159;&#24456;&#26377;&#24517;&#35201;&#30340;&#12290;
			&#22914;&#26524;&#19968;&#20010;&#19994;&#21153;&#23545;&#35937;&#24182;&#27809;&#26377;&#23454;&#29616;&#19968;&#20010;&#25509;&#21475;&#65292;&#40664;&#35748;&#23601;&#20250;&#20351;&#29992;CGLIB&#12290;
			&#27492;&#22806;&#65292;<span class="emphasis"><em>&#38754;&#21521;&#25509;&#21475;&#32534;&#31243;</em></span> &#20063;&#26159;&#19968;&#20010;&#26368;&#20339;&#23454;&#36341;&#65292;&#19994;&#21153;&#23545;&#35937;&#36890;&#24120;&#37117;&#20250;&#23454;&#29616;&#19968;&#20010;&#25110;&#22810;&#20010;&#25509;&#21475;&#12290;
			</p><p>&#27492;&#22806;&#65292;&#36824;&#21487;&#20197;&#24378;&#21046;&#30340;&#20351;&#29992;CGLIB&#65306;&#25105;&#20204;&#23558;&#20250;&#22312;&#20197;&#21518;&#35752;&#35770;&#36825;&#20010;&#38382;&#39064;&#65292;&#35299;&#37322;&#38382;&#20160;&#20040;&#20320;&#20250;&#35201;&#36825;&#20040;&#20570;&#12290;</p><i><span class="remark">
			&#22312;Spring 2.0&#20043;&#21518;&#65292;Spring&#21487;&#33021;&#20250;&#25552;&#20379;&#22810;&#31181;&#20854;&#20182;&#31867;&#22411;&#30340;AOP&#20195;&#29702;&#65292;&#21253;&#25324;&#20102;&#23436;&#25972;&#30340;&#29983;&#25104;&#31867;&#12290;&#36825;&#19981;&#20250;&#24433;&#21709;&#21040;&#32534;&#31243;&#27169;&#22411;&#12290;
	  		</span></i></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-ataspectj"></a>6.2.&nbsp;@AspectJ&#25903;&#25345;</h2></div></div><div></div></div><p>
		&#22914;&#26524;&#20320;&#20351;&#29992;Java 5&#30340;&#35805;&#65292;&#25512;&#33616;&#20351;&#29992;Spring&#25552;&#20379;&#30340;@AspectJ&#20999;&#38754;&#25903;&#25345;&#65292;&#36890;&#36807;&#36825;&#31181;&#26041;&#24335;&#22768;&#26126;Spring AOP&#20013;&#20351;&#29992;&#30340;&#20999;&#38754;&#12290;
		"@AspectJ"&#20351;&#29992;&#20102;Java 5&#30340;&#27880;&#35299;&#65292;&#21487;&#20197;&#23558;&#20999;&#38754;&#22768;&#26126;&#20026;&#26222;&#36890;&#30340;Java&#31867;&#12290;
		AspectJ 5&#21457;&#24067;&#30340; <a href="http://www.eclipse.org/aspectj" target="_top">AspectJ project</a> &#20013;&#24341;&#20837;&#20102;&#36825;&#31181;@AspectJ&#39118;&#26684;&#12290;
		Spring 2.0 &#20351;&#29992;&#20102;&#21644;AspectJ 5&#19968;&#26679;&#30340;&#27880;&#35299;&#65292;&#20351;&#29992;&#20102;AspectJ &#25552;&#20379;&#30340;&#19968;&#20010;&#24211;&#26469;&#20570;&#20999;&#28857;&#65288;pointcut&#65289;&#35299;&#26512;&#21644;&#21305;&#37197;&#12290;
		&#20294;&#26159;&#65292;AOP&#22312;&#36816;&#34892;&#26102;&#20173;&#26087;&#26159;&#32431;&#30340;Spring AOP&#65292;&#24182;&#19981;&#20381;&#36182;&#20110;AspectJ &#30340;&#32534;&#35793;&#22120;&#25110;&#32773;&#32455;&#20837;&#22120;&#65288;weaver&#65289;&#12290;
		</p><i><span class="remark">
		&#20351;&#29992;AspectJ&#30340;&#32534;&#35793;&#22120;&#25110;&#32773;&#32455;&#20837;&#22120;&#65288;weaver&#65289;&#30340;&#35805;&#23601;&#21487;&#20197;&#20351;&#29992;&#23436;&#25972;&#30340;AspectJ &#35821;&#35328;&#65292;&#25105;&#20204;&#23558;&#22312; <a href="aop.html#aop-using-aspectj" title="6.7.&nbsp;&#22312;Spring&#24212;&#29992;&#20013;&#20351;&#29992;AspectJ">Section&nbsp;6.7, &#8220;&#22312;Spring&#24212;&#29992;&#20013;&#20351;&#29992;AspectJ&#8221;</a> &#20013;&#35752;&#35770;&#36825;&#20010;&#38382;&#39064;&#12290;
		</span></i><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6707"></a>6.2.1.&nbsp;&#21551;&#29992;@AspectJ&#25903;&#25345;</h3></div></div><div></div></div><p>
			&#20026;&#20102;&#22312;Spring&#37197;&#32622;&#20013;&#20351;&#29992;@AspectJ aspects&#65292;&#20320;&#24517;&#39035;&#39318;&#20808;&#21551;&#29992;Spring&#23545;&#22522;&#20110;@AspectJ aspects&#30340;&#37197;&#32622;&#25903;&#25345;&#65292;<span class="emphasis"><em>&#33258;&#21160;&#20195;&#29702;&#65288;autoproxying&#65289;</em></span>&#22522;&#20110;&#36890;&#30693;&#26159;&#21542;&#26469;&#33258;&#36825;&#20123;&#20999;&#38754;&#12290;
			&#33258;&#21160;&#20195;&#29702;&#26159;&#25351;Spring&#20250;&#21028;&#26029;&#19968;&#20010;bean&#26159;&#21542;&#20351;&#29992;&#20102;&#19968;&#20010;&#25110;&#22810;&#20010;&#20999;&#38754;&#36890;&#30693;&#65292;&#24182;&#25454;&#27492;&#33258;&#21160;&#29983;&#25104;&#30456;&#24212;&#30340;&#20195;&#29702;&#20197;&#25318;&#25130;&#20854;&#26041;&#27861;&#35843;&#29992;&#65292;&#24182;&#19988;&#30830;&#35748;&#36890;&#30693;&#26159;&#21542;&#22914;&#26399;&#36827;&#34892;&#12290;
			</p><p>&#36890;&#36807;&#22312;&#20320;&#30340;Spring&#30340;&#37197;&#32622;&#20013;&#24341;&#20837;&#19979;&#21015;&#20803;&#32032;&#26469;&#21551;&#29992;Spring&#23545;@AspectJ&#30340;&#25903;&#25345;&#65306;</p><pre class="programlisting">&lt;aop:aspectj-autoproxy/&gt;</pre><p>&#25105;&#20204;&#20551;&#20351;&#20320;&#27491;&#22312;&#20351;&#29992; <a href="xsd-config.html" title="Appendix&nbsp;A.&nbsp;XML Schema-based configuration">Appendix&nbsp;A, <i>XML Schema-based configuration</i></a> &#25152;&#25551;&#36848;&#30340;schema&#25903;&#25345;&#12290;
			&#20851;&#20110;&#22914;&#20309;&#22312;aop&#30340;&#21629;&#21517;&#31354;&#38388;&#20013;&#24341;&#20837;&#36825;&#20123;&#26631;&#31614;&#65292;&#35831;&#21442;&#35265; <a href="xsd-config.html#xsd-config-body-schemas-aop" title="A.2.6.&nbsp;The aop schema">Section&nbsp;A.2.6, &#8220;The aop schema&#8221;</a>
			</p><p>&#22914;&#26524;&#20320;&#27491;&#22312;&#20351;&#29992;DTD&#65292;&#20320;&#20173;&#26087;&#21487;&#20197;&#36890;&#36807;&#22312;&#20320;&#30340;application context&#20013;&#28155;&#21152;&#22914;&#19979;&#23450;&#20041;&#26469;&#21551;&#29992;@AspectJ&#25903;&#25345;&#65306;
			</p><pre class="programlisting">&lt;bean class="org.springframework.aop.aspectj.annotation.AnnotationAwareAspectJAutoProxyCreator" /&gt;</pre><p>
			&#20320;&#38656;&#35201;&#22312;&#20320;&#30340;&#24212;&#29992;&#31243;&#24207;&#30340;classpath&#20013;&#24341;&#20837;&#20004;&#20010;AspectJ&#24211;&#65306;<tt class="literal">aspectjweaver.jar</tt> &#21644; <tt class="literal">aspectjrt.jar</tt>&#12290;
			&#36825;&#20123;&#24211;&#21487;&#20197;&#22312;AspectJ&#30340;&#23433;&#35013;&#21253;&#65288;1.5.1&#25110;&#32773;&#20043;&#21518;&#30340;&#29256;&#26412;&#65289;&#20013;&#30340; <tt class="literal">lib</tt> &#30446;&#24405;&#37324;&#25214;&#21040;&#65292;&#25110;&#32773;&#20063;&#21487;&#20197;&#22312;Spring&#20381;&#36182;&#24211;&#30340; <tt class="literal">lib/aspectj</tt> &#30446;&#24405;&#19979;&#25214;&#21040;&#12290;
			</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6743"></a>6.2.2.&nbsp;&#22768;&#26126;&#19968;&#20010;&#20999;&#38754;</h3></div></div><div></div></div><p>&#22312;&#21551;&#29992;@AspectJ&#25903;&#25345;&#30340;&#24773;&#20917;&#19979;&#65292;&#22312;application context&#20013;&#23450;&#20041;&#30340;&#20219;&#24847;&#24102;&#26377;&#19968;&#20010;@Aspect&#20999;&#38754;&#65288;&#25317;&#26377;<tt class="interfacename">@Aspect</tt>&#27880;&#35299;&#65289;&#30340;bean&#37117;&#23558;&#34987;Spring&#33258;&#21160;&#35782;&#21035;&#24182;&#29992;&#20110;&#37197;&#32622;&#22312;Spring AOP&#12290;
			&#20197;&#19979;&#20363;&#23376;&#23637;&#31034;&#20102;&#20026;&#20102;&#23436;&#25104;&#19968;&#20010;&#19981;&#26159;&#38750;&#24120;&#26377;&#29992;&#30340;&#20999;&#38754;&#25152;&#38656;&#35201;&#30340;&#26368;&#23567;&#23450;&#20041;&#65306;
			</p><p>&#19979;&#38754;&#26159;&#22312;application context&#20013;&#30340;&#19968;&#20010;&#24120;&#35265;&#30340;bean&#23450;&#20041;&#65292;&#36825;&#20010;bean&#25351;&#21521;&#19968;&#20010;&#20351;&#29992;&#20102; <tt class="interfacename">@Aspect</tt> &#27880;&#35299;&#30340;bean&#31867;&#65306;
	  </p><pre class="programlisting">&lt;bean id="myAspect" class="org.xyz.NotVeryUsefulAspect"&gt;
   <i class="lineannotation"><span class="lineannotation">&lt;!-- configure properties of aspect here as normal --&gt;</span></i>
&lt;/bean&gt;
</pre><p>&#19979;&#38754;&#26159; <tt class="classname">NotVeryUsefulAspect</tt> &#31867;&#23450;&#20041;&#65292;&#20351;&#29992;&#20102; <tt class="interfacename">org.aspectj.lang.annotation.Aspect</tt> &#27880;&#35299;&#12290;
	   </p><pre class="programlisting">package org.xyz;
import org.aspectj.lang.annotation.Aspect;

@Aspect
public class NotVeryUsefulAspect {

}</pre><p>
			&#20999;&#38754;&#65288;&#29992; <tt class="interfacename">@Aspect</tt> &#27880;&#35299;&#30340;&#31867;&#65289;&#21644;&#20854;&#20182;&#31867;&#19968;&#26679;&#26377;&#26041;&#27861;&#21644;&#23383;&#27573;&#23450;&#20041;&#12290;&#20182;&#20204;&#20063;&#21487;&#33021;&#21253;&#25324;&#20999;&#20837;&#28857;&#65292;&#36890;&#30693;&#21644;&#24341;&#20837;&#65288;inter-type&#65289;&#22768;&#26126;&#12290;
			</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e6776"></a>6.2.3.&nbsp;&#22768;&#26126;&#19968;&#20010;&#20999;&#20837;&#28857;&#65288;pointcut&#65289;</h3></div></div><div></div></div><p> 
			&#22238;&#24819;&#19968;&#19979;&#65292;&#20999;&#20837;&#28857;&#20915;&#23450;&#20102;&#36830;&#25509;&#28857;&#20851;&#27880;&#30340;&#20869;&#23481;&#65292;&#20351;&#24471;&#25105;&#20204;&#21487;&#20197;&#25511;&#21046;&#36890;&#30693;&#20160;&#20040;&#25191;&#34892;&#12290;
			Spring AOP&#21482;&#25903;&#25345;Spring bean&#26041;&#27861;&#25191;&#34892;&#36830;&#25509;&#28857;&#12290;&#25152;&#20197;&#20320;&#21487;&#20197;&#25226;&#20999;&#20837;&#28857;&#30475;&#20570;&#26159;&#21305;&#37197;Spring bean&#19978;&#30340;&#26041;&#27861;&#25191;&#34892;&#12290;
			&#19968;&#20010;&#20999;&#20837;&#28857;&#22768;&#26126;&#26377;&#20004;&#20010;&#37096;&#20998;&#65306;&#19968;&#20010;&#21253;&#21547;&#21517;&#23383;&#21644;&#20219;&#24847;&#21442;&#25968;&#30340;&#31614;&#21517;&#65292;&#36824;&#26377;&#19968;&#20010;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#65292;&#35813;&#34920;&#36798;&#24335;&#20915;&#23450;&#20102;&#25105;&#20204;&#20851;&#27880;&#37027;&#20010;&#26041;&#27861;&#30340;&#25191;&#34892;&#12290;
			&#22312;@AspectJ&#20013;&#65292;&#19968;&#20010;&#20999;&#20837;&#28857;&#23454;&#38469;&#23601;&#26159;&#19968;&#20010;&#26222;&#36890;&#30340;&#26041;&#27861;&#23450;&#20041;&#25552;&#20379;&#30340;&#19968;&#20010;&#31614;&#21517;&#65292;&#24182;&#19988;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#20351;&#29992; <tt class="interfacename">@Pointcut</tt>&#27880;&#35299;&#26469;&#34920;&#31034;&#12290;
			&#36825;&#20010;&#26041;&#27861;&#30340;&#36820;&#22238;&#31867;&#22411;&#24517;&#39035;&#26159; <tt class="literal">void</tt>&#12290;
			&#22914;&#19979;&#30340;&#20363;&#23376;&#23450;&#20041;&#20102;&#19968;&#20010;&#20999;&#20837;&#28857;<tt class="literal">'transfer'</tt>&#65292;&#36825;&#20010;&#20999;&#20837;&#28857;&#21305;&#37197;&#20102;&#20219;&#24847;&#21517;&#20026;"transfer"&#30340;&#26041;&#27861;&#25191;&#34892;&#65306;
			</p><pre class="programlisting">	@Pointcut("execution(* transfer(..))")
	private void transfer() {}</pre><p>
			&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#65292;&#20063;&#23601;&#26159; <tt class="interfacename">@Pointcut</tt> &#27880;&#35299;&#30340;&#20540;&#65292;&#26159;&#27491;&#35268;&#30340;AspectJ 5&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#12290;
			&#22914;&#26524;&#20320;&#24819;&#35201;&#26356;&#22810;&#20102;&#35299;AspectJ&#30340; &#20999;&#20837;&#28857;&#35821;&#35328;&#65292;&#35831;&#21442;&#35265;
			<a href="http://www.eclipse.org/aspectj/doc/released/progguide/index.html" target="_top">AspectJ &#32534;&#31243;&#25351;&#21335;</a>&#65288;&#22914;&#26524;&#35201;&#20102;&#35299;&#22522;&#20110;Java 5&#30340;&#25193;&#23637;&#35831;&#21442;&#38405;
			<a href="http://www.eclipse.org/aspectj/doc/released/adk15notebook/index.html" target="_top">AspectJ 5 &#24320;&#21457;&#25163;&#20876;</a>&#65289;
			&#25110;&#32773;&#20854;&#20182;&#20154;&#20889;&#30340;&#20851;&#20110;AspectJ&#30340;&#20070;&#65292;&#20363;&#22914;Colyer et. al.&#33879;&#30340;&#12298;Eclipse AspectJ&#12299;&#25110;&#32773;Ramnivas Laddad&#33879;&#30340;&#12298;AspectJ in Action&#12299;&#12290;
			</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6803"></a>6.2.3.1.&nbsp;&#25903;&#25345;&#30340;&#20999;&#20837;&#28857;&#25351;&#23450;&#32773;</h4></div></div><div></div></div><p>Spring AOP &#25903;&#25345;&#22312;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#20013;&#20351;&#29992;&#22914;&#19979;&#30340;AspectJ&#20999;&#20837;&#28857;&#25351;&#23450;&#32773;&#65306;</p><div class="sidebar"><p class="title"><b>&#20854;&#20182;&#30340;&#20999;&#20837;&#28857;&#31867;&#22411;</b></p><p>
					&#23436;&#25972;&#30340;AspectJ&#20999;&#20837;&#28857;&#35821;&#35328;&#25903;&#25345;&#39069;&#22806;&#30340;&#20999;&#20837;&#28857;&#25351;&#23450;&#32773;&#65292;&#20294;&#26159;Spring&#19981;&#25903;&#25345;&#36825;&#20010;&#21151;&#33021;&#12290;
					&#20182;&#20204;&#20998;&#21035;&#26159;<tt class="literal">call, initialization, preinitialization, staticinitialization, get, set, handler, adviceexecution, withincode, cflow, cflowbelow, if, @this</tt> &#21644; <tt class="literal">@withincode</tt>&#12290;
					&#22312;Spring AOP&#20013;&#20351;&#29992;&#36825;&#20123;&#25351;&#23450;&#32773;&#23558;&#20250;&#23548;&#33268;&#25243;&#20986;<tt class="classname">IllegalArgumentException</tt>&#24322;&#24120;&#12290;
					</p><p>
					Spring AOP&#25903;&#25345;&#30340;&#20999;&#20837;&#28857;&#25351;&#23450;&#32773;&#21487;&#33021;&#22312;&#23558;&#26469;&#30340;&#29256;&#26412;&#20013;&#24471;&#21040;&#25193;&#23637;&#65292;&#19981;&#20294;&#25903;&#25345;&#26356;&#22810;&#30340;AspectJ &#20999;&#20837;&#28857;&#25351;&#23450;&#32773;&#65288;&#20363;&#22914;"if"&#65289;&#65292;&#36824;&#20250;&#25903;&#25345;&#26576;&#20123;Spring&#29305;&#26377;&#30340;&#20999;&#20837;&#28857;&#25351;&#23450;&#32773;&#65292;&#27604;&#22914;"bean"&#65288;&#29992;&#20110;&#21305;&#37197;bean&#30340;&#21517;&#23383;&#65289;&#12290;
					</p></div><div class="itemizedlist"><ul type="disc"><li><p>
							<span class="emphasis"><em>execution</em></span> - &#21305;&#37197;&#26041;&#27861;&#25191;&#34892;&#30340;&#36830;&#25509;&#28857;&#65292;&#36825;&#26159;&#20320;&#23558;&#20250;&#29992;&#21040;&#30340;Spring&#30340;&#26368;&#20027;&#35201;&#30340;&#20999;&#20837;&#28857;&#25351;&#23450;&#32773;&#12290;
						</p></li><li><p>
							<span class="emphasis"><em>within</em></span> - &#38480;&#23450;&#21305;&#37197;&#29305;&#23450;&#31867;&#22411;&#30340;&#36830;&#25509;&#28857;&#65288;&#22312;&#20351;&#29992;Spring AOP&#30340;&#26102;&#20505;&#65292;&#22312;&#21305;&#37197;&#30340;&#31867;&#22411;&#20013;&#23450;&#20041;&#30340;&#26041;&#27861;&#30340;&#25191;&#34892;&#65289;&#12290; 
						</p></li><li><p>
							<span class="emphasis"><em>this</em></span> - &#38480;&#23450;&#21305;&#37197;&#29305;&#23450;&#30340;&#36830;&#25509;&#28857;&#65288;&#20351;&#29992;Spring AOP&#30340;&#26102;&#20505;&#26041;&#27861;&#30340;&#25191;&#34892;&#65289;&#65292;&#20854;&#20013;bean reference&#65288;Spring AOP &#20195;&#29702;&#65289;&#26159;&#25351;&#23450;&#31867;&#22411;&#30340;&#23454;&#20363;&#12290;
						</p></li><li><p>
							<span class="emphasis"><em>target</em></span> - &#38480;&#23450;&#21305;&#37197;&#29305;&#23450;&#30340;&#36830;&#25509;&#28857;&#65288;&#20351;&#29992;Spring AOP&#30340;&#26102;&#20505;&#26041;&#27861;&#30340;&#25191;&#34892;&#65289;&#65292;&#20854;&#20013;&#30446;&#26631;&#23545;&#35937;&#65288;&#34987;&#20195;&#29702;&#30340;appolication object&#65289;&#26159;&#25351;&#23450;&#31867;&#22411;&#30340;&#23454;&#20363;&#12290;
						</p></li><li><p>
							<span class="emphasis"><em>args</em></span> - &#38480;&#23450;&#21305;&#37197;&#29305;&#23450;&#30340;&#36830;&#25509;&#28857;&#65288;&#20351;&#29992;Spring AOP&#30340;&#26102;&#20505;&#26041;&#27861;&#30340;&#25191;&#34892;&#65289;&#65292;&#20854;&#20013;&#21442;&#25968;&#26159;&#25351;&#23450;&#31867;&#22411;&#30340;&#23454;&#20363;&#12290;
						</p></li><li><p>
							<span class="emphasis"><em>
								<tt class="interfacename">@target</tt>
							</em></span> -  &#38480;&#23450;&#21305;&#37197;&#29305;&#23450;&#30340;&#36830;&#25509;&#28857;&#65288;&#20351;&#29992;Spring AOP&#30340;&#26102;&#20505;&#26041;&#27861;&#30340;&#25191;&#34892;&#65289;&#65292;&#20854;&#20013;&#25191;&#34892;&#30340;&#23545;&#35937;&#30340;&#31867;&#24050;&#32463;&#26377;&#25351;&#23450;&#31867;&#22411;&#30340;&#27880;&#35299;&#12290;
		  				</p></li><li><p>
							<span class="emphasis"><em>
								<tt class="interfacename">@args</tt>
							</em></span> - &#38480;&#23450;&#21305;&#37197;&#29305;&#23450;&#30340;&#36830;&#25509;&#28857;&#65288;&#20351;&#29992;Spring AOP&#30340;&#26102;&#20505;&#26041;&#27861;&#30340;&#25191;&#34892;&#65289;&#65292;&#20854;&#20013;&#23454;&#38469;&#20256;&#20837;&#21442;&#25968;&#30340;&#36816;&#34892;&#26102;&#31867;&#22411;&#26377;&#25351;&#23450;&#31867;&#22411;&#30340;&#27880;&#35299;&#12290;
						</p></li><li><p>
							<span class="emphasis"><em>
								<tt class="interfacename">@within</tt>
							</em></span> - &#38480;&#23450;&#21305;&#37197;&#29305;&#23450;&#30340;&#36830;&#25509;&#28857;&#65292;&#20854;&#20013;&#36830;&#25509;&#28857;&#25152;&#22312;&#31867;&#22411;&#24050;&#25351;&#23450;&#27880;&#35299;&#65288;&#22312;&#20351;&#29992;Spring AOP&#30340;&#26102;&#20505;&#65292;&#25152;&#25191;&#34892;&#30340;&#26041;&#27861;&#25152;&#22312;&#31867;&#22411;&#24050;&#25351;&#23450;&#27880;&#35299;&#65289;&#12290;
						</p></li><li><p>
							<span class="emphasis"><em>@annotation</em></span> - &#38480;&#23450;&#21305;&#37197;&#29305;&#23450;&#30340;&#36830;&#25509;&#28857;&#65288;&#20351;&#29992;Spring AOP&#30340;&#26102;&#20505;&#26041;&#27861;&#30340;&#25191;&#34892;&#65289;&#65292;&#20854;&#20013;&#36830;&#25509;&#28857;&#30340;&#20027;&#39064;&#26377;&#26576;&#31181;&#32473;&#23450;&#30340;&#27880;&#35299;&#12290;
						</p></li></ul></div><i><span class="remark">
				&#22240;&#20026;Spring AOP&#38480;&#21046;&#20102;&#36830;&#25509;&#28857;&#24517;&#39035;&#26159;&#26041;&#27861;&#25191;&#34892;&#32423;&#21035;&#30340;&#65292;pointcut designators&#30340;&#35752;&#35770;&#20063;&#32473;&#20986;&#20102;&#19968;&#20010;&#23450;&#20041;&#65292;&#36825;&#20010;&#23450;&#20041;&#21644;AspectJ&#30340;&#32534;&#31243;&#25351;&#21335;&#20013;&#30340;&#23450;&#20041;&#30456;&#27604;&#26174;&#24471;&#26356;&#21152;&#29421;&#31364;&#12290; 
				&#38500;&#27492;&#20043;&#22806;&#65292;AspectJ&#23427;&#26412;&#36523;&#26377;&#22522;&#20110;&#31867;&#22411;&#30340;&#35821;&#20041;&#65292;&#22312;&#25191;&#34892;&#30340;&#36830;&#25509;&#28857;'this'&#21644;'target'&#37117;&#26159;&#25351;&#21516;&#19968;&#20010;&#23545;&#35937;&#65292;&#20063;&#23601;&#26159;&#25191;&#34892;&#26041;&#27861;&#30340;&#23545;&#35937;&#12290;
				Spring AOP&#26159;&#19968;&#20010;&#22522;&#20110;&#20195;&#29702;&#30340;&#31995;&#32479;&#65292;&#24182;&#19988;&#20005;&#26684;&#21306;&#20998;&#20195;&#29702;&#23545;&#35937;&#26412;&#36523;&#65288;&#23545;&#24212;&#20110;'this'&#65289;&#21644;&#32972;&#21518;&#30340;&#30446;&#26631;&#23545;&#35937;&#65288;&#23545;&#24212;&#20110;'target'&#65289;
				</span></i></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6890"></a>6.2.3.2.&nbsp;&#21512;&#24182;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;</h4></div></div><div></div></div><p>
				&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#21487;&#20197;&#20351;&#29992;using '&amp;&amp;', '||' &#21644;  '!'&#26469;&#21512;&#24182;.&#36824;&#21487;&#20197;&#36890;&#36807;&#21517;&#23383;&#26469;&#25351;&#21521;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#12290;
				&#20197;&#19979;&#30340;&#20363;&#23376;&#23637;&#31034;&#20102;&#19977;&#31181;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#65306;
				<tt class="literal">anyPublicOperation</tt>&#65288;&#22312;&#19968;&#20010;&#26041;&#27861;&#25191;&#34892;&#36830;&#25509;&#28857;&#20195;&#34920;&#20102;&#20219;&#24847;public&#26041;&#27861;&#30340;&#25191;&#34892;&#26102;&#21305;&#37197;&#65289;&#65307;
				<tt class="literal">inTrading</tt>&#65288;&#22312;&#19968;&#20010;&#20195;&#34920;&#20102;&#22312;&#20132;&#26131;&#27169;&#22359;&#20013;&#30340;&#20219;&#24847;&#30340;&#26041;&#27861;&#25191;&#34892;&#26102;&#21305;&#37197;&#65289;
				&#21644; <tt class="literal">tradingOperation</tt>&#65288;&#22312;&#19968;&#20010;&#20195;&#34920;&#20102;&#22312;&#20132;&#26131;&#27169;&#22359;&#20013;&#30340;&#20219;&#24847;&#30340;&#20844;&#20849;&#26041;&#27861;&#25191;&#34892;&#26102;&#21305;&#37197;&#65289;&#12290;
				</p><pre class="programlisting">	@Pointcut("execution(public * *(..))")
	private void anyPublicOperation() {}

	@Pointcut("within(com.xyz.someapp.trading..*")
	private void inTrading() {}

	@Pointcut("anyPublicOperation() &amp;&amp; inTrading()")
	private void tradingOperation() {}</pre><p>
				&#23601;&#19978;&#25152;&#31034;&#30340;&#65292;&#20174;&#26356;&#23567;&#30340;&#21629;&#21517;&#32452;&#20214;&#26469;&#26500;&#24314;&#26356;&#21152;&#22797;&#26434;&#30340;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#26159;&#19968;&#31181;&#26368;&#20339;&#23454;&#36341;&#12290;
				&#24403;&#29992;&#21517;&#23383;&#26469;&#25351;&#23450;&#20999;&#20837;&#28857;&#26102;&#20351;&#29992;&#30340;&#26159;&#24120;&#35265;&#30340;Java&#25104;&#21592;&#21487;&#35270;&#24615;&#35775;&#38382;&#35268;&#21017;&#12290;
				&#65288;&#27604;&#22914;&#35828;&#65292;&#20320;&#21487;&#20197;&#22312;&#21516;&#19968;&#31867;&#22411;&#20013;&#35775;&#38382;&#31169;&#26377;&#30340;&#20999;&#20837;&#28857;&#65292;&#22312;&#32487;&#25215;&#20851;&#31995;&#20013;&#35775;&#38382;&#21463;&#20445;&#25252;&#30340;&#20999;&#20837;&#28857;&#65292;&#21487;&#20197;&#22312;&#20219;&#24847;&#22320;&#26041;&#35775;&#38382;&#20844;&#20849;&#20999;&#20837;&#28857;&#12290;
				&#25104;&#21592;&#21487;&#35270;&#24615;&#35775;&#38382;&#35268;&#21017;&#19981;&#24433;&#21709;&#21040;&#20999;&#20837;&#28857;&#30340; <span class="emphasis"><em>&#21305;&#37197;</em></span>&#12290;
				</p><i><span class="remark">
				&#22312;AspectJ 1.5.1&#20013;&#26377;&#19968;&#20010;bug &#65288;#140357&#65289;&#26377;&#26102;&#20505;&#21487;&#33021;&#20250;&#23548;&#33268;Spring&#25152;&#20351;&#29992;&#30340;AspectJ&#20999;&#20837;&#28857;&#35299;&#26512;&#22833;&#36133;&#65292;
				&#21363;&#20351;&#29992;&#19968;&#20010;&#24050;&#21629;&#21517;&#30340;&#20999;&#20837;&#28857;&#26469;&#24341;&#29992;&#21040;&#21478;&#19968;&#20010;&#21516;&#31867;&#22411;&#30340;&#20999;&#20837;&#28857;&#30340;&#26102;&#20505;&#12290;
				&#22312;AspectJ&#30340;&#24320;&#21457;&#20013;&#24050;&#32463;&#35299;&#20915;&#36825;&#20010;bug&#65292;&#21487;&#20197;&#22312;AspectJ&#30340;&#19979;&#36733;&#39029;&#38754;&#24471;&#21040;&#12290;&#22312;1.5.2&#21457;&#24067;&#26102;&#23558;&#20250;&#21253;&#21547;&#36825;&#19968;fix&#12290;
				&#22914;&#26524;&#20320;&#36935;&#21040;&#20102;&#36825;&#20010;&#38382;&#39064;&#65292;&#20320;&#21487;&#20197;&#21435;&#19979;&#36733;AspectJ&#30340;&#24320;&#21457;&#26500;&#24314;&#21253;&#65292;&#24182;&#19988;&#26356;&#26032;&#20320;&#30340; <tt class="literal">aspectjweaver.jar</tt>&#65292;&#36825;&#26159;&#22312;AspectJ 1.5.2&#21457;&#24067;&#21069;&#30340;&#20020;&#26102;&#35299;&#20915;&#26041;&#26696;&#12290;
				</span></i></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-common-pointcuts"></a>6.2.3.3.&nbsp;&#20849;&#20139;&#24120;&#35265;&#30340;&#20999;&#20837;&#28857;&#65288;pointcut&#65289;&#23450;&#20041;</h4></div></div><div></div></div><p>
				&#24403;&#24320;&#21457;&#20225;&#19994;&#32423;&#24212;&#29992;&#30340;&#26102;&#20505;&#65292;&#20320;&#36890;&#24120;&#20250;&#24819;&#35201;&#20174;&#20960;&#20010;&#20999;&#38754;&#26469;&#21442;&#32771;&#27169;&#22359;&#21270;&#30340;&#24212;&#29992;&#21644;&#29305;&#23450;&#25805;&#20316;&#30340;&#38598;&#21512;&#12290;
				&#25105;&#20204;&#25512;&#33616;&#23450;&#20041;&#19968;&#20010;&#8220;SystemArchitecture&#8221;&#20999;&#38754;&#26469;&#25429;&#25417;&#24120;&#35265;&#30340;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#12290;&#19968;&#20010;&#20856;&#22411;&#30340;&#20999;&#38754;&#21487;&#33021;&#30475;&#36215;&#26469;&#20687;&#19979;&#38754;&#36825;&#26679;&#65306;
				</p><pre class="programlisting">package com.xyz.someapp;

import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Pointcut;

@Aspect
public class SystemArchitecture {

  /**
   * A join point is in the web layer if the method is defined
   * in a type in the com.xyz.someapp.web package or any sub-package
   * under that.
   */
  @Pointcut("within(com.xyz.someapp.web..*)")
  public void inWebLayer() {}

  /**
   * A join point is in the service layer if the method is defined
   * in a type in the com.xyz.someapp.service package or any sub-package
   * under that.
   */
  @Pointcut("within(com.xyz.someapp.service..*)")
  public void inServiceLayer() {}

  /**
   * A join point is in the data access layer if the method is defined
   * in a type in the com.xyz.someapp.dao package or any sub-package
   * under that.
   */
  @Pointcut("within(com.xyz.someapp.dao..*)")
  public void inDataAccessLayer() {}

  /**
   * A business service is the execution of any method defined on a service
   * interface. This definition assumes that interfaces are placed in the
   * "service" package, and that implementation types are in sub-packages.
   *
   * If you group service interfaces by functional area (for example,
   * in packages com.xyz.someapp.abc.service and com.xyz.def.service) then
   * the pointcut expression "execution(* com.xyz.someapp..service.*.*(..))"
   * could be used instead.
   */
  @Pointcut("execution(* com.xyz.someapp.service.*.*(..))")
  public void businessService() {}

  /**
   * A data access operation is the execution of any method defined on a
   * dao interface. This definition assumes that interfaces are placed in the
   * "dao" package, and that implementation types are in sub-packages.
   */
  @Pointcut("execution(* com.xyz.someapp.dao.*.*(..))")
  public void dataAccessOperation() {}

}</pre><p>
				&#31034;&#20363;&#20013;&#30340;&#20999;&#20837;&#28857;&#23450;&#20041;&#19968;&#20010;&#20320;&#21487;&#20197;&#22312;&#20219;&#20309;&#38656;&#35201;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#30340;&#22320;&#26041;&#21487;&#24341;&#29992;&#30340;&#20999;&#38754;&#12290;&#27604;&#22914;&#65292;&#20026;&#20102;&#20351;service&#23618;&#20107;&#21153;&#21270;&#65292;&#20320;&#21487;&#20197;&#20889;&#65306;
				</p><pre class="programlisting">&lt;aop:config&gt;
  &lt;aop:advisor
	  pointcut="com.xyz.someapp.SystemArchitecture.businessService()"
	  advice-ref="tx-advice"/&gt;
&lt;/aop:config&gt;

&lt;tx:advice id="tx-advice"&gt;
&lt;tx:attributes&gt;
	&lt;tx:method name="*" propagation="REQUIRED"/&gt;
  &lt;/tx:attributes&gt;
&lt;/tx:advice&gt;</pre><p>&#22312; <a href="aop.html#aop-schema" title="6.3.&nbsp;Schema-based AOP support">Section&nbsp;6.3, &#8220;Schema-based AOP support&#8221;</a> &#20013;&#35752;&#35770; <tt class="literal">&lt;aop:config&gt;</tt> &#21644; <tt class="literal">&lt;aop:advisor&gt;</tt>&#26631;&#31614;&#12290;
				&#22312; <a href="transaction.html" title="Chapter&nbsp;9.&nbsp;&#20107;&#21153;&#31649;&#29702;">Chapter&nbsp;9, <i>&#20107;&#21153;&#31649;&#29702;</i></a> &#20013;&#35752;&#35770;&#20107;&#21153;&#26631;&#31614;&#12290;
				</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e6939"></a>6.2.3.4.&nbsp;&#31034;&#20363;</h4></div></div><div></div></div><p>Spring AOP &#29992;&#25143;&#21487;&#33021;&#20250;&#32463;&#24120;&#20351;&#29992; <tt class="literal">execution</tt> pointcut designator&#12290;&#25191;&#34892;&#34920;&#36798;&#24335;&#30340;&#26684;&#24335;&#22914;&#19979;&#65306;</p><pre class="programlisting">execution(modifiers-pattern? ret-type-pattern declaring-type-pattern? name-pattern(param-pattern) throws-pattern?)</pre><p>
	 &#38500;&#20102;&#36820;&#22238;&#31867;&#22411;&#27169;&#24335;&#65292;&#21517;&#23383;&#27169;&#24335;&#21644;&#21442;&#25968;&#27169;&#24335;&#20197;&#22806;&#65292;&#25152;&#26377;&#30340;&#37096;&#20998;&#37117;&#26159;&#21487;&#36873;&#30340;&#12290;
	 &#36820;&#22238;&#31867;&#22411;&#27169;&#24335;&#20915;&#23450;&#20102;&#26041;&#27861;&#30340;&#36820;&#22238;&#31867;&#22411;&#24517;&#39035;&#20381;&#27425;&#21305;&#37197;&#19968;&#20010;&#36830;&#25509;&#28857;&#12290;
	 &#20320;&#20250;&#20351;&#29992;&#30340;&#26368;&#39057;&#32321;&#30340;&#36820;&#22238;&#31867;&#22411;&#27169;&#24335;&#26159; <tt class="literal">*</tt>&#65292;&#23427;&#20195;&#34920;&#20102;&#21305;&#37197;&#20219;&#24847;&#30340;&#36820;&#22238;&#31867;&#22411;&#12290;
	 &#19968;&#20010;&#20840;&#31216;&#38480;&#23450;&#30340;&#31867;&#22411;&#21517;&#23558;&#21482;&#20250;&#21305;&#37197;&#36820;&#22238;&#32473;&#23450;&#31867;&#22411;&#30340;&#26041;&#27861;&#12290;&#21517;&#23383;&#27169;&#24335;&#21305;&#37197;&#30340;&#26159;&#26041;&#27861;&#21517;&#12290;
	 &#20320;&#21487;&#20197;&#20351;&#29992; <tt class="literal">*</tt> &#36890;&#37197;&#31526;&#20316;&#20026;&#25152;&#26377;&#25110;&#32773;&#37096;&#20998;&#21629;&#21517;&#27169;&#24335;&#12290;
	 &#21442;&#25968;&#27169;&#24335;&#31245;&#24494;&#26377;&#28857;&#22797;&#26434;&#65306;<tt class="literal">()</tt> &#21305;&#37197;&#20102;&#19968;&#20010;&#19981;&#25509;&#21463;&#20219;&#20309;&#21442;&#25968;&#30340;&#26041;&#27861;&#65292;
	 &#32780; <tt class="literal">(..)</tt> &#21305;&#37197;&#20102;&#19968;&#20010;&#25509;&#21463;&#20219;&#24847;&#25968;&#37327;&#21442;&#25968;&#30340;&#26041;&#27861;&#65288;&#38646;&#25110;&#32773;&#26356;&#22810;&#65289;&#12290;
	 &#27169;&#24335; <tt class="literal">(*)</tt> &#21305;&#37197;&#20102;&#19968;&#20010;&#25509;&#21463;&#19968;&#20010;&#20219;&#20309;&#31867;&#22411;&#30340;&#21442;&#25968;&#30340;&#26041;&#27861;&#12290;
	 &#27169;&#24335; <tt class="literal">(*,String)</tt> &#21305;&#37197;&#20102;&#19968;&#20010;&#25509;&#21463;&#20004;&#20010;&#21442;&#25968;&#30340;&#26041;&#27861;&#65292;&#31532;&#19968;&#20010;&#21487;&#20197;&#26159;&#20219;&#24847;&#31867;&#22411;&#65292;&#31532;&#20108;&#20010;&#21017;&#24517;&#39035;&#26159;String&#31867;&#22411;&#12290;
	 &#35831;&#21442;&#35265;AspectJ&#32534;&#31243;&#25351;&#21335;&#30340; <a href="http://www.eclipse.org/aspectj/doc/released/progguide/semantics-pointcuts.html" target="_top">Language Semantics</a> &#37096;&#20998;&#12290;
	 </p><p>&#19979;&#38754;&#32473;&#20986;&#19968;&#20123;&#24120;&#35265;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#30340;&#20363;&#23376;&#12290;</p><div class="itemizedlist"><ul type="disc"><li><p>&#20219;&#24847;&#20844;&#20849;&#26041;&#27861;&#30340;&#25191;&#34892;&#65306;</p><pre class="programlisting">execution(public * *(..))</pre></li><li><p>&#20219;&#20309;&#19968;&#20010;&#20197;&#8220;set&#8221;&#24320;&#22987;&#30340;&#26041;&#27861;&#30340;&#25191;&#34892;&#65306;</p><pre class="programlisting">execution(* set*(..))</pre></li><li><p>
							<tt class="interfacename">AccountService</tt> &#25509;&#21475;&#30340;&#20219;&#24847;&#26041;&#27861;&#30340;&#25191;&#34892;&#65306;</p><pre class="programlisting">execution(* com.xyz.service.AccountService.*(..))</pre></li><li><p>&#23450;&#20041;&#22312;service&#21253;&#37324;&#30340;&#20219;&#24847;&#26041;&#27861;&#30340;&#25191;&#34892;&#65306;</p><pre class="programlisting">execution(* com.xyz.service.*.*(..))</pre></li><li><p>&#23450;&#20041;&#22312;service&#21253;&#25110;&#32773;&#23376;&#21253;&#37324;&#30340;&#20219;&#24847;&#26041;&#27861;&#30340;&#25191;&#34892;&#65306;</p><pre class="programlisting">execution(* com.xyz.service..*.*(..))</pre></li><li><p>&#22312;service&#21253;&#37324;&#30340;&#20219;&#24847;&#36830;&#25509;&#28857;&#65288;&#22312;Spring AOP&#20013;&#21482;&#26159;&#26041;&#27861;&#25191;&#34892;&#65289; &#65306;</p><pre class="programlisting">within(com.xyz.service.*)</pre></li><li><p>&#22312;service&#21253;&#25110;&#32773;&#23376;&#21253;&#37324;&#30340;&#20219;&#24847;&#36830;&#25509;&#28857;&#65288;&#22312;Spring AOP&#20013;&#21482;&#26159;&#26041;&#27861;&#25191;&#34892;&#65289; &#65306;</p><pre class="programlisting">within(com.xyz.service..*)</pre></li><li><p>&#23454;&#29616;&#20102; <tt class="interfacename">AccountService</tt> &#25509;&#21475;&#30340;&#20195;&#29702;&#23545;&#35937;&#30340;&#20219;&#24847;&#36830;&#25509;&#28857;&#65288;&#22312;Spring AOP&#20013;&#21482;&#26159;&#26041;&#27861;&#25191;&#34892;&#65289; &#65306;</p><pre class="programlisting">this(com.xyz.service.AccountService)</pre><i><span class="remark">'this'&#22312;binding form&#20013;&#29992;&#30340;&#26356;&#22810;&#65306;- &#35831;&#24120;&#35265;&#20197;&#19979;&#35752;&#35770;&#36890;&#30693;&#30340;&#31456;&#33410;&#20013;&#20851;&#20110;&#22914;&#20309;&#20351;&#24471;&#20195;&#29702;&#23545;&#35937;&#21487;&#20197;&#22312;&#36890;&#30693;&#20307;&#20869;&#35775;&#38382;&#21040;&#30340;&#37096;&#20998;&#12290;</span></i></li><li><p>&#23454;&#29616;&#20102; <tt class="interfacename">AccountService</tt> &#25509;&#21475;&#30340;&#30446;&#26631;&#23545;&#35937;&#30340;&#20219;&#24847;&#36830;&#25509;&#28857;&#65288;&#22312;Spring AOP&#20013;&#21482;&#26159;&#26041;&#27861;&#25191;&#34892;&#65289; &#65306;</p><pre class="programlisting">target(com.xyz.service.AccountService)</pre><i><span class="remark">'target'&#22312;binding form&#20013;&#29992;&#30340;&#26356;&#22810;&#65306;- &#35831;&#24120;&#35265;&#20197;&#19979;&#35752;&#35770;&#36890;&#30693;&#30340;&#31456;&#33410;&#20013;&#20851;&#20110;&#22914;&#20309;&#20351;&#24471;&#30446;&#26631;&#23545;&#35937;&#21487;&#20197;&#22312;&#36890;&#30693;&#20307;&#20869;&#35775;&#38382;&#21040;&#30340;&#37096;&#20998;&#12290;</span></i></li><li><p>&#20219;&#20309;&#19968;&#20010;&#21482;&#25509;&#21463;&#19968;&#20010;&#21442;&#25968;&#65292;&#19988;&#22312;&#36816;&#34892;&#26102;&#20256;&#20837;&#30340;&#21442;&#25968;&#23454;&#29616;&#20102; <tt class="interfacename">Serializable</tt> &#25509;&#21475;&#30340;&#36830;&#25509;&#28857; &#65288;&#22312;Spring AOP&#20013;&#21482;&#26159;&#26041;&#27861;&#25191;&#34892;&#65289;
	 </p><pre class="programlisting">args(java.io.Serializable)</pre><i><span class="remark">'args'&#22312;binding form&#20013;&#29992;&#30340;&#26356;&#22810;&#65306;- &#35831;&#24120;&#35265;&#20197;&#19979;&#35752;&#35770;&#36890;&#30693;&#30340;&#31456;&#33410;&#20013;&#20851;&#20110;&#22914;&#20309;&#20351;&#24471;&#26041;&#27861;&#21442;&#25968;&#21487;&#20197;&#22312;&#36890;&#30693;&#20307;&#20869;&#35775;&#38382;&#21040;&#30340;&#37096;&#20998;&#12290;</span></i><p>&#35831;&#27880;&#24847;&#22312;&#20363;&#23376;&#20013;&#32473;&#20986;&#30340;&#20999;&#20837;&#28857;&#19981;&#21516;&#20110; <tt class="literal">execution(* *(java.io.Serializable))</tt>&#65306;
						args&#21482;&#26377;&#22312;&#21160;&#24577;&#36816;&#34892;&#26102;&#20505;&#20256;&#20837;&#21442;&#25968;&#26159;&#21487;&#24207;&#21015;&#21270;&#30340;&#65288;Serializable&#65289;&#25165;&#21305;&#37197;&#65292;&#32780;execution &#22312;&#20256;&#20837;&#21442;&#25968;&#30340;&#31614;&#21517;&#22768;&#26126;&#30340;&#31867;&#22411;&#23454;&#29616;&#20102; <tt class="interfacename">Serializable</tt> &#25509;&#21475;&#26102;&#20505;&#21305;&#37197;&#12290;</p></li><li><p>&#26377;&#19968;&#20010; <tt class="interfacename">@Transactional</tt> &#27880;&#35299;&#30340;&#30446;&#26631;&#23545;&#35937;&#20013;&#30340;&#20219;&#24847;&#36830;&#25509;&#28857;&#65288;&#22312;Spring AOP&#20013;&#21482;&#26159;&#26041;&#27861;&#25191;&#34892;&#65289;
	 </p><pre class="programlisting">@target(org.springframework.transaction.annotation.Transactional)</pre><i><span class="remark">'@target' &#20063;&#21487;&#20197;&#22312;binding form&#20013;&#20351;&#29992;&#65306;&#35831;&#24120;&#35265;&#20197;&#19979;&#35752;&#35770;&#36890;&#30693;&#30340;&#31456;&#33410;&#20013;&#20851;&#20110;&#22914;&#20309;&#20351;&#24471;annotation&#23545;&#35937;&#21487;&#20197;&#22312;&#36890;&#30693;&#20307;&#20869;&#35775;&#38382;&#21040;&#30340;&#37096;&#20998;&#12290;</span></i></li><li><p>&#20219;&#20309;&#19968;&#20010;&#30446;&#26631;&#23545;&#35937;&#22768;&#26126;&#30340;&#31867;&#22411;&#26377;&#19968;&#20010; <tt class="interfacename">@Transactional</tt> &#27880;&#35299;&#30340;&#36830;&#25509;&#28857;&#65288;&#22312;Spring AOP&#20013;&#21482;&#26159;&#26041;&#27861;&#25191;&#34892;&#65289;</p><pre class="programlisting">@within(org.springframework.transaction.annotation.Transactional)</pre><i><span class="remark">'@within'&#20063;&#21487;&#20197;&#22312;binding form&#20013;&#20351;&#29992;&#65306;- &#35831;&#24120;&#35265;&#20197;&#19979;&#35752;&#35770;&#36890;&#30693;&#30340;&#31456;&#33410;&#20013;&#20851;&#20110;&#22914;&#20309;&#20351;&#24471;annotation&#23545;&#35937;&#21487;&#20197;&#22312;&#36890;&#30693;&#20307;&#20869;&#35775;&#38382;&#21040;&#30340;&#37096;&#20998;&#12290;</span></i></li><li><p>&#20219;&#20309;&#19968;&#20010;&#25191;&#34892;&#30340;&#26041;&#27861;&#26377;&#19968;&#20010; <tt class="interfacename">@Transactional</tt> annotation&#30340;&#36830;&#25509;&#28857;&#65288;&#22312;Spring AOP&#20013;&#21482;&#26159;&#26041;&#27861;&#25191;&#34892;&#65289;
	 </p><pre class="programlisting">@annotation(org.springframework.transaction.annotation.Transactional)</pre><i><span class="remark">'@annotation' &#20063;&#21487;&#20197;&#22312;binding form&#20013;&#20351;&#29992;&#65306;- &#35831;&#24120;&#35265;&#20197;&#19979;&#35752;&#35770;&#36890;&#30693;&#30340;&#31456;&#33410;&#20013;&#20851;&#20110;&#22914;&#20309;&#20351;&#24471;annotation&#23545;&#35937;&#21487;&#20197;&#22312;&#36890;&#30693;&#20307;&#20869;&#35775;&#38382;&#21040;&#30340;&#37096;&#20998;&#12290;</span></i></li><li><p>&#20219;&#20309;&#19968;&#20010;&#25509;&#21463;&#19968;&#20010;&#21442;&#25968;&#65292;&#24182;&#19988;&#20256;&#20837;&#30340;&#21442;&#25968;&#22312;&#36816;&#34892;&#26102;&#30340;&#31867;&#22411;&#23454;&#29616;&#20102; <tt class="interfacename">@Classified</tt> annotation&#30340;&#36830;&#25509;&#28857;&#65288;&#22312;Spring AOP&#20013;&#21482;&#26159;&#26041;&#27861;&#25191;&#34892;&#65289;
	 </p><pre class="programlisting">@args(com.xyz.security.Classified)</pre><i><span class="remark">'@args'&#20063;&#21487;&#20197;&#22312;binding form&#20013;&#20351;&#29992;&#65306;- &#35831;&#24120;&#35265;&#20197;&#19979;&#35752;&#35770;&#36890;&#30693;&#30340;&#31456;&#33410;&#20013;&#20851;&#20110;&#22914;&#20309;&#20351;&#24471;annotation&#23545;&#35937;&#21487;&#20197;&#22312;&#36890;&#30693;&#20307;&#20869;&#35775;&#38382;&#21040;&#30340;&#37096;&#20998;&#12290;</span></i></li></ul></div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7091"></a>6.2.4.&nbsp;&#22768;&#26126;&#36890;&#30693;</h3></div></div><div></div></div><p>
			&#36890;&#30693;&#26159;&#36319;&#19968;&#20010;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#20851;&#32852;&#36215;&#26469;&#30340;&#65292;&#24182;&#19988;&#22312;&#20999;&#20837;&#28857;&#21305;&#37197;&#30340;&#26041;&#27861;&#25191;&#34892;&#20043;&#21069;&#25110;&#32773;&#20043;&#21518;&#25110;&#32773;&#20043;&#21069;&#21644;&#20043;&#21518;&#36816;&#34892;&#12290;
			&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#21487;&#33021;&#26159;&#25351;&#21521;&#24050;&#21629;&#21517;&#30340;&#20999;&#20837;&#28857;&#30340;&#31616;&#21333;&#24341;&#29992;&#25110;&#32773;&#26159;&#19968;&#20010;&#24050;&#32463;&#22768;&#26126;&#36807;&#30340;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#12290;
	   		</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7096"></a>6.2.4.1.&nbsp;&#21069;&#32622;&#36890;&#30693;&#65288;Before advice&#65289; </h4></div></div><div></div></div><p>&#19968;&#20010;&#20999;&#38754;&#37324;&#20351;&#29992; <tt class="interfacename">@Before</tt> &#27880;&#35299;&#22768;&#26126;&#21069;&#32622;&#36890;&#30693;&#65306;</p><pre class="programlisting">import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;

@Aspect
public class BeforeExample {

  @Before("com.xyz.myapp.SystemArchitecture.dataAccessOperation()")
  public void doAccessCheck() {
	// ...
  }

}</pre><p>&#22914;&#26524;&#20351;&#29992;&#19968;&#20010;in-place &#30340;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#65292;&#25105;&#20204;&#21487;&#20197;&#25226;&#19978;&#38754;&#30340;&#20363;&#23376;&#25442;&#20010;&#20889;&#27861;&#65306;</p><pre class="programlisting">import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Before;

@Aspect
public class BeforeExample {

  @Before("execution(* com.xyz.myapp.dao.*.*(..))")
  public void doAccessCheck() {
	// ...
  }

}</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7110"></a>6.2.4.2.&nbsp;&#36820;&#22238;&#21518;&#36890;&#30693;&#65288;After returning advice&#65289;</h4></div></div><div></div></div><p>&#36820;&#22238;&#21518;&#36890;&#30693;&#36890;&#24120;&#22312;&#19968;&#20010;&#21305;&#37197;&#30340;&#26041;&#27861;&#36820;&#22238;&#30340;&#26102;&#20505;&#25191;&#34892;&#12290;&#20351;&#29992; <tt class="interfacename">@AfterReturning</tt> &#27880;&#35299;&#26469;&#22768;&#26126;&#65306;</p><pre class="programlisting">import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.AfterReturning;

@Aspect
public class AfterReturningExample {

  @AfterReturning("com.xyz.myapp.SystemArchitecture.dataAccessOperation()")
  public void doAccessCheck() {
	// ...
  }

}</pre><i><span class="remark"> 
				&#35828;&#26126;&#65306;&#20320;&#21487;&#20197;&#22312;&#21516;&#19968;&#20010;&#20999;&#38754;&#37324;&#23450;&#20041;&#22810;&#20010;&#36890;&#30693;&#65292;&#25110;&#32773;&#20854;&#20182;&#25104;&#21592;&#12290;&#25105;&#20204;&#21482;&#26159;&#22312;&#23637;&#31034;&#22914;&#20309;&#23450;&#20041;&#19968;&#20010;&#31616;&#21333;&#30340;&#36890;&#30693;&#12290;&#36825;&#20123;&#20363;&#23376;&#20027;&#35201;&#30340;&#20391;&#37325;&#28857;&#26159;&#27491;&#22312;&#35752;&#35770;&#30340;&#38382;&#39064;&#12290;
				</span></i><p>&#26377;&#26102;&#20505;&#20320;&#38656;&#35201;&#22312;&#36890;&#30693;&#20307;&#20869;&#24471;&#21040;&#36820;&#22238;&#30340;&#20540;&#12290;&#20320;&#21487;&#20197;&#20351;&#29992;&#20197; <tt class="interfacename">@AfterReturning</tt> &#25509;&#21475;&#30340;&#24418;&#24335;&#26469;&#32465;&#23450;&#36820;&#22238;&#20540;&#65306;</p><pre class="programlisting">import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.AfterReturning;

@Aspect
public class AfterReturningExample {

  @AfterReturning(
	pointcut="com.xyz.myapp.SystemArchitecture.dataAccessOperation()",
	returning="retVal")
  public void doAccessCheck(Object retVal) {
	// ...
  }

}</pre><p>&#22312; <tt class="literal">returning</tt> &#23646;&#24615;&#20013;&#20351;&#29992;&#30340;&#21517;&#23383;&#24517;&#39035;&#23545;&#24212;&#20110;&#36890;&#30693;&#26041;&#27861;&#20869;&#30340;&#19968;&#20010;&#21442;&#25968;&#21517;&#12290;
				&#24403;&#19968;&#20010;&#26041;&#27861;&#25191;&#34892;&#36820;&#22238;&#21518;&#65292;&#36820;&#22238;&#20540;&#20316;&#20026;&#30456;&#24212;&#30340;&#21442;&#25968;&#20540;&#20256;&#20837;&#36890;&#30693;&#26041;&#27861;&#12290;
				&#19968;&#20010; <tt class="literal">returning</tt> &#23376;&#21477;&#20063;&#38480;&#21046;&#20102;&#21482;&#33021;&#21305;&#37197;&#21040;&#36820;&#22238;&#25351;&#23450;&#31867;&#22411;&#20540;&#30340;&#26041;&#27861;&#12290;
				&#65288;&#22312;&#26412;&#20363;&#23376;&#20013;&#65292;&#36820;&#22238;&#20540;&#26159; <tt class="classname">Object</tt> &#31867;&#65292;&#20063;&#23601;&#26159;&#35828;&#36820;&#22238;&#20219;&#24847;&#31867;&#22411;&#37117;&#20250;&#21305;&#37197;&#65289;
				</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7140"></a>6.2.4.3.&nbsp;&#25243;&#20986;&#21518;&#36890;&#30693;&#65288;After throwing advice&#65289;</h4></div></div><div></div></div><p>&#25243;&#20986;&#21518;&#36890;&#30693;&#22312;&#19968;&#20010;&#26041;&#27861;&#25243;&#20986;&#24322;&#24120;&#21518;&#25191;&#34892;&#12290;&#20351;&#29992; <tt class="interfacename">@AfterThrowing</tt> &#27880;&#35299;&#26469;&#22768;&#26126;&#65306;</p><pre class="programlisting">import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.AfterThrowing;

@Aspect
public class AfterThrowingExample {

  @AfterThrowing("com.xyz.myapp.SystemArchitecture.dataAccessOperation()")
  public void doRecoveryActions() {
	// ...
  }

}</pre><p>
				&#20320;&#36890;&#24120;&#20250;&#24819;&#35201;&#38480;&#21046;&#36890;&#30693;&#21482;&#22312;&#26576;&#31181;&#29305;&#27530;&#30340;&#24322;&#24120;&#34987;&#25243;&#20986;&#30340;&#26102;&#20505;&#21305;&#37197;&#65292;&#20320;&#36824;&#24076;&#26395;&#21487;&#20197;&#22312;&#36890;&#30693;&#20307;&#20869;&#24471;&#21040;&#34987;&#25243;&#20986;&#30340;&#24322;&#24120;&#12290;
				&#20351;&#29992; <tt class="literal">throwing</tt> &#23646;&#24615;&#19981;&#20809;&#21487;&#20197;&#38480;&#21046;&#21305;&#37197;&#30340;&#24322;&#24120;&#31867;&#22411;&#65288;&#22914;&#26524;&#20320;&#19981;&#24819;&#38480;&#21046;&#65292;&#35831;&#20351;&#29992; <tt class="interfacename">Throwable</tt> &#20316;&#20026;&#24322;&#24120;&#31867;&#22411;&#65289;&#65292;&#36824;&#21487;&#20197;&#23558;&#25243;&#20986;&#30340;&#24322;&#24120;&#32465;&#23450;&#21040;&#36890;&#30693;&#30340;&#19968;&#20010;&#21442;&#25968;&#19978;&#12290;
				</p><pre class="programlisting">import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.AfterThrowing;

@Aspect
public class AfterThrowingExample {

  @AfterThrowing(
	pointcut="com.xyz.myapp.SystemArchitecture.dataAccessOperation()",
	throwing="ex")
  public void doRecoveryActions(DataAccessException ex) {
	// ...
  }

}</pre><p>
				&#22312; <tt class="literal">throwing</tt> &#23646;&#24615;&#20013;&#20351;&#29992;&#30340;&#21517;&#23383;&#24517;&#39035;&#19982;&#36890;&#30693;&#26041;&#27861;&#20869;&#30340;&#19968;&#20010;&#21442;&#25968;&#23545;&#24212;&#12290;
				&#24403;&#19968;&#20010;&#26041;&#27861;&#22240;&#25243;&#20986;&#19968;&#20010;&#24322;&#24120;&#32780;&#20013;&#27490;&#21518;&#65292;&#36825;&#20010;&#24322;&#24120;&#23558;&#20250;&#20316;&#20026;&#37027;&#20010;&#23545;&#24212;&#30340;&#21442;&#25968;&#36865;&#33267;&#36890;&#30693;&#26041;&#27861;&#12290;
				<tt class="literal">throwing</tt> &#23376;&#21477;&#20063;&#38480;&#21046;&#20102;&#21482;&#33021;&#21305;&#37197;&#21040;&#25243;&#20986;&#25351;&#23450;&#24322;&#24120;&#31867;&#22411;&#30340;&#26041;&#27861;&#65288;&#19978;&#38754;&#30340;&#31034;&#20363;&#20026; <tt class="classname">DataAccessException</tt>&#65289;&#12290;
				</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7171"></a>6.2.4.4.&nbsp;&#21518;&#36890;&#30693;&#65288;After (finally) advice&#65289;</h4></div></div><div></div></div><p>&#19981;&#35770;&#19968;&#20010;&#26041;&#27861;&#26159;&#22914;&#20309;&#32467;&#26463;&#30340;&#65292;&#22312;&#23427;&#32467;&#26463;&#21518;&#65288;finally&#65289;&#21518;&#36890;&#30693;&#65288;After (finally) advice&#65289;&#37117;&#20250;&#36816;&#34892;&#12290;
				&#20351;&#29992; <tt class="interfacename">@After</tt> &#27880;&#35299;&#26469;&#22768;&#26126;&#12290;&#36825;&#20010;&#36890;&#30693;&#24517;&#39035;&#20570;&#22909;&#22788;&#29702;&#27491;&#24120;&#36820;&#22238;&#21644;&#24322;&#24120;&#36820;&#22238;&#20004;&#31181;&#24773;&#20917;&#12290;&#36890;&#24120;&#29992;&#26469;&#37322;&#25918;&#36164;&#28304;&#12290;
				</p><pre class="programlisting">import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.After;

@Aspect
public class AfterFinallyExample {

  @After("com.xyz.myapp.SystemArchitecture.dataAccessOperation()")
  public void doReleaseLock() {
	// ...
  }

}</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-ataspectj-around-advice"></a>6.2.4.5.&nbsp;&#29615;&#32469;&#36890;&#30693;&#65288;Around Advice&#65289;</h4></div></div><div></div></div><p>
				&#26368;&#21518;&#19968;&#31181;&#36890;&#30693;&#26159;&#29615;&#32469;&#36890;&#30693;&#12290;&#29615;&#32469;&#36890;&#30693;&#22312;&#19968;&#20010;&#26041;&#27861;&#25191;&#34892;&#20043;&#21069;&#21644;&#20043;&#21518;&#25191;&#34892;&#12290;
				&#23427;&#20351;&#24471;&#36890;&#30693;&#26377;&#26426;&#20250;&#26082;&#22312;&#19968;&#20010;&#26041;&#27861;&#25191;&#34892;&#20043;&#21069;&#21448;&#22312;&#25191;&#34892;&#20043;&#21518;&#36816;&#34892;&#12290;&#24182;&#19988;&#65292;&#23427;&#21487;&#20197;&#20915;&#23450;&#36825;&#20010;&#26041;&#27861;&#22312;&#20160;&#20040;&#26102;&#20505;&#25191;&#34892;&#65292;&#22914;&#20309;&#25191;&#34892;&#65292;&#29978;&#33267;&#26159;&#21542;&#25191;&#34892;&#12290;
				&#29615;&#32469;&#36890;&#30693;&#32463;&#24120;&#22312;&#22312;&#26576;&#32447;&#31243;&#23433;&#20840;&#30340;&#29615;&#22659;&#19979;&#65292;&#20320;&#38656;&#35201;&#22312;&#19968;&#20010;&#26041;&#27861;&#25191;&#34892;&#20043;&#21069;&#21644;&#20043;&#21518;&#20849;&#20139;&#26576;&#31181;&#29366;&#24577;&#30340;&#26102;&#20505;&#20351;&#29992;&#12290;
				&#35831;&#23613;&#37327;&#20351;&#29992;&#26368;&#31616;&#21333;&#30340;&#28385;&#36275;&#20320;&#38656;&#27714;&#30340;&#36890;&#30693;&#12290;&#65288;&#27604;&#22914;&#22914;&#26524;&#21069;&#32622;&#36890;&#30693;&#65288;before advice&#65289;&#20063;&#21487;&#20197;&#36866;&#29992;&#30340;&#24773;&#20917;&#19979;&#19981;&#35201;&#20351;&#29992;&#29615;&#32469;&#36890;&#30693;&#65289;&#12290;
				</p><p>
				&#29615;&#32469;&#36890;&#30693;&#20351;&#29992; <tt class="interfacename">@Around</tt> &#27880;&#35299;&#26469;&#22768;&#26126;&#12290;&#36890;&#30693;&#30340;&#31532;&#19968;&#20010;&#21442;&#25968;&#24517;&#39035;&#26159; <tt class="interfacename">ProceedingJoinPoint</tt> &#31867;&#22411;&#12290;
				&#22312;&#36890;&#30693;&#20307;&#20869;&#65292;&#35843;&#29992; <tt class="interfacename">ProceedingJoinPoint</tt> &#30340; <tt class="literal">proceed()</tt> &#26041;&#27861;&#23558;&#20250;&#23548;&#33268;&#28508;&#22312;&#30340;&#36830;&#25509;&#28857;&#26041;&#27861;&#25191;&#34892;&#12290;
				<tt class="literal">proceed</tt> &#26041;&#27861;&#20063;&#21487;&#33021;&#20250;&#34987;&#35843;&#29992;&#24182;&#19988;&#20256;&#20837;&#19968;&#20010; <tt class="classname">Object[]</tt> &#23545;&#35937;-&#35813;&#25968;&#32452;&#23558;&#20316;&#20026;&#26041;&#27861;&#25191;&#34892;&#26102;&#20505;&#30340;&#21442;&#25968;&#12290;
				</p><i><span class="remark">
				&#24403;&#20256;&#20837;&#19968;&#20010; <tt class="classname">Object[]</tt> &#23545;&#35937;&#30340;&#26102;&#20505;&#65292;&#22788;&#29702;&#30340;&#26041;&#27861;&#19982;&#36890;&#36807;AspectJ&#32534;&#35793;&#22120;&#22788;&#29702;&#29615;&#32469;&#36890;&#30693;&#30053;&#26377;&#19981;&#21516;&#12290;
				&#23545;&#20110;&#20351;&#29992;&#20256;&#32479;AspectJ&#35821;&#35328;&#20889;&#30340;&#29615;&#32469;&#36890;&#30693;&#26469;&#35828;&#65292;&#20256;&#20837;&#21442;&#25968;&#30340;&#25968;&#37327;&#24517;&#39035;&#21644;&#20256;&#36882;&#32473;&#29615;&#32469;&#36890;&#30693;&#30340;&#21442;&#25968;&#25968;&#37327;&#21305;&#37197;&#65288;&#19981;&#26159;&#21518;&#21488;&#30340;&#36830;&#25509;&#28857;&#25509;&#21463;&#30340;&#21442;&#25968;&#25968;&#37327;&#65289;&#65292;&#24182;&#19988;&#29305;&#23450;&#39034;&#24207;&#30340;&#20256;&#20837;&#21442;&#25968;&#20195;&#26367;&#20102;&#23558;&#35201;&#32465;&#23450;&#32473;&#36830;&#25509;&#28857;&#30340;&#21407;&#22987;&#20540;&#65288;&#22914;&#26524;&#20320;&#30475;&#19981;&#25026;&#19981;&#29992;&#25285;&#24515;&#65289;&#12290;
				Spring&#37319;&#29992;&#30340;&#26041;&#27861;&#26356;&#21152;&#31616;&#21333;&#24182;&#19988;&#26356;&#22909;&#24471;&#21644;&#20182;&#30340;&#22522;&#20110;&#20195;&#29702;&#65288;proxy-based&#65289;&#65292;&#21482;&#21305;&#37197;&#25191;&#34892;&#30340;&#35821;&#27861;&#30456;&#36866;&#29992;&#12290;
				&#22914;&#26524;&#20320;&#36866;&#29992;AspectJ&#30340;&#32534;&#35793;&#22120;&#21644;&#32534;&#32455;&#22120;&#26469;&#32534;&#35793;&#20026;Spring&#32780;&#20889;&#30340;@AspectJ&#20999;&#38754;&#21644;&#22788;&#29702;&#21442;&#25968;&#65292;&#20320;&#21482;&#38656;&#35201;&#20102;&#35299;&#36825;&#19968;&#21306;&#21035;&#21363;&#21487;&#12290;
				&#26377;&#19968;&#31181;&#26041;&#27861;&#21487;&#20197;&#35753;&#20320;&#20889;&#20986;100%&#20860;&#23481;Spring AOP&#21644;AspectJ&#30340;&#65292;&#25105;&#20204;&#23558;&#20250;&#22312;&#21518;&#32493;&#30340;&#36890;&#30693;&#21442;&#25968;&#65288;advice parameters&#65289;&#30340;&#31456;&#33410;&#20013;&#35752;&#35770;&#23427;&#12290;
	</span></i><pre class="programlisting">import org.aspectj.lang.annotation.Aspect;
import org.aspectj.lang.annotation.Around;
import org.aspectj.lang.ProceedingJoinPoint;

@Aspect
public class AroundExample {

  @Around("com.xyz.myapp.SystemArchitecture.businessService()")
  public Object doBasicProfiling(ProceedingJoinPoint pjp) throws Throwable {
	// start stopwatch
	Object retVal = pjp.proceed();
	// stop stopwatch
	return retVal;
  }

}</pre><p>
				&#26041;&#27861;&#30340;&#35843;&#29992;&#32773;&#24471;&#21040;&#30340;&#36820;&#22238;&#20540;&#23601;&#26159;&#29615;&#32469;&#36890;&#30693;&#36820;&#22238;&#30340;&#20540;&#12290;
				&#20363;&#22914;&#65306;&#19968;&#20010;&#31616;&#21333;&#30340;&#32531;&#23384;&#20999;&#38754;&#65292;&#22914;&#26524;&#32531;&#23384;&#20013;&#26377;&#20540;&#65292;&#23601;&#36820;&#22238;&#35813;&#20540;&#65292;&#21542;&#21017;&#35843;&#29992;proceed()&#26041;&#27861;&#12290;
				&#35831;&#27880;&#24847;proceed&#21487;&#33021;&#22312;&#36890;&#30693;&#20307;&#20869;&#37096;&#34987;&#35843;&#29992;&#19968;&#27425;&#65292;&#35768;&#22810;&#27425;&#65292;&#25110;&#32773;&#26681;&#26412;&#19981;&#34987;&#35843;&#29992;&#12290;
				</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-ataspectj-advice-params"></a>6.2.4.6.&nbsp;&#36890;&#30693;&#21442;&#25968;&#65288;Advice parameters&#65289;</h4></div></div><div></div></div><p>
				Spring 2.0 &#25552;&#20379;&#20102;&#23436;&#25972;&#30340;&#36890;&#30693;&#31867;&#22411; - &#36825;&#24847;&#21619;&#30528;&#20320;&#21487;&#20197;&#22312;&#36890;&#30693;&#31614;&#21517;&#20013;&#22768;&#26126;&#25152;&#38656;&#30340;&#21442;&#25968;&#65292;&#65288;&#23601;&#20687;&#22312;&#20197;&#21069;&#30340;&#20363;&#23376;&#20013;&#25105;&#20204;&#30475;&#21040;&#30340;&#36820;&#22238;&#20540;&#21644;&#25243;&#20986;&#24322;&#24120;&#19968;&#26679;&#65289;&#32780;&#19981;&#24635;&#26159;&#20351;&#29992;Object[]&#12290;
				&#25105;&#20204;&#23558;&#20250;&#30475;&#21040;&#22914;&#20309;&#22312;&#36890;&#30693;&#20307;&#20869;&#35775;&#38382;&#21442;&#25968;&#21644;&#20854;&#20182;&#19978;&#19979;&#25991;&#30456;&#20851;&#30340;&#20540;&#12290;&#39318;&#20808;&#35753;&#25105;&#20204;&#30475;&#20197;&#19979;&#22914;&#20309;&#32534;&#20889;&#26222;&#36890;&#30340;&#36890;&#30693;&#20197;&#25214;&#20986;&#27491;&#22312;&#34987;&#36890;&#30693;&#30340;&#26041;&#27861;&#12290;
				</p><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e7220"></a>6.2.4.6.1.&nbsp;&#35775;&#38382;&#24403;&#21069;&#30340;&#36830;&#25509;&#28857;</h5></div></div><div></div></div><p>
					&#20219;&#20309;&#36890;&#30693;&#26041;&#27861;&#21487;&#20197;&#23558;&#31532;&#19968;&#20010;&#21442;&#25968;&#23450;&#20041;&#20026; <tt class="interfacename">org.aspectj.lang.JoinPoint</tt> &#31867;&#22411;
					&#65288;&#29615;&#32469;&#36890;&#30693;&#38656;&#35201;&#23450;&#20041;&#20026; <tt class="interfacename">ProceedingJoinPoint</tt> &#31867;&#22411;&#30340;&#65292;
					&#23427;&#26159; <tt class="interfacename">JoinPoint</tt> &#30340;&#19968;&#20010;&#23376;&#31867;&#12290;&#65289;
					<tt class="interfacename">JoinPoint</tt> &#25509;&#21475;&#25552;&#20379;&#20102;&#19968;&#31995;&#21015;&#26377;&#29992;&#30340;&#26041;&#27861;&#65292;
					&#27604;&#22914; <tt class="literal">getArgs()</tt>&#65288;&#36820;&#22238;&#26041;&#27861;&#21442;&#25968;&#65289;&#12289;<tt class="literal">getThis()</tt>&#65288;&#36820;&#22238;&#20195;&#29702;&#23545;&#35937;&#65289;&#12289;<tt class="literal">getTarget()</tt>&#65288;&#36820;&#22238;&#30446;&#26631;&#65289;&#12289;<tt class="literal">getSignature()</tt>&#65288;&#36820;&#22238;&#27491;&#22312;&#34987;&#36890;&#30693;&#30340;&#26041;&#27861;&#30456;&#20851;&#20449;&#24687;&#65289;&#21644; <tt class="literal">toString()</tt>&#65288;&#25171;&#21360;&#20986;&#27491;&#22312;&#34987;&#36890;&#30693;&#30340;&#26041;&#27861;&#30340;&#26377;&#29992;&#20449;&#24687;&#65289;&#12290;
					</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e7252"></a>6.2.4.6.2.&nbsp;&#20256;&#36882;&#21442;&#25968;&#32473;&#36890;&#30693;&#65288;Advice&#65289;</h5></div></div><div></div></div><p>
					&#25105;&#20204;&#24050;&#32463;&#30475;&#21040;&#20102;&#22914;&#20309;&#32465;&#23450;&#36820;&#22238;&#20540;&#25110;&#32773;&#24322;&#24120;&#65288;&#20351;&#29992;&#21518;&#32622;&#36890;&#30693;&#65288;after returning&#65289;&#21644;&#24322;&#24120;&#21518;&#36890;&#30693;&#65288;after throwing advice&#65289;&#12290;
					&#20026;&#20102;&#21487;&#20197;&#22312;&#36890;&#30693;&#65288;adivce&#65289;&#20307;&#20869;&#35775;&#38382;&#21442;&#25968;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992; <tt class="literal">args</tt> &#26469;&#32465;&#23450;&#12290;
					&#22914;&#26524;&#22312;&#19968;&#20010;&#21442;&#25968;&#34920;&#36798;&#24335;&#20013;&#24212;&#35813;&#20351;&#29992;&#31867;&#22411;&#21517;&#23383;&#30340;&#22320;&#26041;&#20351;&#29992;&#19968;&#20010;&#21442;&#25968;&#21517;&#23383;&#65292;&#37027;&#20040;&#24403;&#36890;&#30693;&#25191;&#34892;&#30340;&#26102;&#20505;&#23545;&#24212;&#30340;&#21442;&#25968;&#20540;&#23558;&#20250;&#34987;&#20256;&#36882;&#36827;&#26469;&#12290;
					&#21487;&#33021;&#32473;&#20986;&#19968;&#20010;&#20363;&#23376;&#20250;&#26356;&#22909;&#29702;&#35299;&#12290;&#20551;&#20351;&#20320;&#24819;&#35201;&#36890;&#30693;&#65288;advise&#65289;&#25509;&#21463;&#26576;&#20010;Account&#23545;&#35937;&#20316;&#20026;&#31532;&#19968;&#20010;&#21442;&#25968;&#30340;DAO&#25805;&#20316;&#30340;&#25191;&#34892;&#65292;&#20320;&#24819;&#35201;&#22312;&#36890;&#30693;&#20307;&#20869;&#20063;&#33021;&#35775;&#38382;&#21040;account&#23545;&#35937;&#65292;&#20320;&#21487;&#20197;&#20889;&#22914;&#19979;&#30340;&#20195;&#30721;&#65306;
					</p><pre class="programlisting">@Before("com.xyz.myapp.SystemArchitecture.dataAccessOperation() &amp;&amp;" +
		"args(account,..)")
public void validateAccount(Account account) {
  // ...
}</pre><p>
					&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#30340; <tt class="literal">args(account,..)</tt> &#37096;&#20998;&#26377;&#20004;&#20010;&#30446;&#30340;&#65306;
					&#39318;&#20808;&#23427;&#20445;&#35777;&#20102;&#21482;&#20250;&#21305;&#37197;&#37027;&#20123;&#25509;&#21463;&#33267;&#23569;&#19968;&#20010;&#21442;&#25968;&#30340;&#26041;&#27861;&#30340;&#25191;&#34892;&#65292;&#32780;&#19988;&#20256;&#20837;&#30340;&#21442;&#25968;&#24517;&#39035;&#26159; <tt class="classname">Account</tt> &#31867;&#22411;&#30340;&#23454;&#20363;&#65292;
					&#20854;&#27425;&#23427;&#20351;&#24471;&#21487;&#20197;&#22312;&#36890;&#30693;&#20307;&#20869;&#36890;&#36807; <tt class="literal">account</tt> &#21442;&#25968;&#26469;&#35775;&#38382;&#37027;&#20010;account&#21442;&#25968;&#12290;
					</p><p>
					&#21478;&#22806;&#19968;&#20010;&#21150;&#27861;&#26159;&#23450;&#20041;&#19968;&#20010;&#20999;&#20837;&#28857;&#65292;&#36825;&#20010;&#20999;&#20837;&#28857;&#22312;&#21305;&#37197;&#26576;&#20010;&#36830;&#25509;&#28857;&#30340;&#26102;&#20505;&#8220;&#25552;&#20379;&#8221;&#20102;&#19968;&#20010;Account&#23545;&#35937;&#65292;
					&#28982;&#21518;&#30452;&#25509;&#20174;&#36890;&#30693;&#20013;&#35775;&#38382;&#37027;&#20010;&#21629;&#21517;&#30340;&#20999;&#20837;&#28857;&#12290;&#20320;&#21487;&#20197;&#36825;&#26679;&#20889;&#65306;
					</p><pre class="programlisting">@Pointcut("com.xyz.myapp.SystemArchitecture.dataAccessOperation() &amp;&amp;" +
		  "args(account,..)")
private void accountDataAccessOperation(Account account) {}

@Before("accountDataAccessOperation(account)")
public void validateAccount(Account account) {
  // ..
}</pre><p>&#22914;&#26524;&#24819;&#35201;&#30693;&#36947;&#26356;&#35814;&#32454;&#30340;&#20869;&#23481;&#65292;&#35831;&#21442;&#38405; AspectJ &#32534;&#31243;&#25351;&#21335;&#12290;</p><p>
					&#20195;&#29702;&#23545;&#35937;&#65288;<tt class="literal">this</tt>&#65289;&#12289;&#30446;&#26631;&#23545;&#35937;&#65288;<tt class="literal">target</tt>&#65289;
					&#21644;&#27880;&#35299;&#65288;<tt class="literal">@within, @target, @annotation, @args</tt>&#65289;&#37117;&#21487;&#20197;&#29992;&#19968;&#31181;&#31616;&#21333;&#26684;&#24335;&#32465;&#23450;&#12290;
					&#20197;&#19979;&#30340;&#20363;&#23376;&#23637;&#31034;&#20102;&#22914;&#20309;&#20351;&#29992; <tt class="interfacename">@Auditable</tt> &#27880;&#35299;&#26469;&#21305;&#37197;&#26041;&#27861;&#25191;&#34892;&#65292;&#24182;&#25552;&#21462;AuditCode&#12290;
					</p><p>&#39318;&#20808;&#26159; <tt class="interfacename">@Auditable</tt> &#27880;&#35299;&#30340;&#23450;&#20041;&#65306;</p><pre class="programlisting">@Retention(RetentionPolicy.RUNTIME)
@Target(ElementType.METHOD)
public @interface Auditable {
	AuditCode value();
}
</pre><p>&#28982;&#21518;&#26159;&#21305;&#37197; <tt class="interfacename">@Auditable</tt> &#26041;&#27861;&#25191;&#34892;&#30340;&#36890;&#30693;&#65306;</p><pre class="programlisting">@Before("com.xyz.lib.Pointcuts.anyPublicMethod() &amp;&amp; " +
		"@annotation(auditable)")
public void audit(Auditable auditable) {
  AuditCode code = auditable.value();
  // ...
}
</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e7307"></a>6.2.4.6.3.&nbsp;&#20915;&#23450;&#21442;&#25968;&#21517;</h5></div></div><div></div></div><p>
					&#32465;&#23450;&#22312;&#36890;&#30693;&#19978;&#30340;&#21442;&#25968;&#20381;&#36182;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#30340;&#21305;&#37197;&#21517;&#65292;&#24182;&#20511;&#27492;&#22312;&#65288;&#36890;&#30693;&#65288;advice&#65289;&#21644;&#20999;&#20837;&#28857;&#65288;pointcut&#65289;&#65289;&#30340;&#26041;&#27861;&#31614;&#21517;&#20013;&#22768;&#26126;&#21442;&#25968;&#21517;&#12290;
					&#21442;&#25968;&#21517; <span class="emphasis"><em>&#26080;&#27861;</em></span> &#36890;&#36807;Java&#21453;&#23556;&#26469;&#33719;&#21462;&#65292;&#25152;&#20197;Spring AOP&#20351;&#29992;&#22914;&#19979;&#30340;&#31574;&#30053;&#26469;&#20915;&#23450;&#21442;&#25968;&#21517;&#23383;&#65306;
					</p><div class="orderedlist"><ol type="1"><li><p>
							&#22914;&#26524;&#21442;&#25968;&#21517;&#23383;&#24050;&#32463;&#34987;&#29992;&#25143;&#26126;&#30830;&#25351;&#23450;&#65292;&#21017;&#20351;&#29992;&#25351;&#23450;&#30340;&#21442;&#25968;&#21517;&#65306;
							&#36890;&#30693;&#65288;advice&#65289;&#21644;&#20999;&#20837;&#28857;&#65288;pointcut&#65289;&#27880;&#35299;&#26377;&#19968;&#20010;&#39069;&#22806;&#30340;"argNames"&#23646;&#24615;&#65292;&#35813;&#23646;&#24615;&#29992;&#26469;&#25351;&#23450;&#25152;&#27880;&#35299;&#30340;&#26041;&#27861;&#30340;&#21442;&#25968;&#21517; - 
							&#36825;&#20123;&#21442;&#25968;&#21517;&#22312;&#36816;&#34892;&#26102;&#26159; <span class="emphasis"><em>&#21487;&#20197;</em></span> &#35775;&#38382;&#30340;&#12290;&#20363;&#23376;&#22914;&#19979;&#65306;</p><pre class="programlisting">@Before(
   value="com.xyz.lib.Pointcuts.anyPublicMethod() &amp;&amp; " +
		 "@annotation(auditable)",
   argNames="auditable")
public void audit(Auditable auditable) {
  AuditCode code = auditable.value();
  // ...
}
</pre><i><span class="remark">
							&#22914;&#26524;&#19968;&#20010;@AspectJ&#20999;&#38754;&#24050;&#32463;&#34987;AspectJ&#32534;&#35793;&#22120;&#65288;ajc&#65289;&#32534;&#35793;&#36807;&#20102;&#65292;&#37027;&#20040;&#23601;&#19981;&#38656;&#35201;&#20877;&#28155;&#21152; <tt class="literal">argNames</tt> &#21442;&#25968;&#20102;&#65292;&#22240;&#20026;&#32534;&#35793;&#22120;&#20250;&#33258;&#21160;&#23436;&#25104;&#36825;&#19968;&#24037;&#20316;&#12290;
							</span></i></li><li><p> 
							&#20351;&#29992; <tt class="literal">'argNames'</tt> &#23646;&#24615;&#26377;&#28857;&#19981;&#37027;&#20040;&#20248;&#38597;&#65292;&#25152;&#20197;&#22914;&#26524;&#27809;&#26377;&#25351;&#23450;<tt class="literal">'argNames'</tt> &#23646;&#24615;&#65292;
							Spring AOP &#20250;&#23547;&#25214;&#31867;&#30340;debug&#20449;&#24687;&#65292;&#24182;&#19988;&#23581;&#35797;&#20174;&#26412;&#22320;&#21464;&#37327;&#34920;&#65288;local variable table&#65289;&#20013;&#26469;&#20915;&#23450;&#21442;&#25968;&#21517;&#23383;&#12290;
							&#21482;&#35201;&#32534;&#35793;&#30340;&#26102;&#20505;&#20351;&#29992;&#20102;debug&#20449;&#24687;&#65288;&#33267;&#23569;&#35201;&#20351;&#29992; <tt class="literal">'-g:vars'</tt> &#65289;&#65292;&#23601;&#21487;&#33719;&#24471;&#36825;&#20123;&#20449;&#24687;&#12290;
							&#20351;&#29992;&#36825;&#20010;flag&#32534;&#35793;&#30340;&#32467;&#26524;&#26159;&#65306;
							(1)&#20320;&#30340;&#20195;&#30721;&#23558;&#33021;&#22815;&#26356;&#21152;&#23481;&#26131;&#30340;&#35835;&#25026;&#65288;&#21453;&#21521;&#24037;&#31243;&#65289;&#65292;
							(2)&#29983;&#25104;&#30340;class&#25991;&#20214;&#20250;&#31245;&#35768;&#22823;&#19968;&#20123;&#65288;&#19981;&#37325;&#35201;&#30340;&#65289;&#65292;
							(3)&#31227;&#38500;&#19981;&#34987;&#20351;&#29992;&#30340;&#26412;&#22320;&#21464;&#37327;&#30340;&#20248;&#21270;&#21151;&#33021;&#23558;&#20250;&#22833;&#25928;&#12290;
							&#25442;&#21477;&#35805;&#35828;&#65292;&#20320;&#22312;&#20351;&#29992;&#36825;&#20010;flag&#30340;&#26102;&#20505;&#19981;&#20250;&#36935;&#21040;&#20219;&#20309;&#22256;&#38590;&#12290;
							</p></li><li><p>
							&#22914;&#26524;&#19981;&#21152;&#19978;debug&#20449;&#24687;&#26469;&#32534;&#35793;&#30340;&#35805;&#65292;Spring AOP&#23558;&#20250;&#23581;&#35797;&#25512;&#26029;&#21442;&#25968;&#30340;&#32465;&#23450;&#12290;
							&#65288;&#20363;&#22914;&#65292;&#35201;&#26159;&#21482;&#26377;&#19968;&#20010;&#21464;&#37327;&#34987;&#32465;&#23450;&#21040;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#65288;pointcut expression&#65289;&#12289;&#36890;&#30693;&#26041;&#27861;&#65288;advice method&#65289;&#23558;&#20250;&#25509;&#21463;&#36825;&#20010;&#21442;&#25968;&#65292; &#36825;&#26159;&#26174;&#32780;&#26131;&#35265;&#30340;&#65289;&#12290;
							&#22914;&#26524;&#21464;&#37327;&#30340;&#32465;&#23450;&#19981;&#26126;&#30830;&#65292;&#23558;&#20250;&#25243;&#20986;&#19968;&#20010; <tt class="classname">AmbiguousBindingException</tt> &#24322;&#24120;&#12290;
							</p></li><li><p>&#22914;&#26524;&#20197;&#19978;&#25152;&#26377;&#31574;&#30053;&#37117;&#22833;&#36133;&#20102;&#65292;&#23558;&#20250;&#25243;&#20986;&#19968;&#20010; <tt class="classname">IllegalArgumentException</tt> &#24322;&#24120;&#12290;</p></li></ol></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h5 class="title"><a name="d0e7353"></a>6.2.4.6.4.&nbsp;&#22788;&#29702;&#21442;&#25968;</h5></div></div><div></div></div><p>
					&#25105;&#20204;&#20043;&#21069;&#25552;&#36807;&#25105;&#20204;&#23558;&#20250;&#35752;&#35770;&#22914;&#20309;&#32534;&#20889;&#19968;&#20010; <span class="emphasis"><em>&#24102;&#21442;&#25968;&#30340;</em></span> &#30340;proceed()&#35843;&#29992;&#65292;&#20351;&#24471;&#19981;&#35770;&#22312;Spring AOP&#20013;&#36824;&#26159;&#22312;AspectJ&#37117;&#33021;&#27491;&#24120;&#24037;&#20316;&#12290;
					&#35299;&#20915;&#26041;&#27861;&#26159;&#20445;&#35777;&#36890;&#30693;&#31614;&#21517;&#20381;&#27425;&#32465;&#23450;&#26041;&#27861;&#21442;&#25968;&#12290;&#27604;&#22914;&#35828;&#65306;
					</p><pre class="programlisting">@Around("execution(List&lt;Account&gt; find*(..)) &amp;&amp;" +
		"com.xyz.myapp.SystemArchitecture.inDataAccessLayer() &amp;&amp; " +
		"args(accountHolderNamePattern)")
public Object preProcessQueryPattern(ProceedingJoinPoint pjp, String accountHolderNamePattern)
throws Throwable {
  String newPattern = preProcess(accountHolderNamePattern);
  return pjp.proceed(new Object[] {newPattern});
}
</pre><p>&#22823;&#22810;&#25968;&#24773;&#20917;&#19979;&#20320;&#37117;&#20250;&#36825;&#26679;&#32465;&#23450;&#65288;&#23601;&#20687;&#19978;&#38754;&#30340;&#20363;&#23376;&#37027;&#26679;&#65289;&#12290;</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="aop-ataspectj-advice-ordering"></a>6.2.4.7.&nbsp;&#36890;&#30693;&#65288;Advice&#65289;&#39034;&#24207;</h4></div></div><div></div></div><p>
				&#22914;&#26524;&#26377;&#22810;&#20010;&#36890;&#30693;&#24819;&#35201;&#22312;&#21516;&#19968;&#36830;&#25509;&#28857;&#36816;&#34892;&#20250;&#21457;&#29983;&#20160;&#20040;&#65311;Spring AOP &#30340;&#25191;&#34892;&#36890;&#30693;&#30340;&#39034;&#24207;&#36319;AspectJ&#30340;&#19968;&#26679;&#12290;
				&#22312;&#8220;&#36827;&#20837;&#8221;&#36830;&#25509;&#28857;&#30340;&#24773;&#20917;&#19979;&#65292;&#26368;&#39640;&#20248;&#20808;&#32423;&#30340;&#36890;&#30693;&#20250;&#20808;&#25191;&#34892;&#65288;&#25152;&#20197;&#19978;&#38754;&#32473;&#20986;&#30340;&#20004;&#20010;&#21069;&#32622;&#36890;&#30693;&#65288;before advice&#65289;&#20013;&#65292;&#20248;&#20808;&#32423;&#39640;&#30340;&#37027;&#20010;&#20250;&#20808;&#25191;&#34892;&#65289;&#12290;
				&#22312;&#8220;&#36864;&#20986;&#8221;&#36830;&#25509;&#28857;&#30340;&#24773;&#20917;&#19979;&#65292;&#26368;&#39640;&#20248;&#20808;&#32423;&#30340;&#36890;&#30693;&#20250;&#26368;&#21518;&#25191;&#34892;&#12290;&#65288;&#25152;&#20197;&#19978;&#38754;&#32473;&#20986;&#30340;&#20004;&#20010;&#21069;&#32622;&#36890;&#30693;&#65288;before advice&#65289;&#20013;&#65292;&#20248;&#20808;&#32423;&#39640;&#30340;&#37027;&#20010;&#20250;&#31532;&#20108;&#20010;&#25191;&#34892;&#65289;&#12290;
				&#23545;&#20110;&#23450;&#20041;&#22312;&#30456;&#21516;&#20999;&#38754;&#30340;&#36890;&#30693;&#65292;&#26681;&#25454;&#22768;&#26126;&#30340;&#39034;&#24207;&#26469;&#30830;&#23450;&#25191;&#34892;&#39034;&#24207;&#12290;&#27604;&#22914;&#19979;&#38754;&#36825;&#20010;&#20999;&#38754;&#65306;
				</p><pre class="programlisting">@Aspect
public class AspectWithMultipleAdviceDeclarations {

  @Pointcut("execution(* foo(..))")
  public void fooExecution() {}

  @Before("fooExecution()")
  public void doBeforeOne() {
	// ..
  }

  @Before("fooExecution()")
  public void doBeforeTwo() {
	// ..
  }

  @AfterReturning("fooExecution()")
  public void doAfterOne() {
	// ..
  }

  @AfterReturning("fooExecution()")
  public void doAfterTwo() {
	//..
  }

}</pre><p>
				&#36825;&#26679;&#65292;&#20551;&#20351;&#23545;&#20110;&#20219;&#20309;&#19968;&#20010;&#21517;&#23383;&#20026;foo&#30340;&#26041;&#27861;&#30340;&#25191;&#34892;&#65292;
				<tt class="literal">doBeforeOne</tt>&#12289;<tt class="literal">doBeforeTwo</tt>&#12289;<tt class="literal">doAfterOne</tt> &#21644; <tt class="literal">doAfterTwo</tt> &#36890;&#30693;&#26041;&#27861;&#37117;&#38656;&#35201;&#36816;&#34892;&#12290;
				&#25191;&#34892;&#39034;&#24207;&#23558;&#25353;&#29031;&#22768;&#26126;&#30340;&#39034;&#24207;&#26469;&#30830;&#23450;&#12290;&#22312;&#36825;&#20010;&#20363;&#23376;&#20013;&#65292;&#25191;&#34892;&#30340;&#32467;&#26524;&#20250;&#26159;&#65306;
				</p><pre class="programlisting">doBeforeOne
doBeforeTwo
foo
doAfterOne
doAfterTwo
</pre><p>
				&#25442;&#35328;&#20043;&#65292;&#22240;&#20026;doBeforeOne&#20808;&#23450;&#20041;&#65292;&#23427;&#20250;&#20808;&#20110;doBeforeTwo&#25191;&#34892;&#65292;&#32780;doAfterTwo&#21518;&#20110;doAfterOne&#23450;&#20041;&#65292;&#25152;&#20197;&#23427;&#20250;&#22312;doAfterOne&#20043;&#21518;&#25191;&#34892;&#12290;
				&#21482;&#38656;&#35201;&#35760;&#20303;&#36890;&#30693;&#26159;&#25353;&#29031;&#23450;&#20041;&#30340;&#39034;&#24207;&#26469;&#25191;&#34892;&#30340;&#23601;&#21487;&#20197;&#20102;&#12290; - &#22914;&#26524;&#24819;&#35201;&#30693;&#36947;&#26356;&#21152;&#35814;&#32454;&#30340;&#20869;&#23481;&#65292;&#35831;&#21442;&#38405;AspectJ&#32534;&#31243;&#25351;&#21335;&#12290;
				</p><p>
				&#24403;&#23450;&#20041;&#22312; <span class="emphasis"><em>&#19981;&#21516;&#30340;</em></span> &#20999;&#38754;&#37324;&#30340;&#20004;&#20010;&#36890;&#30693;&#37117;&#38656;&#35201;&#22312;&#19968;&#20010;&#30456;&#21516;&#30340;&#36830;&#25509;&#28857;&#20013;&#36816;&#34892;&#65292;&#37027;&#20040;&#38500;&#38750;&#20320;&#25351;&#23450;&#65292;&#21542;&#21017;&#25191;&#34892;&#30340;&#39034;&#24207;&#26159;&#26410;&#30693;&#30340;&#12290;
				&#20320;&#21487;&#20197;&#36890;&#36807;&#25351;&#23450;&#20248;&#20808;&#32423;&#26469;&#25511;&#21046;&#25191;&#34892;&#39034;&#24207;&#12290;&#22312;Spring&#20013;&#21487;&#20197;&#22312;&#20999;&#38754;&#31867;&#20013;&#23454;&#29616; <tt class="interfacename">org.springframework.core.Ordered</tt> &#25509;&#21475;&#20570;&#21040;&#36825;&#19968;&#28857;&#12290;
				&#22312;&#20004;&#20010;&#20999;&#38754;&#20013;&#65292;<tt class="literal">Ordered.getValue()</tt> &#26041;&#27861;&#36820;&#22238;&#20540;&#36739;&#20302;&#30340;&#37027;&#20010;&#26377;&#26356;&#39640;&#30340;&#20248;&#20808;&#32423;&#12290;
				</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7401"></a>6.2.5.&nbsp;&#24341;&#20837;&#65288;Introductions&#65289;</h3></div></div><div></div></div><p>
			&#24341;&#20837;&#65288;Introductions&#65289;&#65288;&#22312;AspectJ&#20013;&#34987;&#31216;&#20026;inter-type&#22768;&#26126;&#65289;&#20351;&#24471;&#19968;&#20010;&#20999;&#38754;&#21487;&#20197;&#23450;&#20041;&#34987;&#36890;&#30693;&#23545;&#35937;&#23454;&#29616;&#19968;&#20010;&#32473;&#23450;&#30340;&#25509;&#21475;&#65292;&#24182;&#19988;&#21487;&#20197;&#20195;&#34920;&#37027;&#20123;&#23545;&#35937;&#25552;&#20379;&#20855;&#20307;&#23454;&#29616;&#12290;
			</p><p>&#20351;&#29992; <tt class="interfacename">@DeclareParents</tt>&#27880;&#35299;&#26469;&#23450;&#20041;&#24341;&#20837;&#12290;&#36825;&#20010;&#27880;&#35299;&#34987;&#29992;&#26469;&#23450;&#20041;&#21305;&#37197;&#30340;&#31867;&#22411;&#25317;&#26377;&#19968;&#20010;&#26032;&#30340;&#29238;&#20146;&#12290;
			&#27604;&#22914;&#65292;&#32473;&#23450;&#19968;&#20010;&#25509;&#21475; <tt class="interfacename">UsageTracked</tt>&#65292;&#28982;&#21518;&#25509;&#21475;&#30340;&#20855;&#20307;&#23454;&#29616; <tt class="classname">DefaultUsageTracked</tt> &#31867;&#65292;
			&#25509;&#19979;&#26469;&#30340;&#20999;&#38754;&#22768;&#26126;&#20102;&#25152;&#26377;&#30340;service&#25509;&#21475;&#30340;&#23454;&#29616;&#37117;&#23454;&#29616;&#20102; <tt class="interfacename">UsageTracked</tt> &#25509;&#21475;&#12290;&#65288;&#27604;&#22914;&#20026;&#20102;&#36890;&#36807;JMX&#36755;&#20986;&#32479;&#35745;&#20449;&#24687;&#65289;&#12290;
			</p><pre class="programlisting">@Aspect
public class UsageTracking {

  @DeclareParents(value="com.xzy.myapp.service.*+",
				  defaultImpl=DefaultUsageTracked.class)
  public static UsageTracked mixin;

  @Before("com.xyz.myapp.SystemArchitecture.businessService() &amp;&amp;" +
		  "this(usageTracked)")
  public void recordUsage(UsageTracked usageTracked) {
	usageTracked.incrementUseCount();
  }

}</pre><p>
			&#23454;&#29616;&#30340;&#25509;&#21475;&#36890;&#36807;&#34987;&#27880;&#35299;&#30340;&#23383;&#27573;&#31867;&#22411;&#26469;&#20915;&#23450;&#12290;<tt class="interfacename">@DeclareParents</tt> &#27880;&#35299;&#30340; <tt class="literal">value</tt> &#23646;&#24615;&#26159;&#19968;&#20010;AspectJ&#30340;&#31867;&#22411;&#27169;&#24335;&#65306;-
			&#20219;&#20309;&#21305;&#37197;&#31867;&#22411;&#30340;bean&#37117;&#20250;&#23454;&#29616; <tt class="interfacename">UsageTracked</tt> &#25509;&#21475;&#12290;
			&#35831;&#27880;&#24847;&#65292;&#22312;&#19978;&#38754;&#30340;&#21069;&#32622;&#36890;&#30693;&#65288;before advice&#65289;&#30340;&#20363;&#23376;&#20013;&#65292;service beans &#21487;&#20197;&#30452;&#25509;&#29992;&#20316; <tt class="interfacename">UsageTracked</tt> &#25509;&#21475;&#30340;&#23454;&#29616;&#12290;
			&#22914;&#26524;&#38656;&#35201;&#32534;&#31243;&#24335;&#30340;&#26469;&#35775;&#38382;&#19968;&#20010;bean&#65292;&#20320;&#21487;&#20197;&#36825;&#26679;&#20889;&#65306;
			</p><pre class="programlisting">UsageTracked usageTracked = (UsageTracked) context.getBean("myService");</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7438"></a>6.2.6.&nbsp;&#20999;&#38754;&#23454;&#20363;&#21270;&#27169;&#22411;</h3></div></div><div></div></div><i><span class="remark">&#36825;&#26159;&#19968;&#20010;&#39640;&#32423;&#20027;&#39064;...</span></i><p>
			&#40664;&#35748;&#24773;&#20917;&#19979;&#65292;&#22312;application context&#20013;&#27599;&#19968;&#20010;&#20999;&#38754;&#37117;&#20250;&#26377;&#19968;&#20010;&#23454;&#20363;&#12290;
			AspectJ &#25226;&#36825;&#20010;&#21483;&#20570;&#21333;&#20010;&#23454;&#20363;&#21270;&#27169;&#22411;&#65288;singleton instantiation model&#65289;&#12290;
			&#20063;&#21487;&#20197;&#29992;&#20854;&#20182;&#30340;&#29983;&#21629;&#21608;&#26399;&#26469;&#23450;&#20041;&#20999;&#38754;&#65306;- 
			Spring&#25903;&#25345;AspectJ&#30340; <tt class="literal">perthis</tt> &#21644; <tt class="literal">pertarget</tt> &#23454;&#20363;&#21270;&#27169;&#22411;
			&#65288;&#29616;&#22312;&#36824;&#19981;&#25903;&#25345;<tt class="literal">percflow&#12289;percflowbelow</tt> &#21644; <tt class="literal">pertypewithin</tt> &#65289;&#12290;
	</p><p>
			&#19968;&#20010;"perthis" &#20999;&#38754;&#30340;&#23450;&#20041;&#65306;&#22312; <tt class="interfacename">@Aspect</tt> &#27880;&#35299;&#20013;&#25351;&#23450;<tt class="literal">perthis</tt> &#23376;&#21477;&#12290;
			&#35753;&#25105;&#20204;&#20808;&#26469;&#30475;&#19968;&#20010;&#20363;&#23376;&#65292;&#28982;&#21518;&#35299;&#37322;&#23427;&#26159;&#22914;&#20309;&#36816;&#20316;&#30340;&#65306;
	</p><pre class="programlisting">@Aspect("perthis(com.xyz.myapp.SystemArchitecture.businessService())")
public class MyAspect {

  private int someState;

  @Before(com.xyz.myapp.SystemArchitecture.businessService())
  public void recordServiceUsage() {
	// ...
  }

}</pre><p>
			&#36825;&#20010;perthis&#23376;&#21477;&#30340;&#25928;&#26524;&#26159;&#27599;&#20010;&#29420;&#31435;&#30340;service&#23545;&#35937;&#25191;&#34892;&#26102;&#37117;&#20250;&#21019;&#24314;&#19968;&#20010;&#20999;&#38754;&#23454;&#20363;&#65288;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#25152;&#21305;&#37197;&#30340;&#36830;&#25509;&#28857;&#19978;&#30340;&#27599;&#19968;&#20010;&#29420;&#31435;&#30340;&#23545;&#35937;&#37117;&#20250;&#32465;&#23450;&#21040;'this'&#19978;&#65289;&#12290;
			service&#23545;&#35937;&#30340;&#27599;&#20010;&#26041;&#27861;&#22312;&#31532;&#19968;&#27425;&#25191;&#34892;&#30340;&#26102;&#20505;&#21019;&#24314;&#20999;&#38754;&#23454;&#20363;&#12290;&#20999;&#38754;&#22312;service&#23545;&#35937;&#22833;&#25928;&#30340;&#21516;&#26102;&#22833;&#25928;&#12290;
			&#22312;&#20999;&#38754;&#23454;&#20363;&#34987;&#21019;&#24314;&#21069;&#65292;&#25152;&#26377;&#30340;&#36890;&#30693;&#37117;&#19981;&#20250;&#34987;&#25191;&#34892;&#65292;&#19968;&#26086;&#20999;&#38754;&#23545;&#35937;&#21019;&#24314;&#23436;&#25104;&#65292;&#23450;&#20041;&#30340;&#36890;&#30693;&#23558;&#20250;&#22312;&#21305;&#37197;&#30340;&#36830;&#25509;&#28857;&#19978;&#25191;&#34892;&#65292;&#20294;&#26159;&#21482;&#26377;&#24403;service&#23545;&#35937;&#26159;&#21644;&#20999;&#38754;&#20851;&#32852;&#30340;&#25165;&#21487;&#20197;&#12290;
			&#22914;&#26524;&#24819;&#35201;&#30693;&#36947;&#26356;&#22810;&#20851;&#20110;per-clauses&#30340;&#20449;&#24687;&#65292;&#35831;&#21442;&#38405; AspectJ &#32534;&#31243;&#25351;&#21335;&#12290;
			</p><p>'pertarget'&#23454;&#20363;&#27169;&#22411;&#30340;&#36319;&#8220;perthis&#8221;&#23436;&#20840;&#19968;&#26679;&#65292;&#21482;&#19981;&#36807;&#26159;&#20026;&#27599;&#20010;&#21305;&#37197;&#20110;&#36830;&#25509;&#28857;&#30340;&#29420;&#31435;&#30446;&#26631;&#23545;&#35937;&#21019;&#24314;&#19968;&#20010;&#20999;&#38754;&#23454;&#20363;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-ataspectj-example"></a>6.2.7.&nbsp;&#20363;&#23376;</h3></div></div><div></div></div><p>&#29616;&#22312;&#20320;&#24050;&#32463;&#30475;&#21040;&#20102;&#27599;&#20010;&#29420;&#31435;&#30340;&#37096;&#20998;&#26159;&#22914;&#20309;&#36816;&#20316;&#30340;&#20102;&#65292;&#26159;&#26102;&#20505;&#25226;&#20182;&#20204;&#25918;&#21040;&#19968;&#36215;&#20570;&#19968;&#20123;&#26377;&#29992;&#30340;&#20107;&#24773;&#20102;&#65281;</p><p>
			&#22240;&#20026;&#20048;&#35266;&#38145;&#30340;&#20851;&#31995;&#65292;&#26377;&#26102;&#20505;business services&#21487;&#33021;&#20250;&#22833;&#36133;&#65288;&#26377;&#20154;&#29978;&#33267;&#22312;&#19968;&#24320;&#22987;&#36816;&#34892;&#20107;&#21153;&#30340;&#26102;&#20505;&#23601;&#22833;&#36133;&#20102;&#65289;&#12290;&#22914;&#26524;&#37325;&#26032;&#23581;&#35797;&#19968;&#19979;&#65292;&#24456;&#26377;&#21487;&#33021;&#23601;&#20250;&#25104;&#21151;&#12290;
			&#23545;&#20110;business services&#26469;&#35828;&#65292;&#37325;&#35797;&#20960;&#27425;&#26159;&#24456;&#27491;&#24120;&#30340;&#65288;Idempotent&#25805;&#20316;&#19981;&#38656;&#35201;&#29992;&#25143;&#21442;&#19982;&#65292;&#21542;&#21017;&#20250;&#24471;&#20986;&#30683;&#30462;&#30340;&#32467;&#35770;&#65289;
			&#25105;&#20204;&#21487;&#33021;&#38656;&#35201;&#36879;&#26126;&#30340;&#37325;&#35797;&#25805;&#20316;&#20197;&#36991;&#20813;&#35753;&#23458;&#25143;&#30475;&#35265; <tt class="classname">OptimisticLockingFailureException</tt> &#20363;&#22806;&#34987;&#25243;&#20986;&#12290; 
			&#24456;&#26126;&#26174;&#65292;&#22312;&#19968;&#20010;&#27178;&#20999;&#22810;&#23618;&#30340;&#24773;&#20917;&#19979;&#65292;&#36825;&#26159;&#38750;&#24120;&#26377;&#24517;&#35201;&#30340;&#65292;&#22240;&#27492;&#36890;&#36807;&#20999;&#38754;&#26469;&#23454;&#29616;&#26159;&#24456;&#29702;&#24819;&#30340;&#12290;
			</p><p>&#22240;&#20026;&#25105;&#20204;&#24819;&#35201;&#37325;&#35797;&#25805;&#20316;&#65292;&#25105;&#20204;&#20250;&#38656;&#35201;&#20351;&#29992;&#21040;&#29615;&#32469;&#36890;&#30693;&#65292;&#36825;&#26679;&#25105;&#20204;&#23601;&#21487;&#20197;&#22810;&#27425;&#35843;&#29992;proceed()&#26041;&#27861;&#12290;&#19979;&#38754;&#26159;&#31616;&#21333;&#30340;&#20999;&#38754;&#23454;&#29616;&#65306;</p><pre class="programlisting">@Aspect
public class OptimisticOperationExecutor implements Ordered {

   private static final int DEFAULT_MAX_RETRIES = 2;

   private int maxRetries = DEFAULT_MAX_RETRIES;
   private int order = 1;

   public void setMaxRetries(int maxRetries) {
	  this.maxRetries = maxRetries;
   }

   public int getOrder() {
	  return this.order;
   }

   public void setOrder(int order) {
	  this.order = order;
   }

   @Around("com.xyz.myapp.SystemArchitecture.businessService()")
   public Object doOptimisticOperation(ProceedingJoinPoint pjp) throws Throwable {
	  int numAttempts = 0;
	  OptimisticLockingFailureException lockFailureException;
	  do {
		 numAttempts++;
		 try {
			return pjp.proceed();
		 }
		 catch(OptimisticLockingFailureException ex) {
			lockFailureException = ex;
		 }
	  }
	  while(numAttempts &lt;= this.maxRetries);
	  throw lockFailureException;
   }

}</pre><p>
			&#35831;&#27880;&#24847;&#20999;&#38754;&#23454;&#29616;&#20102; <tt class="interfacename">Ordered</tt> &#25509;&#21475;&#65292;&#36825;&#26679;&#25105;&#20204;&#23601;&#21487;&#20197;&#25226;&#20999;&#38754;&#30340;&#20248;&#20808;&#32423;&#35774;&#23450;&#20026;&#39640;&#20110;&#20107;&#21153;&#36890;&#30693;&#65288;&#25105;&#20204;&#27599;&#27425;&#37325;&#35797;&#30340;&#26102;&#20505;&#37117;&#24819;&#35201;&#22312;&#19968;&#20010;&#20840;&#26032;&#30340;&#20107;&#21153;&#20013;&#36827;&#34892;&#65289;&#12290;
			<tt class="literal">maxRetries</tt> &#21644; <tt class="literal">order</tt> &#23646;&#24615;&#37117;&#21487;&#20197;&#22312;Spring&#20013;&#37197;&#32622;&#12290;
			&#20027;&#35201;&#30340;&#21160;&#20316;&#22312; <tt class="literal">doOptimisticOperation</tt> &#36825;&#20010;&#29615;&#32469;&#36890;&#30693;&#20013;&#21457;&#29983;&#12290;
			&#35831;&#27880;&#24847;&#36825;&#20010;&#26102;&#20505;&#25105;&#20204;&#25152;&#26377;&#30340; <tt class="literal">businessService()</tt> &#26041;&#27861;&#37117;&#20250;&#20351;&#29992;&#36825;&#20010;&#37325;&#35797;&#31574;&#30053;&#12290;
			&#25105;&#20204;&#39318;&#20808;&#20250;&#23581;&#35797;&#22788;&#29702;&#65292;&#28982;&#21518;&#22914;&#26524;&#25105;&#20204;&#24471;&#21040;&#19968;&#20010; <tt class="classname">OptimisticLockingFailureException</tt> &#24847;&#22806;&#65292;&#25105;&#20204;&#21482;&#38656;&#35201;&#31616;&#21333;&#30340;&#37325;&#35797;&#65292;&#30452;&#21040;&#25105;&#20204;&#32791;&#23613;&#25152;&#26377;&#39044;&#35774;&#30340;&#37325;&#35797;&#27425;&#25968;&#12290;
			</p><p>&#23545;&#24212;&#30340;Spring&#37197;&#32622;&#22914;&#19979;&#65306;</p><pre class="programlisting">&lt;aop:aspectj-autoproxy/&gt;

&lt;bean id="optimisticOperationExecutor"
  class="com.xyz.myapp.service.impl.OptimisticOperationExecutor"&gt;
	 &lt;property name="maxRetries" value="3"/&gt;
	 &lt;property name="order" value="100"/&gt;
&lt;/bean&gt;</pre><p>&#20026;&#20102;&#25913;&#36827;&#20999;&#38754;&#65292;&#20351;&#20043;&#20165;&#20165;&#37325;&#35797;idempotent&#25805;&#20316;&#65292;&#25105;&#20204;&#21487;&#20197;&#23450;&#20041;&#19968;&#20010; <tt class="interfacename">Idempotent</tt> &#27880;&#35299;&#65306;</p><pre class="programlisting">@Retention(RetentionPolicy.RUNTIME)
public @interface Idempotent {
  // marker annotation
}</pre><p>
			&#24182;&#19988;&#23545;service&#25805;&#20316;&#30340;&#23454;&#29616;&#36827;&#34892;&#27880;&#35299;&#12290;
			&#36825;&#26679;&#22914;&#26524;&#20320;&#21482;&#24076;&#26395;&#25913;&#21464;&#20999;&#38754;&#20351;&#24471;idempotent&#30340;&#25805;&#20316;&#20250;&#23581;&#35797;&#22810;&#27425;&#65292;&#20320;&#21482;&#38656;&#35201;&#25913;&#20889;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#65292;&#36825;&#26679;&#21482;&#26377; <tt class="interfacename">@Idempotent</tt> &#25805;&#20316;&#20250;&#21305;&#37197;&#65306;
			</p><pre class="programlisting">@Around("com.xyz.myapp.SystemArchitecture.businessService() &amp;&amp; " +
		"@annotation(com.xyz.myapp.service.Idempotent)")
public Object doOptimisticOperation(ProceedingJoinPoint pjp) throws Throwable {
  ...
}</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-schema"></a>6.3.&nbsp;Schema-based AOP support</h2></div></div><div></div></div><p>
		&#22914;&#26524;&#20320;&#26080;&#27861;&#20351;&#29992;Java 5&#65292;&#25110;&#32773;&#20320;&#27604;&#36739;&#21916;&#27426;&#20351;&#29992;XML&#26684;&#24335;&#65292;Spring2.0&#20063;&#25552;&#20379;&#20102;&#20351;&#29992;&#26032;&#30340;"aop"&#21629;&#21517;&#31354;&#38388;&#26469;&#23450;&#20041;&#19968;&#20010;&#20999;&#38754;&#12290;
		&#21644;&#20351;&#29992;@AspectJ&#39118;&#26684;&#23436;&#20840;&#19968;&#26679;&#65292;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#21644;&#36890;&#30693;&#31867;&#22411;&#21516;&#26679;&#24471;&#21040;&#20102;&#25903;&#25345;&#65292;&#22240;&#27492;&#22312;&#36825;&#19968;&#33410;&#20013;&#25105;&#20204;&#23558;&#30528;&#37325;&#20171;&#32461;&#26032;&#30340; <span class="emphasis"><em>&#35821;&#27861;</em></span>
		&#21644;&#22238;&#39038;&#21069;&#38754;&#25105;&#20204;&#25152;&#35752;&#35770;&#30340;&#22914;&#20309;&#20889;&#19968;&#20010;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#21644;&#36890;&#30693;&#21442;&#25968;&#30340;&#32465;&#23450;&#31561;&#31561;&#65288;<a href="aop.html#aop-ataspectj" title="6.2.&nbsp;@AspectJ&#25903;&#25345;">Section&nbsp;6.2, &#8220;@AspectJ&#25903;&#25345;&#8221;</a>)&#12290;
		</p><p>
		&#20351;&#29992;&#26412;&#31456;&#25152;&#20171;&#32461;&#30340;aop&#21629;&#21517;&#31354;&#38388;&#26631;&#31614;&#65288;aop namespace tag&#65289;&#65292;&#20320;&#38656;&#35201;&#24341;&#20837;<a href="xsd-config.html" title="Appendix&nbsp;A.&nbsp;XML Schema-based configuration">Appendix&nbsp;A, <i>XML Schema-based configuration</i></a>&#20013;&#25552;&#21450;&#30340;spring-aop schema&#12290;
		&#21442;&#35265;<a href="xsd-config.html#xsd-config-body-schemas-aop" title="A.2.6.&nbsp;The aop schema">Section&nbsp;A.2.6, &#8220;The aop schema&#8221;</a>&#12290;
		</p><p>
		&#22312;Spring&#30340;&#37197;&#32622;&#25991;&#20214;&#20013;&#65292;&#25152;&#26377;&#30340;&#20999;&#38754;&#21644;&#36890;&#30693;&#22120;&#37117;&#24517;&#39035;&#23450;&#20041;&#22312; <tt class="literal">&lt;aop:config&gt;</tt> &#20803;&#32032;&#20869;&#37096;&#12290;
		&#19968;&#20010;application context&#21487;&#20197;&#21253;&#21547;&#22810;&#20010; <tt class="literal">&lt;aop:config&gt;</tt>&#12290;
		&#19968;&#20010; <tt class="literal">&lt;aop:config&gt;</tt> &#21487;&#20197;&#21253;&#21547;pointcut&#65292;advisor&#21644;aspect&#20803;&#32032;&#65292;&#24182;&#19988;&#19977;&#32773;&#24517;&#39035;&#25353;&#29031;&#36825;&#26679;&#30340;&#39034;&#24207;&#36827;&#34892;&#22768;&#26126;&#12290;
		</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7550"></a>6.3.1.&nbsp;&#22768;&#26126;&#19968;&#20010;&#20999;&#38754;</h3></div></div><div></div></div><p>
			&#26377;&#20102;schema&#30340;&#25903;&#25345;&#65292;&#20999;&#38754;&#23601;&#21644;&#24120;&#35268;&#30340;Java&#23545;&#35937;&#19968;&#26679;&#34987;&#23450;&#20041;&#25104;application context&#20013;&#30340;&#19968;&#20010;bean&#12290;
			&#23545;&#35937;&#30340;&#23383;&#27573;&#21644;&#26041;&#27861;&#25552;&#20379;&#20102;&#29366;&#24577;&#21644;&#34892;&#20026;&#20449;&#24687;&#65292;XML&#25991;&#20214;&#21017;&#25552;&#20379;&#20102;&#20999;&#20837;&#28857;&#21644;&#36890;&#30693;&#20449;&#24687;&#12290;
			</p><p>&#20999;&#38754;&#20351;&#29992;&lt;aop:aspect&gt;&#26469;&#22768;&#26126;&#65292;backing bean&#65288;&#25903;&#25345;bean&#65289;&#36890;&#36807; <tt class="literal">ref</tt> &#23646;&#24615;&#26469;&#24341;&#29992;&#65306;</p><pre class="programlisting">&lt;aop:config&gt;
  &lt;aop:aspect id="myAspect" ref="aBean"&gt;
	...
  &lt;/aop:aspect&gt;
&lt;/aop:config&gt;

&lt;bean id="aBean" class="..."&gt;
  ...
&lt;/bean&gt;</pre><p>&#20999;&#38754;&#30340;&#25903;&#25345;bean&#65288;&#19978;&#20363;&#20013;&#30340;"<tt class="literal">aBean</tt>"&#65289;&#21487;&#20197;&#35937;&#20854;&#20182;Spring bean&#19968;&#26679;&#34987;&#23481;&#22120;&#31649;&#29702;&#37197;&#32622;&#20197;&#21450;&#20381;&#36182;&#27880;&#20837;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7567"></a>6.3.2.&nbsp;&#22768;&#26126;&#19968;&#20010;&#20999;&#20837;&#28857;</h3></div></div><div></div></div><p>
			&#20999;&#20837;&#28857;&#21487;&#20197;&#22312;&#20999;&#38754;&#37324;&#38754;&#22768;&#26126;&#65292;&#36825;&#31181;&#24773;&#20917;&#19979;&#20999;&#20837;&#28857;&#21482;&#22312;&#20999;&#38754;&#20869;&#37096;&#21487;&#35265;&#12290;&#20999;&#20837;&#28857;&#20063;&#21487;&#20197;&#30452;&#25509;&#22312;&lt;aop:config&gt;&#19979;&#23450;&#20041;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#20351;&#22810;&#20010;&#20999;&#38754;&#21644;&#36890;&#30693;&#22120;&#20849;&#20139;&#35813;&#20999;&#20837;&#28857;&#12290;
			</p><p>&#19968;&#20010;&#25551;&#36848;service&#23618;&#20013;&#34920;&#31034;&#25152;&#26377;service&#25191;&#34892;&#30340;&#20999;&#20837;&#28857;&#21487;&#20197;&#22914;&#19979;&#23450;&#20041;&#65306;</p><pre class="programlisting">&lt;aop:config&gt;

  &lt;aop:pointcut id="businessService"
		expression="execution(* com.xyz.myapp.service.*.*(..))"/&gt;

&lt;/aop:config&gt;</pre><p>
			&#27880;&#24847;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#26412;&#36523;&#20351;&#29992;&#20102; <a href="aop.html#aop-ataspectj" title="6.2.&nbsp;@AspectJ&#25903;&#25345;">Section&nbsp;6.2, &#8220;@AspectJ&#25903;&#25345;&#8221;</a> &#20013;&#25551;&#36848;&#30340;AspectJ &#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#35821;&#35328;&#12290;
			&#22914;&#26524;&#20320;&#22312;Java 5&#29615;&#22659;&#19979;&#20351;&#29992;&#22522;&#20110;schema&#30340;&#22768;&#26126;&#39118;&#26684;&#65292;&#21487;&#21442;&#32771;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#31867;&#22411;&#20013;&#23450;&#20041;&#30340;&#21629;&#21517;&#24335;&#20999;&#20837;&#28857;&#65292;&#19981;&#36807;&#36825;&#22312;JDK1.4&#21450;&#20197;&#19979;&#29256;&#26412;&#20013;&#26159;&#19981;&#34987;&#25903;&#25345;&#30340;&#65288;&#22240;&#20026;&#20381;&#36182;&#20110;Java 5&#20013;&#30340;AspectJ&#21453;&#23556;API&#65289;&#12290;
			&#25152;&#20197;&#22312;JDK 1.5&#20013;&#65292;&#19978;&#38754;&#30340;&#20999;&#20837;&#28857;&#30340;&#21478;&#22806;&#19968;&#31181;&#23450;&#20041;&#24418;&#24335;&#22914;&#19979;&#65306;
			</p><pre class="programlisting">&lt;aop:config&gt;

  &lt;aop:pointcut id="businessService"
		expression="com.xyz.myapp.SystemArchitecture.businessService()"/&gt;

&lt;/aop:config&gt;</pre><p>&#20551;&#23450;&#20320;&#26377; <a href="aop.html#aop-common-pointcuts" title="6.2.3.3.&nbsp;&#20849;&#20139;&#24120;&#35265;&#30340;&#20999;&#20837;&#28857;&#65288;pointcut&#65289;&#23450;&#20041;">Section&nbsp;6.2.3.3, &#8220;&#20849;&#20139;&#24120;&#35265;&#30340;&#20999;&#20837;&#28857;&#65288;pointcut&#65289;&#23450;&#20041;&#8221;</a>&#20013;&#35828;&#25551;&#36848;&#30340; <tt class="literal">SystemArchitecture</tt> &#20999;&#38754;&#12290;</p><p>&#22312;&#20999;&#38754;&#37324;&#38754;&#22768;&#26126;&#19968;&#20010;&#20999;&#20837;&#28857;&#21644;&#22768;&#26126;&#19968;&#20010;&#39030;&#32423;&#30340;&#20999;&#20837;&#28857;&#38750;&#24120;&#31867;&#20284;&#65306;</p><pre class="programlisting">&lt;aop:config&gt;

  &lt;aop:aspect id="myAspect" ref="aBean"&gt;

	&lt;aop:pointcut id="businessService"
		  expression="execution(* com.xyz.myapp.service.*.*(..))"/&gt;

	...

  &lt;/aop:aspect&gt;

&lt;/aop:config&gt;</pre><p>
			&#24403;&#38656;&#35201;&#36830;&#25509;&#23376;&#34920;&#36798;&#24335;&#30340;&#26102;&#20505;&#65292;'&amp;&amp;'&#22312;XML&#20013;&#29992;&#36215;&#26469;&#38750;&#24120;&#19981;&#26041;&#20415;&#65292;&#25152;&#20197;&#20851;&#38190;&#23383;'and', 'or' &#21644; 'not'&#21487;&#20197;&#20998;&#21035;&#29992;&#26469;&#20195;&#26367;'&amp;&amp;', '||' &#21644; '!'&#12290;
			</p><p>
			&#27880;&#24847;&#36825;&#31181;&#26041;&#24335;&#23450;&#20041;&#30340;&#20999;&#20837;&#28857;&#36890;&#36807;XML id&#26469;&#26597;&#25214;&#65292;&#24182;&#19988;&#19981;&#33021;&#23450;&#20041;&#20999;&#20837;&#28857;&#21442;&#25968;&#12290;&#22312;&#22522;&#20110;schema&#30340;&#23450;&#20041;&#39118;&#26684;&#20013;&#21629;&#21517;&#20999;&#20837;&#28857;&#25903;&#25345;&#36739;&#20043;@AspectJ&#39118;&#26684;&#21463;&#21040;&#20102;&#24456;&#22810;&#30340;&#38480;&#21046;&#12290;
			</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7597"></a>6.3.3.&nbsp;&#22768;&#26126;&#36890;&#30693;</h3></div></div><div></div></div><p>&#21644;@AspectJ&#39118;&#26684;&#19968;&#26679;&#65292;&#22522;&#20110;schema&#30340;&#39118;&#26684;&#20063;&#25903;&#25345;5&#31181;&#36890;&#30693;&#31867;&#22411;&#24182;&#19988;&#20004;&#32773;&#20855;&#26377;&#21516;&#26679;&#30340;&#35821;&#20041;&#12290;</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7602"></a>6.3.3.1.&nbsp;&#36890;&#30693;&#65288;Advice&#65289;</h4></div></div><div></div></div><p>Before&#36890;&#30693;&#22312;&#21305;&#37197;&#26041;&#27861;&#25191;&#34892;&#21069;&#36827;&#20837;&#12290;&#22312;<tt class="literal">&lt;aop:aspect&gt;</tt>&#37324;&#38754;&#20351;&#29992;&lt;aop:before&gt;&#20803;&#32032;&#36827;&#34892;&#22768;&#26126;&#12290;</p><pre class="programlisting">&lt;aop:aspect id="beforeExample" ref="aBean"&gt;

	&lt;aop:before
	  pointcut-ref="dataAccessOperation"
	  method="doAccessCheck"/&gt;

	...

&lt;/aop:aspect&gt;</pre><p>
				&#36825;&#37324; <tt class="literal">dataAccessOperation</tt> &#26159;&#19968;&#20010;&#39030;&#32423;&#65288;<tt class="literal">&lt;aop:config&gt;</tt>&#65289;&#20999;&#20837;&#28857;&#30340;id&#12290;
				&#35201;&#23450;&#20041;&#20869;&#32622;&#20999;&#20837;&#28857;&#65292;&#21487;&#23558; <tt class="literal">pointcut-ref</tt> &#23646;&#24615;&#26367;&#25442;&#20026; <tt class="literal">pointcut</tt> &#23646;&#24615;&#65306;
				</p><pre class="programlisting">&lt;aop:aspect id="beforeExample" ref="aBean"&gt;

	&lt;aop:before
	  pointcut="execution(* com.xyz.myapp.dao.*.*(..))"
	  method="doAccessCheck"/&gt;

	...

&lt;/aop:aspect&gt;</pre><p>
				&#25105;&#20204;&#24050;&#32463;&#22312;@AspectJ&#39118;&#26684;&#31456;&#33410;&#20013;&#35752;&#35770;&#36807;&#20102;&#65292;&#20351;&#29992;&#21629;&#21517;&#20999;&#20837;&#28857;&#33021;&#22815;&#26126;&#26174;&#30340;&#25552;&#39640;&#20195;&#30721;&#30340;&#21487;&#35835;&#24615;&#12290;
				</p><p>
				Method&#23646;&#24615;&#26631;&#35782;&#20102;&#25552;&#20379;&#20102;&#36890;&#30693;&#30340;&#20027;&#20307;&#30340;&#26041;&#27861;&#65288;<tt class="literal">doAccessCheck</tt>&#65289;&#12290;&#36825;&#20010;&#26041;&#27861;&#24517;&#39035;&#23450;&#20041;&#22312;&#21253;&#21547;&#36890;&#30693;&#30340;&#20999;&#38754;&#20803;&#32032;&#25152;&#24341;&#29992;&#30340;bean&#20013;&#12290;
				&#22312;&#19968;&#20010;&#25968;&#25454;&#35775;&#38382;&#25805;&#20316;&#25191;&#34892;&#20043;&#21069;&#65288;&#25191;&#34892;&#36830;&#25509;&#28857;&#21644;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#21305;&#37197;&#65289;&#65292;&#20999;&#38754;&#20013;&#30340;"doAccessCheck"&#20250;&#34987;&#35843;&#29992;&#12290;
				</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7635"></a>6.3.3.2.&nbsp;&#36820;&#22238;&#21518;&#36890;&#30693;&#65288;After returning advice&#65289;</h4></div></div><div></div></div><p>After returning&#36890;&#30693;&#22312;&#21305;&#37197;&#30340;&#26041;&#27861;&#23436;&#20840;&#25191;&#34892;&#21518;&#36816;&#34892;&#12290;&#21644;Before&#36890;&#30693;&#19968;&#26679;&#65292;&#21487;&#20197;&#22312;<tt class="literal">&lt;aop:aspect&gt;</tt>&#37324;&#38754;&#22768;&#26126;&#12290;&#20363;&#22914;&#65306;</p><pre class="programlisting">&lt;aop:aspect id="afterReturningExample" ref="aBean"&gt;

	&lt;aop:after-returning
	  pointcut-ref="dataAccessOperation"
	  method="doAccessCheck"/&gt;

	...

&lt;/aop:aspect&gt;</pre><p>&#21644;@AspectJ&#39118;&#26684;&#19968;&#26679;&#65292;&#36890;&#30693;&#20027;&#20307;&#21487;&#20197;&#25509;&#25910;&#36820;&#22238;&#20540;&#12290;&#20351;&#29992;returning&#23646;&#24615;&#26469;&#25351;&#23450;&#25509;&#25910;&#36820;&#22238;&#20540;&#30340;&#21442;&#25968;&#21517;&#65306;</p><pre class="programlisting">&lt;aop:aspect id="afterReturningExample" ref="aBean"&gt;

	&lt;aop:after-returning
	  pointcut-ref="dataAccessOperation"
	  returning="retVal"
	  method="doAccessCheck"/&gt;

	...

&lt;/aop:aspect&gt;</pre><p>
				doAccessCheck&#26041;&#27861;&#24517;&#39035;&#22768;&#26126;&#19968;&#20010;&#21517;&#23383;&#21483; <tt class="literal">retVal</tt> &#30340;&#21442;&#25968;&#12290;
				&#21442;&#25968;&#30340;&#31867;&#22411;&#24378;&#21046;&#21305;&#37197;&#65292;&#21644;&#20808;&#21069;&#25105;&#20204;&#22312;@AfterReturning&#20013;&#35762;&#21040;&#30340;&#19968;&#26679;&#12290;&#20363;&#22914;&#65292;&#26041;&#27861;&#31614;&#21517;&#21487;&#20197;&#36825;&#26679;&#22768;&#26126;&#65306;
				</p><pre class="programlisting">public void doAccessCheck(Object retVal) {...</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7656"></a>6.3.3.3.&nbsp;&#25243;&#20986;&#24322;&#24120;&#21518;&#36890;&#30693;&#65288;After throwing advice&#65289;</h4></div></div><div></div></div><p>After throwing&#36890;&#30693;&#22312;&#21305;&#37197;&#26041;&#27861;&#25243;&#20986;&#24322;&#24120;&#36864;&#20986;&#26102;&#25191;&#34892;&#12290;&#22312; <tt class="literal">&lt;aop:aspect&gt;</tt> &#20013;&#20351;&#29992;after-throwing&#20803;&#32032;&#26469;&#22768;&#26126;&#65306;</p><pre class="programlisting">&lt;aop:aspect id="afterThrowingExample" ref="aBean"&gt;

	&lt;aop:after-throwing
	  pointcut-ref="dataAccessOperation"
	  method="doRecoveryActions"/&gt;

	...

&lt;/aop:aspect&gt;</pre><p>
				&#21644;@AspectJ&#39118;&#26684;&#19968;&#26679;&#65292;&#21487;&#20197;&#20174;&#36890;&#30693;&#20307;&#20013;&#33719;&#21462;&#25243;&#20986;&#30340;&#24322;&#24120;&#12290;
				&#20351;&#29992;throwing&#23646;&#24615;&#26469;&#25351;&#23450;&#24322;&#24120;&#30340;&#21517;&#31216;&#65292;&#29992;&#36825;&#20010;&#21517;&#31216;&#26469;&#33719;&#21462;&#24322;&#24120;&#65306;
				</p><pre class="programlisting">&lt;aop:aspect id="afterThrowingExample" ref="aBean"&gt;

	&lt;aop:after-throwing
	  pointcut-ref="dataAccessOperation"
	  thowing="dataAccessEx"
	  method="doRecoveryActions"/&gt;

	...

&lt;/aop:aspect&gt;</pre><p>
				doRecoveryActions&#26041;&#27861;&#24517;&#39035;&#22768;&#26126;&#19968;&#20010;&#21517;&#23383;&#20026; <tt class="literal">dataAccessEx</tt> &#30340;&#21442;&#25968;&#12290;
				&#21442;&#25968;&#30340;&#31867;&#22411;&#24378;&#21046;&#21305;&#37197;&#65292;&#21644;&#20808;&#21069;&#25105;&#20204;&#22312;@AfterThrowing&#20013;&#35762;&#21040;&#30340;&#19968;&#26679;&#12290;&#20363;&#22914;&#65306;&#26041;&#27861;&#31614;&#21517;&#21487;&#20197;&#22914;&#19979;&#36825;&#33324;&#22768;&#26126;&#65306;
				</p><pre class="programlisting">public void doRecoveryActions(DataAccessException dataAccessEx) {...</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7677"></a>6.3.3.4.&nbsp;&#21518;&#36890;&#30693;&#65288;After (finally) advice&#65289;</h4></div></div><div></div></div><p>
				After (finally)&#36890;&#30693;&#22312;&#21305;&#37197;&#26041;&#27861;&#36864;&#20986;&#21518;&#25191;&#34892;&#12290;&#20351;&#29992; <tt class="literal">after</tt> &#20803;&#32032;&#26469;&#22768;&#26126;&#65306;
				</p><pre class="programlisting">&lt;aop:aspect id="afterFinallyExample" ref="aBean"&gt;

	&lt;aop:after
	  pointcut-ref="dataAccessOperation"
	  method="doReleaseLock"/&gt;

	...

&lt;/aop:aspect&gt;</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7687"></a>6.3.3.5.&nbsp;&#36890;&#30693;</h4></div></div><div></div></div><p>
				Around&#36890;&#30693;&#26159;&#26368;&#21518;&#19968;&#31181;&#36890;&#30693;&#31867;&#22411;&#12290;Around&#36890;&#30693;&#22312;&#21305;&#37197;&#26041;&#27861;&#36816;&#34892;&#26399;&#30340;&#8220;&#21608;&#22260;&#8221;&#25191;&#34892;&#12290;
				&#23427;&#26377;&#26426;&#20250;&#22312;&#30446;&#26631;&#26041;&#27861;&#30340;&#21069;&#38754;&#21644;&#21518;&#38754;&#25191;&#34892;&#65292;&#24182;&#20915;&#23450;&#20160;&#20040;&#26102;&#20505;&#36816;&#34892;&#65292;&#24590;&#20040;&#36816;&#34892;&#65292;&#29978;&#33267;&#26159;&#21542;&#36816;&#34892;&#12290;
				Around&#36890;&#30693;&#32463;&#24120;&#22312;&#38656;&#35201;&#22312;&#19968;&#20010;&#26041;&#27861;&#25191;&#34892;&#21069;&#25110;&#21518;&#20849;&#20139;&#29366;&#24577;&#20449;&#24687;&#65292;&#24182;&#19988;&#26159;&#32447;&#31243;&#23433;&#20840;&#30340;&#24773;&#20917;&#19979;&#20351;&#29992;&#65288;&#21551;&#21160;&#21644;&#20572;&#27490;&#19968;&#20010;&#35745;&#26102;&#22120;&#23601;&#26159;&#19968;&#20010;&#20363;&#23376;&#65289;&#12290;
				&#27880;&#24847;&#36873;&#25321;&#33021;&#28385;&#36275;&#20320;&#38656;&#27714;&#30340;&#26368;&#31616;&#21333;&#30340;&#36890;&#30693;&#31867;&#22411;&#65288;i.e.&#22914;&#26524;&#31616;&#21333;&#30340;before&#36890;&#30693;&#23601;&#33021;&#20570;&#30340;&#20107;&#24773;&#32477;&#23545;&#19981;&#35201;&#20351;&#29992;around&#36890;&#30693;&#65289;&#12290;
				</p><p>
				Around&#36890;&#30693;&#20351;&#29992; <tt class="literal">aop:around</tt> &#20803;&#32032;&#26469;&#22768;&#26126;&#12290;
				&#36890;&#30693;&#26041;&#27861;&#30340;&#31532;&#19968;&#20010;&#21442;&#25968;&#30340;&#31867;&#22411;&#24517;&#39035;&#26159; <tt class="interfacename">ProceedingJoinPoint</tt> &#31867;&#22411;&#12290;
				&#22312;&#36890;&#30693;&#30340;&#20027;&#20307;&#20013;&#65292;&#35843;&#29992; <tt class="interfacename">ProceedingJoinPoint</tt>&#30340;<tt class="literal">proceed()</tt> &#26041;&#27861;&#26469;&#25191;&#34892;&#30495;&#27491;&#30340;&#26041;&#27861;&#12290;
				<tt class="literal">proceed</tt> &#26041;&#27861;&#20063;&#21487;&#33021;&#20250;&#34987;&#35843;&#29992;&#24182;&#19988;&#20256;&#20837;&#19968;&#20010; <tt class="classname">Object[]</tt> &#23545;&#35937; - &#35813;&#25968;&#32452;&#23558;&#20316;&#20026;&#26041;&#27861;&#25191;&#34892;&#26102;&#20505;&#30340;&#21442;&#25968;&#12290;
				&#21442;&#35265; <a href="aop.html#aop-ataspectj-around-advice" title="6.2.4.5.&nbsp;&#29615;&#32469;&#36890;&#30693;&#65288;Around Advice&#65289;">Section&nbsp;6.2.4.5, &#8220;&#29615;&#32469;&#36890;&#30693;&#65288;Around Advice&#65289;&#8221;</a> &#20013;&#25552;&#21040;&#30340;&#19968;&#20123;&#27880;&#24847;&#28857;&#12290;
				</p><pre class="programlisting">&lt;aop:aspect id="aroundExample" ref="aBean"&gt;

	&lt;aop:around
	  pointcut-ref="businessService"
	  method="doBasicProfiling"/&gt;

	...

&lt;/aop:aspect&gt;</pre><p>
					<tt class="literal">doBasicProfiling</tt> &#36890;&#30693;&#30340;&#23454;&#29616;&#21644;@AspectJ&#20013;&#30340;&#20363;&#23376;&#23436;&#20840;&#19968;&#26679;&#65288;&#24403;&#28982;&#35201;&#21435;&#25481;&#27880;&#35299;&#65289;&#65306;</p><pre class="programlisting">public Object doBasicProfiling(ProceedingJoinPoint pjp) throws Throwable {
	// start stopwatch
	Object retVal = pjp.proceed();
	// stop stopwatch
	return retVal;
}</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7723"></a>6.3.3.6.&nbsp;&#36890;&#30693;&#21442;&#25968;</h4></div></div><div></div></div><p> 
				Schema-based&#22768;&#26126;&#39118;&#26684;&#21644;@AspectJ&#25903;&#25345;&#19968;&#26679;&#65292;&#25903;&#25345;&#36890;&#30693;&#30340;&#20840;&#21517;&#24418;&#24335; - &#36890;&#36807;&#36890;&#30693;&#26041;&#27861;&#21442;&#25968;&#21517;&#23383;&#26469;&#21305;&#37197;&#20999;&#20837;&#28857;&#21442;&#25968;&#12290;
				&#21442;&#35265; <a href="aop.html#aop-ataspectj-advice-params" title="6.2.4.6.&nbsp;&#36890;&#30693;&#21442;&#25968;&#65288;Advice parameters&#65289;">Section&nbsp;6.2.4.6, &#8220;&#36890;&#30693;&#21442;&#25968;&#65288;Advice parameters&#65289;&#8221;</a> &#33719;&#21462;&#35814;&#32454;&#20449;&#24687;&#12290;
				</p><p>
				&#22914;&#26524;&#20320;&#24076;&#26395;&#26174;&#24335;&#25351;&#23450;&#36890;&#30693;&#26041;&#27861;&#30340;&#21442;&#25968;&#21517;&#65288;&#32780;&#19981;&#26159;&#20381;&#38752;&#20808;&#21069;&#25552;&#21450;&#30340;&#20390;&#27979;&#31574;&#30053;&#65289;&#65292;&#21487;&#20197;&#36890;&#36807; <tt class="literal">arg-names</tt> &#23646;&#24615;&#26469;&#23454;&#29616;&#12290;&#31034;&#20363;&#22914;&#19979;&#65306;
				</p><pre class="programlisting">&lt;aop:before
  pointcut="com.xyz.lib.Pointcuts.anyPublicMethod() and @annotation(auditable)"
  method="audit"
  arg-names="auditable"/&gt;</pre><p>The <tt class="literal">arg-names</tt> attribute accepts a comma-delimited list of
	parameter names.</p><p>
					<tt class="literal">arg-names</tt>&#23646;&#24615;&#25509;&#21463;&#30001;&#36887;&#21495;&#20998;&#21106;&#30340;&#21442;&#25968;&#21517;&#21015;&#34920;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e7747"></a>6.3.3.7.&nbsp;&#36890;&#30693;&#39034;&#24207;</h4></div></div><div></div></div><p>
				&#24403;&#21516;&#19968;&#20010;&#20999;&#20837;&#28857;&#65288;&#25191;&#34892;&#26041;&#27861;&#65289;&#19978;&#26377;&#22810;&#20010;&#36890;&#30693;&#38656;&#35201;&#25191;&#34892;&#26102;&#65292;&#25191;&#34892;&#39034;&#24207;&#35268;&#21017;&#22312; <a href="aop.html#aop-ataspectj-advice-ordering" title="6.2.4.7.&nbsp;&#36890;&#30693;&#65288;Advice&#65289;&#39034;&#24207;">Section&nbsp;6.2.4.7, &#8220;&#36890;&#30693;&#65288;Advice&#65289;&#39034;&#24207;&#8221;</a> &#24050;&#32463;&#25552;&#21450;&#20102;&#12290;
				&#20999;&#38754;&#30340;&#20248;&#20808;&#32423;&#36890;&#36807;&#20999;&#38754;&#30340;&#25903;&#25345;bean&#26159;&#21542;&#23454;&#29616;&#20102;<tt class="interfacename">Ordered</tt>&#25509;&#21475;&#26469;&#20915;&#23450;&#12290;
				</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7757"></a>6.3.4.&nbsp;&#24341;&#20837;</h3></div></div><div></div></div><p>
			Intrduction &#65288;&#22312;AspectJ&#20013;&#25104;&#20026;inter-type&#22768;&#26126;&#65289;&#20801;&#35768;&#19968;&#20010;&#20999;&#38754;&#22768;&#26126;&#19968;&#20010;&#36890;&#30693;&#23545;&#35937;&#23454;&#29616;&#25351;&#23450;&#25509;&#21475;&#65292;&#24182;&#19988;&#25552;&#20379;&#20102;&#19968;&#20010;&#25509;&#21475;&#23454;&#29616;&#31867;&#26469;&#20195;&#34920;&#36825;&#20123;&#23545;&#35937;&#12290;
			</p><p>
			&#22312; <tt class="literal">aop:aspect</tt> &#20869;&#37096;&#20351;&#29992; <tt class="literal">aop:declare-parents</tt> &#20803;&#32032;&#23450;&#20041;Introduction&#12290;
			&#35813;&#20803;&#32032;&#29992;&#20110;&#29992;&#26469;&#22768;&#26126;&#25152;&#21305;&#37197;&#30340;&#31867;&#22411;&#26377;&#20102;&#19968;&#20010;&#26032;&#30340;&#29238;&#31867;&#22411;&#65288;&#25152;&#20197;&#26377;&#20102;&#36825;&#20010;&#21517;&#23383;&#65289;&#12290;
			&#20363;&#22914;&#65292;&#32473;&#23450;&#25509;&#21475; <tt class="interfacename">UsageTracked</tt>&#65292;
&#20197;&#21450;&#36825;&#20010;&#25509;&#21475;&#30340;&#19968;&#20010;&#23454;&#29616;&#31867; <tt class="classname">DefaultUsageTracked</tt>&#65292;
			&#19979;&#38754;&#22768;&#26126;&#30340;&#20999;&#38754;&#25152;&#26377;&#23454;&#29616;service&#25509;&#21475;&#30340;&#31867;&#21516;&#26102;&#23454;&#29616; <tt class="interfacename">UsageTracked</tt> &#25509;&#21475;&#12290;&#65288;&#27604;&#22914;&#20026;&#20102;&#36890;&#36807;JMX&#26292;&#38706;statistics&#12290;&#65289;
			</p><pre class="programlisting">&lt;aop:aspect id="usageTrackerAspect" ref="usageTracking"&gt;

  &lt;aop:declare-parents
	  types-matching="com.xzy.myapp.service.*+",
	  implement-interface="UsageTracked"
	  default-impl="com.xyz.myapp.service.tracking.DefaultUsageTracked"/&gt;

  &lt;aop:before
	pointcut="com.xyz.myapp.SystemArchitecture.businessService()
			  and this(usageTracked)"
	method="recordUsage"/&gt;

&lt;/aop:aspect&gt;</pre><p>The class backing the <tt class="literal">usageTracking</tt> bean would contain the
	method:</p><p>
				<tt class="literal">usageTracking</tt> bean&#30340;&#25903;&#25345;&#31867;&#21487;&#20197;&#21253;&#21547;&#19979;&#38754;&#30340;&#26041;&#27861;&#65306;
	</p><pre class="programlisting">public void (UsageTracked usageTracked) {
	usageTracked.incrementUseCount();
}</pre><p>
			&#27442;&#23454;&#29616;&#30340;&#25509;&#21475;&#30001; <tt class="literal">implement-interface</tt> &#23646;&#24615;&#26469;&#25351;&#23450;&#12290;
			<tt class="literal">types-matching</tt> &#23646;&#24615;&#30340;&#20540;&#26159;&#19968;&#20010;AspectJ&#31867;&#22411;&#27169;&#24335;&#65306;-  &#20219;&#20309;&#21305;&#37197;&#31867;&#22411;&#30340;bean&#20250;&#23454;&#29616; <tt class="interfacename">UsageTracked</tt> &#25509;&#21475;&#12290;
			&#27880;&#24847;&#22312;Before&#36890;&#30693;&#30340;&#20363;&#23376;&#20013;&#65292;srevice bean&#21487;&#20197;&#29992;&#20316; <tt class="interfacename">UsageTracked</tt> &#25509;&#21475;&#30340;&#23454;&#29616;&#12290;
			&#22914;&#26524;&#32534;&#31243;&#24418;&#24335;&#35775;&#38382;&#19968;&#20010;bean&#65292;&#20320;&#21487;&#20197;&#36825;&#26679;&#26469;&#20889;&#65306;
			</p><pre class="programlisting">UsageTracked usageTracked = (UsageTracked) context.getBean("myService");</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7809"></a>6.3.5.&nbsp;&#20999;&#38754;&#23454;&#20363;&#21270;&#27169;&#22411;</h3></div></div><div></div></div><p>Schema-defined&#20999;&#38754;&#20165;&#25903;&#25345;&#19968;&#31181;&#23454;&#20363;&#21270;&#27169;&#22411;&#23601;&#26159;singlton&#27169;&#22411;&#12290;&#20854;&#20182;&#30340;&#23454;&#20363;&#21270;&#27169;&#22411;&#25110;&#35768;&#22312;&#26410;&#26469;&#29256;&#26412;&#20013;&#23558;&#24471;&#21040;&#25903;&#25345;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7814"></a>6.3.6.&nbsp;Advisors</h3></div></div><div></div></div><p>
			"advisors"&#36825;&#20010;&#27010;&#24565;&#26469;&#33258;Spring1.2&#23545;AOP&#30340;&#25903;&#25345;&#65292;&#22312;AspectJ&#20013;&#26159;&#27809;&#26377;&#31561;&#20215;&#30340;&#27010;&#24565;&#12290;
			advisor&#23601;&#20687;&#19968;&#20010;&#23567;&#30340;&#33258;&#21253;&#21547;&#30340;&#20999;&#38754;&#65292;&#36825;&#20010;&#20999;&#38754;&#21482;&#26377;&#19968;&#20010;&#36890;&#30693;&#12290;
			&#20999;&#38754;&#33258;&#36523;&#36890;&#36807;&#19968;&#20010;bean&#34920;&#31034;&#65292;&#24182;&#19988;&#24517;&#39035;&#23454;&#29616;&#19968;&#20010;&#36890;&#30693;&#25509;&#21475;&#65292;
			&#22312; <a href="aop-api.html#aop-api-advice-types" title="7.3.2.&nbsp;Spring&#37324;&#30340;&#36890;&#30693;&#31867;&#22411;">Section&nbsp;7.3.2, &#8220;Spring&#37324;&#30340;&#36890;&#30693;&#31867;&#22411;&#8221;</a> &#20013;&#25105;&#20204;&#20250;&#35752;&#35770;&#30456;&#24212;&#30340;&#25509;&#21475;&#12290;Advisors&#21487;&#20197;&#24456;&#22909;&#30340;&#21033;&#29992;AspectJ&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#12290;
			</p><p>
			Spring 2.0 &#36890;&#36807; <tt class="literal">&lt;aop:advisor&gt;</tt> &#20803;&#32032;&#26469;&#25903;&#25345;advisor &#27010;&#24565;&#12290;
			&#20320;&#23558;&#20250;&#21457;&#29616;&#23427;&#22823;&#22810;&#25968;&#24773;&#20917;&#19979;&#20250;&#21644;transactional advice&#19968;&#36215;&#20351;&#29992;&#65292;transactional advice&#22312;Spring 2.0&#20013;&#26377;&#33258;&#24049;&#30340;&#21629;&#21517;&#31354;&#38388;&#12290;&#26684;&#24335;&#22914;&#19979;&#65306;
			</p><pre class="programlisting">&lt;aop:config&gt;

  &lt;aop:pointcut id="businessService"
		expression="execution(* com.xyz.myapp.service.*.*(..))"/&gt;

  &lt;aop:advisor
	  pointcut-ref="businessService"
	  advice-ref="tx-advice"/&gt;

&lt;/aop:config&gt;

&lt;tx:advice id="tx-advice"&gt;
&lt;tx:attributes&gt;
	&lt;tx:method name="*" propagation="REQUIRED"/&gt;
  &lt;/tx:attributes&gt;
&lt;/tx:advice&gt;</pre><p>&#21644;&#22312;&#19978;&#38754;&#20351;&#29992;&#30340; <tt class="literal">pointcut-ref</tt> &#23646;&#24615;&#19968;&#26679;&#65292;&#20320;&#36824;&#21487;&#20197;&#20351;&#29992; <tt class="literal">pointcut</tt> &#23646;&#24615;&#26469;&#23450;&#20041;&#19968;&#20010;&#20869;&#32852;&#30340;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#12290;</p><p>&#20026;&#20102;&#23450;&#20041;&#19968;&#20010;advisord&#30340;&#20248;&#20808;&#32423;&#20197;&#20415;&#35753;&#36890;&#30693;&#21487;&#20197;&#26377;&#24207;&#65292;&#20351;&#29992; <tt class="literal">order</tt> &#23646;&#24615;&#26469;&#23450;&#20041; advisor&#30340;&#20540; <tt class="literal">Ordered</tt> &#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e7844"></a>6.3.7.&nbsp;&#20363;&#23376;</h3></div></div><div></div></div><p>&#35753;&#25105;&#20204;&#26469;&#30475;&#30475;&#22312; <a href="aop.html#aop-ataspectj-example" title="6.2.7.&nbsp;&#20363;&#23376;">Section&nbsp;6.2.7, &#8220;&#20363;&#23376;&#8221;</a> &#25552;&#36807;&#20048;&#35266;&#38145;&#22833;&#36133;&#37325;&#35797;&#30340;&#20363;&#23376;&#65292;&#22914;&#26524;&#20351;&#29992;schema&#23545;&#36825;&#20010;&#20363;&#23376;&#36827;&#34892;&#37325;&#20889;&#26159;&#20160;&#20040;&#25928;&#26524;&#12290;</p><p>
			&#22240;&#20026;&#20048;&#35266;&#38145;&#30340;&#20851;&#31995;&#65292;&#26377;&#26102;&#20505;business services&#21487;&#33021;&#20250;&#22833;&#36133;&#65288;&#26377;&#20154;&#29978;&#33267;&#22312;&#19968;&#24320;&#22987;&#36816;&#34892;&#20107;&#21153;&#30340;&#26102;&#20505;&#23601;&#22833;&#36133;&#20102;&#65289;&#12290;
			&#22914;&#26524;&#37325;&#26032;&#23581;&#35797;&#19968;&#19979;&#65292;&#24456;&#26377;&#21487;&#33021;&#23601;&#20250;&#25104;&#21151;&#12290;&#23545;&#20110;business services&#26469;&#35828;&#65292;&#37325;&#35797;&#20960;&#27425;&#26159;&#24456;&#27491;&#24120;&#30340;&#65288;Idempotent&#25805;&#20316;&#19981;&#38656;&#35201;&#29992;&#25143;&#21442;&#19982;&#65292;&#21542;&#21017;&#20250;&#24471;&#20986;&#30683;&#30462;&#30340;&#32467;&#35770;&#65289;
			&#25105;&#20204;&#21487;&#33021;&#38656;&#35201;&#36879;&#26126;&#30340;&#37325;&#35797;&#25805;&#20316;&#20197;&#36991;&#20813;&#35753;&#23458;&#25143;&#30475;&#35265; <tt class="classname">OptimisticLockingFailureException</tt> &#20363;&#22806;&#34987;&#25243;&#20986;&#12290;
			&#24456;&#26126;&#26174;&#65292;&#22312;&#19968;&#20010;&#27178;&#20999;&#22810;&#23618;&#30340;&#24773;&#20917;&#19979;&#65292;&#36825;&#26159;&#38750;&#24120;&#26377;&#24517;&#35201;&#30340;&#65292;&#22240;&#27492;&#36890;&#36807;&#20999;&#38754;&#26469;&#23454;&#29616;&#26159;&#24456;&#29702;&#24819;&#30340;&#12290;
			</p><p>
			&#22240;&#20026;&#25105;&#20204;&#24819;&#35201;&#37325;&#35797;&#25805;&#20316;&#65292;&#25105;&#20204;&#20250;&#38656;&#35201;&#20351;&#29992;&#21040;&#29615;&#32469;&#36890;&#30693;&#65292;&#36825;&#26679;&#25105;&#20204;&#23601;&#21487;&#20197;&#22810;&#27425;&#35843;&#29992;proceed()&#26041;&#27861;&#12290;
			&#19979;&#38754;&#26159;&#31616;&#21333;&#30340;&#20999;&#38754;&#23454;&#29616;&#65288;&#21482;&#26159;&#19968;&#20010;schema&#25903;&#25345;&#30340;&#26222;&#36890;Java &#31867;&#65289;&#65306;
			</p><pre class="programlisting">public class OptimisticOperationExecutor implements Ordered {

   private static final int DEFAULT_MAX_RETRIES = 2;

   private int maxRetries = DEFAULT_MAX_RETRIES;
   private int order = 1;

   public void setMaxRetries(int maxRetries) {
	  this.maxRetries = maxRetries;
   }

   public int getOrder() {
	  return this.order;
   }

   public void setOrder(int order) {
	  this.order = order;
   }

   public Object doOptimisticOperation(ProceedingJoinPoint pjp) throws Throwable {
	  int numAttempts = 0;
	  OptimisticLockingFailureException lockFailureException;
	  do {
		 numAttempts++;
		 try {
			return pjp.proceed();
		 }
		 catch(OptimisticLockingFailureException ex) {
			lockFailureException = ex;
		 }
	  }
	  while(numAttempts &lt;= this.maxRetries);
	  throw lockFailureException;
   }

}</pre><p>
			&#35831;&#27880;&#24847;&#20999;&#38754;&#23454;&#29616;&#20102; <tt class="interfacename">Ordered</tt> &#25509;&#21475;&#65292;&#36825;&#26679;&#25105;&#20204;&#23601;&#21487;&#20197;&#25226;&#20999;&#38754;&#30340;&#20248;&#20808;&#32423;&#35774;&#23450;&#20026;&#39640;&#20110;&#20107;&#21153;&#36890;&#30693;&#65288;&#25105;&#20204;&#27599;&#27425;&#37325;&#35797;&#30340;&#26102;&#20505;&#37117;&#24819;&#35201;&#22312;&#19968;&#20010;&#20840;&#26032;&#30340;&#20107;&#21153;&#20013;&#36827;&#34892;&#65289;&#12290;
			<tt class="literal">maxRetries</tt> &#21644; <tt class="literal">order</tt> &#23646;&#24615;&#37117;&#21487;&#20197;&#22312;Spring&#20013;&#37197;&#32622;&#12290; 
			&#20027;&#35201;&#30340;&#21160;&#20316;&#22312; <tt class="literal">doOptimisticOperation</tt> &#36825;&#20010;&#29615;&#32469;&#36890;&#30693;&#20013;&#21457;&#29983;&#12290;
			&#35831;&#27880;&#24847;&#36825;&#20010;&#26102;&#20505;&#25105;&#20204;&#25152;&#26377;&#30340; <tt class="literal">businessService()</tt> &#26041;&#27861;&#37117;&#20250;&#20351;&#29992;&#36825;&#20010;&#37325;&#35797;&#31574;&#30053;&#12290;
			&#25105;&#20204;&#39318;&#20808;&#20250;&#23581;&#35797;&#22788;&#29702;&#65292;&#28982;&#21518;&#22914;&#26524;&#25105;&#20204;&#24471;&#21040;&#19968;&#20010; <tt class="classname">OptimisticLockingFailureException</tt> &#24322;&#24120;&#65292;&#25105;&#20204;&#21482;&#38656;&#35201;&#31616;&#21333;&#30340;&#37325;&#35797;&#65292;&#30452;&#21040;&#25105;&#20204;&#32791;&#23613;&#25152;&#26377;&#39044;&#35774;&#30340;&#37325;&#35797;&#27425;&#25968;&#12290;
			</p><i><span class="remark">&#36825;&#20010;&#31867;&#36319;&#25105;&#20204;&#22312;@AspectJ&#30340;&#20363;&#23376;&#20013;&#20351;&#29992;&#30340;&#26159;&#30456;&#21516;&#30340;&#65292;&#21482;&#26159;&#27809;&#26377;&#20351;&#29992;&#27880;&#35299;&#12290;</span></i><p>&#23545;&#24212;&#30340;Spring&#37197;&#32622;&#22914;&#19979;&#65306;</p><pre class="programlisting">&lt;aop:config&gt;

  &lt;aop:aspect id="optimisticOperationRetry" ref="optimisticOperationExecutor"&gt;

	&lt;aop:pointcut id="idempotentOperation"
		expression="execution(* com.xyz.myapp.service.*.*(..))"/&gt;

	&lt;aop:around
	   pointcut-ref="idempotentOperation"
	   method="doOptimisticOperation"/&gt;

  &lt;/aop:aspect&gt;

&lt;/aop:config&gt;

&lt;bean id="optimisticOperationExecutor"
  class="com.xyz.myapp.service.impl.OptimisticOperationExecutor"&gt;
	 &lt;property name="maxRetries" value="3"/&gt;
	 &lt;property name="order" value="100"/&gt;
&lt;/bean&gt;</pre><p>
			&#35831;&#27880;&#24847;&#25105;&#20204;&#29616;&#22312;&#20551;&#35774;&#25152;&#26377;&#30340;bussiness services&#37117;&#26159;idempotent&#12290;&#22914;&#26524;&#19981;&#26159;&#36825;&#26679;&#65292;&#25105;&#20204;&#21487;&#20197;&#25913;&#20889;&#20999;&#38754;&#65292;&#21152;&#19978; <tt class="interfacename">Idempotent</tt> &#27880;&#35299;&#65292;&#35753;&#23427;&#21482;&#35843;&#29992;idempotent&#65306;
			</p><pre class="programlisting">@Retention(RetentionPolicy.RUNTIME)
public @interface Idempotent {
  // marker annotation
}</pre><p>
			&#24182;&#19988;&#23545;service&#25805;&#20316;&#30340;&#23454;&#29616;&#36827;&#34892;&#27880;&#35299;&#12290;&#36825;&#26679;&#22914;&#26524;&#20320;&#21482;&#24076;&#26395;&#25913;&#21464;&#20999;&#38754;&#20351;&#24471;idempotent&#30340;&#25805;&#20316;&#20250;&#23581;&#35797;&#22810;&#27425;&#65292;&#20320;&#21482;&#38656;&#35201;&#25913;&#20889;&#20999;&#20837;&#28857;&#34920;&#36798;&#24335;&#65292;&#36825;&#26679;&#21482;&#26377; <tt class="interfacename">@Idempotent</tt> &#25805;&#20316;&#20250;&#21305;&#37197;&#65306;
			</p><pre class="programlisting">  &lt;aop:pointcut id="idempotentOperation"
		expression="execution(* com.xyz.myapp.service.*.*(..)) and
					@annotation(com.xyz.myapp.service.Idempotent)"/&gt;</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-mixing-styles"></a>6.4.&nbsp;&#28151;&#21512;&#20999;&#38754;&#31867;&#22411;</h2></div></div><div></div></div><p>
		&#25105;&#20204;&#23436;&#20840;&#21487;&#20197;&#28151;&#21512;&#20351;&#29992;&#20197;&#19979;&#20960;&#31181;&#39118;&#26684;&#30340;&#20999;&#38754;&#23450;&#20041;&#65306;&#20351;&#29992;&#33258;&#21160;&#20195;&#29702;&#30340;@AspectJ &#39118;&#26684;&#30340;&#20999;&#38754;&#65292;schema-defined <tt class="literal">&lt;aop:aspect&gt;</tt> &#30340;&#20999;&#38754;&#65292;&#21644;&#29992; <tt class="literal">&lt;aop:advisor&gt;</tt> &#22768;&#26126;&#30340;advisor&#65292;&#29978;&#33267;&#26159;&#20351;&#29992;Spring 1.2&#39118;&#26684;&#30340;&#20195;&#29702;&#21644;&#25318;&#25130;&#22120;&#12290;
		&#30001;&#20110;&#20197;&#19978;&#20960;&#31181;&#39118;&#26684;&#30340;&#20999;&#38754;&#23450;&#20041;&#30340;&#37117;&#20351;&#29992;&#20102;&#30456;&#21516;&#30340;&#24213;&#23618;&#26426;&#21046;&#65292;&#22240;&#27492;&#21487;&#20197;&#24456;&#22909;&#30340;&#20849;&#23384;&#12290;
		</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d0e7911"></a>6.5.&nbsp;&#20195;&#29702;&#26426;&#21046;</h2></div></div><div></div></div><p>Spring AOP&#37096;&#20998;&#20351;&#29992;JDK&#21160;&#24577;&#20195;&#29702;&#25110;&#32773;CGLIB&#26469;&#20026;&#30446;&#26631;&#23545;&#35937;&#21019;&#24314;&#20195;&#29702;&#12290;&#65288;&#24314;&#35758;&#23613;&#37327;&#20351;&#29992;JDK&#30340;&#21160;&#24577;&#20195;&#29702;&#65289;</p><p>
		&#22914;&#26524;&#34987;&#20195;&#29702;&#30340;&#30446;&#26631;&#23545;&#35937;&#23454;&#29616;&#20102;&#33267;&#23569;&#19968;&#20010;&#25509;&#21475;&#65292;&#21017;&#20250;&#20351;&#29992;JDK&#21160;&#24577;&#20195;&#29702;&#12290;&#25152;&#26377;&#35813;&#30446;&#26631;&#31867;&#22411;&#23454;&#29616;&#30340;&#25509;&#21475;&#37117;&#23558;&#34987;&#20195;&#29702;&#12290;&#33509;&#35813;&#30446;&#26631;&#23545;&#35937;&#27809;&#26377;&#23454;&#29616;&#20219;&#20309;&#25509;&#21475;&#65292;&#21017;&#21019;&#24314;&#19968;&#20010;CGLIB&#20195;&#29702;&#12290;
		</p><p>&#22914;&#26524;&#20320;&#24076;&#26395;&#24378;&#21046;&#20351;&#29992;CGLIB&#20195;&#29702;&#65292;&#65288;&#20363;&#22914;&#65306;&#24076;&#26395;&#20195;&#29702;&#30446;&#26631;&#23545;&#35937;&#30340;&#25152;&#26377;&#26041;&#27861;&#65292;&#32780;&#19981;&#21482;&#26159;&#23454;&#29616;&#33258;&#25509;&#21475;&#30340;&#26041;&#27861;&#65289;&#37027;&#20063;&#21487;&#20197;&#12290;&#20294;&#26159;&#38656;&#35201;&#32771;&#34385;&#20197;&#19979;&#38382;&#39064;:</p><div class="itemizedlist"><ul type="disc"><li><p>&#26080;&#27861;&#36890;&#30693;&#65288;advise&#65289;<tt class="literal">Final</tt> &#26041;&#27861;&#65292;&#22240;&#20026;&#20182;&#20204;&#19981;&#33021;&#34987;&#35206;&#20889;&#12290;</p></li><li><p>&#20320;&#38656;&#35201;&#23558;CGLIB 2&#20108;&#36827;&#21046;&#21457;&#34892;&#21253;&#25918;&#22312;classpath&#19979;&#38754;&#65292;&#19982;&#20043;&#30456;&#36739;JDK&#26412;&#36523;&#23601;&#25552;&#20379;&#20102;&#21160;&#24577;&#20195;&#29702;</p></li></ul></div><p>&#24378;&#21046;&#20351;&#29992;CGLIB&#20195;&#29702;&#38656;&#35201;&#23558; <tt class="literal">&lt;aop:config&gt;</tt> &#30340; <tt class="literal">proxy-target-class</tt> &#23646;&#24615;&#35774;&#20026;true:</p><pre class="programlisting">&lt;aop:config <span class="bold"><b>proxy-target-class="true"</b></span>&gt;

	...

&lt;/aop:config&gt;</pre><p>&#35831;&#27880;&#24847;&#36825;&#20010;&#23646;&#24615;&#30340;&#35774;&#32622;&#20165;&#23545; <span class="emphasis"><em>&#27599;&#19968;&#20010;<tt class="literal">&lt;aop-config/&gt;</tt>
			</em></span> &#26377;&#25928;&#65307;
		&#20320;&#21487;&#33021;&#26377;&#22810;&#20010; <tt class="literal">&lt;aop-config/&gt;</tt>&#65292;&#20854;&#20013;&#26377;&#30340;&#24378;&#21046;&#20351;&#29992;CGLIB&#20195;&#29702;&#65292;&#26377;&#30340;&#27809;&#26377;&#12290;
		</p><p>&#24403;&#38656;&#35201;&#20351;&#29992;CGLIB&#20195;&#29702;&#21644;@AspectJ&#33258;&#21160;&#20195;&#29702;&#25903;&#25345;&#65292;&#35831;&#25353;&#29031;&#22914;&#19979;&#30340;&#26041;&#24335;&#35774;&#32622;
		<tt class="literal">&lt;aop:aspectj-autoproxy&gt;</tt> &#30340; <tt class="literal">proxy-target-class</tt> &#23646;&#24615;&#65306;
		</p><pre class="programlisting">&lt;aop:aspectj-autoproxy <span class="bold"><b>proxy-target-class="true"</b></span>/&gt;</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-aspectj-programmatic"></a>6.6.&nbsp;&#32534;&#31243;&#26041;&#24335;&#21019;&#24314;@AspectJ&#20195;&#29702;</h2></div></div><div></div></div><p>
		&#38500;&#20102;&#22312;&#37197;&#32622;&#25991;&#20214;&#20013;&#20351;&#29992; &lt;aop:config&gt; &#25110;&#32773; &lt;aop:aspectj-autoproxy&gt; &#26469;&#22768;&#26126;&#20999;&#38754;&#12290;
		&#21516;&#26679;&#21487;&#20197;&#36890;&#36807;&#32534;&#31243;&#26041;&#24335;&#26469;&#21019;&#24314;&#20195;&#29702;&#36890;&#30693;&#65288;advise&#65289;&#30446;&#26631;&#23545;&#35937;&#12290;&#20851;&#20110;Spring AOP API&#30340;&#35814;&#32454;&#20171;&#32461;&#65292;&#35831;&#21442;&#30475;&#19979;&#19968;&#31456;&#12290;&#36825;&#37324;&#25105;&#20204;&#37325;&#28857;&#20171;&#32461;&#33258;&#21160;&#21019;&#24314;&#20195;&#29702;&#12290;
		</p><p>
		&#31867; <tt class="classname">org.springframework.aop.aspectj.annotation.AspectJProxyFactory</tt>
		&#21487;&#20197;&#20026;@AspectJ&#20999;&#38754;&#30340;&#30446;&#26631;&#23545;&#35937;&#21019;&#24314;&#19968;&#20010;&#20195;&#29702;&#12290;&#35813;&#31867;&#30340;&#22522;&#26412;&#29992;&#27861;&#38750;&#24120;&#31616;&#21333;&#65292;&#31034;&#20363;&#22914;&#19979;&#12290;&#35831;&#21442;&#30475;Javadoc&#33719;&#21462;&#26356;&#35814;&#32454;&#30340;&#20449;&#24687;&#12290;
		</p><pre class="programlisting">// create a factory that can generate a proxy for the given target object
AspectJProxyFactory factory = new AspectJProxyFactory(targetObject);

// add an aspect, the class must be an @AspectJ aspect
// you can call this as many times as you need with different aspects
factory.addAspect(SecurityManager.class);

// you can also add existing aspect instances, the type of the object
// supplied must be an @AspectJ aspect
factory.addAspect(usageTracker);

// now get the proxy object...
MyInterfaceType proxy = factory.getProxy();</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-using-aspectj"></a>6.7.&nbsp;&#22312;Spring&#24212;&#29992;&#20013;&#20351;&#29992;AspectJ</h2></div></div><div></div></div><p>
		&#21040;&#30446;&#21069;&#20026;&#27490;&#26412;&#31456;&#35752;&#35770;&#30340;&#19968;&#30452;&#26159;&#32431;Spring AOP&#12290;
		&#22312;&#36825;&#19968;&#33410;&#37324;&#38754;&#25105;&#20204;&#23558;&#20171;&#32461;&#22914;&#20309;&#20351;&#29992;AspectJ compiler/weaver&#26469;&#20195;&#26367;Spring AOP&#25110;&#32773;&#20316;&#20026;&#23427;&#30340;&#34917;&#20805;&#65292;&#22240;&#20026;&#26377;&#20123;&#26102;&#20505;Spring AOP&#21333;&#29420;&#25552;&#20379;&#30340;&#21151;&#33021;&#20063;&#35768;&#24182;&#19981;&#33021;&#28385;&#36275;&#20320;&#30340;&#38656;&#35201;&#12290;
		</p><p>
		Spring&#25552;&#20379;&#20102;&#19968;&#20010;&#23567;&#24039;&#30340;AspectJ aspect library
		&#65288;&#20320;&#21487;&#20197;&#22312;&#31243;&#24207;&#21457;&#34892;&#29256;&#26412;&#20013;&#21333;&#29420;&#20351;&#29992; <tt class="literal">spring-aspects.jar</tt> &#25991;&#20214;&#65292;&#24182;&#23558;&#20854;&#21152;&#20837;&#21040;classpath&#19979;&#20197;&#20351;&#29992;&#20854;&#20013;&#30340;&#20999;&#38754;&#65289;&#12290;
		<a href="aop.html#aop-atconfigurable" title="6.7.1.&nbsp;&#22312;Spring&#20013;&#20351;&#29992;AspectJ&#26469;&#20026;domain object&#36827;&#34892;&#20381;&#36182;&#27880;&#20837;">Section&nbsp;6.7.1, &#8220;&#22312;Spring&#20013;&#20351;&#29992;AspectJ&#26469;&#20026;domain object&#36827;&#34892;&#20381;&#36182;&#27880;&#20837;&#8221;</a> &#21644; <a href="aop.html#aop-ajlib-other" title="6.7.2.&nbsp;Spring&#20013;&#20854;&#20182;&#30340;AspectJ&#20999;&#38754;">Section&nbsp;6.7.2, &#8220;Spring&#20013;&#20854;&#20182;&#30340;AspectJ&#20999;&#38754;&#8221;</a> &#35752;&#35770;&#20102;&#35813;&#24211;&#21644;&#22914;&#20309;&#20351;&#29992;&#35813;&#24211;&#12290;
		<a href="aop.html#aop-aj-configure" title="6.7.3.&nbsp;&#20351;&#29992;Spring IoC&#26469;&#37197;&#32622;AspectJ&#30340;&#20999;&#38754;">Section&nbsp;6.7.3, &#8220;&#20351;&#29992;Spring IoC&#26469;&#37197;&#32622;AspectJ&#30340;&#20999;&#38754;&#8221;</a> &#35752;&#35770;&#20102;&#22914;&#20309;&#23545;&#36890;&#36807;AspectJ compiler&#32455;&#20837;&#30340;AspectJ&#20999;&#38754;&#36827;&#34892;&#20381;&#36182;&#27880;&#20837;&#12290;
		&#26368;&#21518;<a href="aop.html#aop-aj-ltw" title="6.7.4.&nbsp;&#22312;Spring&#24212;&#29992;&#20013;&#20351;&#29992;AspectJ Load-time weaving&#65288;LTW&#65289;">Section&nbsp;6.7.4, &#8220;&#22312;Spring&#24212;&#29992;&#20013;&#20351;&#29992;AspectJ Load-time weaving&#65288;LTW&#65289;&#8221;</a>&#20171;&#32461;&#20102;&#20351;&#29992;AspectJ&#30340;Spring&#24212;&#29992;&#31243;&#24207;&#22914;&#20309;&#35013;&#36733;&#26399;&#32455;&#20837;&#65288;load-time weaving&#65289;&#12290;
		</p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-atconfigurable"></a>6.7.1.&nbsp;&#22312;Spring&#20013;&#20351;&#29992;AspectJ&#26469;&#20026;domain object&#36827;&#34892;&#20381;&#36182;&#27880;&#20837;</h3></div></div><div></div></div><p>
			Spring&#23481;&#22120;&#23545;application context&#20013;&#23450;&#20041;&#30340;bean&#36827;&#34892;&#23454;&#20363;&#21270;&#21644;&#37197;&#32622;&#12290;
			&#21516;&#26679;&#20063;&#21487;&#20197;&#36890;&#36807;bean factory&#26469;&#20026;&#19968;&#20010;&#24050;&#32463;&#23384;&#22312;&#19988;&#24050;&#32463;&#23450;&#20041;&#20026;spring bean&#30340;&#23545;&#35937;&#24212;&#29992;&#25152;&#21253;&#21547;&#30340;&#37197;&#32622;&#20449;&#24687;&#12290;
			spring-aspects.jar&#20013;&#21253;&#21547;&#20102;&#19968;&#20010;annotation-driven&#30340;&#20999;&#38754;&#65292;&#25552;&#20379;&#20102;&#33021;&#20026;&#20219;&#20309;&#23545;&#35937;&#36827;&#34892;&#20381;&#36182;&#27880;&#20837;&#30340;&#33021;&#21147;&#12290;
			&#36825;&#26679;&#30340;&#25903;&#25345;&#26088;&#22312;&#20026; <span class="emphasis"><em>&#33073;&#31163;&#23481;&#22120;&#31649;&#29702;</em></span> &#21019;&#24314;&#30340;&#23545;&#35937;&#36827;&#34892;&#20381;&#36182;&#27880;&#20837;&#12290;
			Domain object&#32463;&#24120;&#22788;&#20110;&#36825;&#26679;&#30340;&#24773;&#24418;&#65306;&#23427;&#20204;&#21487;&#33021;&#26159;&#36890;&#36807; <tt class="literal">new</tt> &#25805;&#20316;&#31526;&#21019;&#24314;&#30340;&#23545;&#35937;&#65292;
			&#20063;&#21487;&#33021;&#26159;ORM&#24037;&#20855;&#26597;&#35810;&#25968;&#25454;&#24211;&#30340;&#36820;&#22238;&#32467;&#26524;&#23545;&#35937;&#12290;
		</p><p> 
			&#21253; <tt class="literal">org.springframework.orm.hibernate.support</tt> &#20013;&#30340;&#31867; <tt class="classname">DependencyInjectionInterceptorFactoryBean</tt>
			&#21487;&#20197;&#35753;Spring&#20026;Hibernate&#21019;&#24314;&#24182;&#19988;&#37197;&#32622;prototype&#31867;&#22411;&#30340;domain object&#65288;&#20351;&#29992;&#33258;&#21160;&#35013;&#37197;&#25110;&#32773;&#30830;&#20999;&#21629;&#21517;&#30340;bean&#21407;&#22411;&#23450;&#20041;&#65289;&#12290;
			&#24403;&#28982;&#65292;&#25318;&#25130;&#22120;&#19981;&#25903;&#25345;&#37197;&#32622;&#20320;&#32534;&#31243;&#26041;&#24335;&#21019;&#24314;&#30340;&#23545;&#35937;&#32780;&#38750;&#26816;&#32034;&#25968;&#25454;&#24211;&#36820;&#22238;&#30340;&#23545;&#35937;&#12290;
			&#20854;&#20182;framework&#20063;&#20250;&#25552;&#20379;&#31867;&#20284;&#30340;&#25216;&#26415;&#12290;&#20173;&#26159;&#37027;&#21477;&#35805;&#65292;Be Pragramatic&#36873;&#25321;&#33021;&#28385;&#36275;&#20320;&#38656;&#27714;&#30340;&#26041;&#27861;&#20013;&#26368;&#31616;&#21333;&#30340;&#37027;&#20010;&#12290;
			&#35831;&#27880;&#24847;&#21069;&#38754;&#25552;&#21450;&#30340;&#31867; <span class="bold"><b>&#27809;&#26377;</b></span> &#38543;Spring&#21457;&#34892;&#21253;&#19968;&#36215;&#21457;&#24067;&#12290;
			&#22914;&#26524;&#20320;&#24076;&#26395;&#20351;&#29992;&#35813;&#31867;&#65292;&#38656;&#35201;&#20174;Spring CVS Respository&#19978;&#19979;&#36733;&#24182;&#19988;&#33258;&#34892;&#32534;&#35793;&#12290;
			&#20320;&#21487;&#20197;&#22312;Spring CVS respository&#19979;&#30340; <tt class="literal">'sandbox'</tt> &#30446;&#24405;&#19979;&#25214;&#21040;&#35813;&#25991;&#20214;&#12290;
			</p><p>
				<tt class="interfacename">@Configurable</tt> &#27880;&#35299;&#26631;&#35760;&#20102;&#19968;&#20010;&#31867;&#21487;&#20197;&#36890;&#36807;Spring-driven&#26041;&#24335;&#26469;&#37197;&#32622;&#12290;
			&#22312;&#26368;&#31616;&#21333;&#30340;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#21482;&#25226;&#23427;&#24403;&#20316;&#26631;&#35760;&#27880;&#35299;&#65306;
			</p><pre class="programlisting">package com.xyz.myapp.domain;
import org.springframework.beans.factory.annotation;

@Configurable
public class Account {
   ...
</pre><p>
			&#24403;&#21482;&#26159;&#31616;&#21333;&#22320;&#20316;&#20026;&#19968;&#20010;&#26631;&#35760;&#25509;&#21475;&#26469;&#20351;&#29992;&#30340;&#26102;&#20505;&#65292;Spring&#23558;&#37319;&#29992;&#21644;&#35813;&#24050;&#27880;&#35299;&#30340;&#31867;&#22411;&#65288;&#27604;&#22914;Account&#31867;&#65289;&#20840;&#21517;
			&#65288;<tt class="classname">com.xyz.myapp.domain.Account</tt>&#65289;&#19968;&#33268;&#30340;bean&#21407;&#22411;&#23450;&#20041;&#26469;&#37197;&#32622;&#19968;&#20010;&#26032;&#23454;&#20363;&#12290;
			&#30001;&#20110;&#19968;&#20010;bean&#40664;&#35748;&#30340;&#21517;&#23383;&#23601;&#26159;&#23427;&#30340;&#20840;&#21517;&#65292;&#25152;&#20197;&#19968;&#20010;&#27604;&#36739;&#26041;&#20415;&#30340;&#21150;&#27861;&#23601;&#26159;&#30465;&#30053;&#23450;&#20041;&#20013;&#30340;id&#23646;&#24615;&#65306;
			</p><pre class="programlisting">&lt;bean class="com.xyz.myapp.domain.Account"
	  singleton="false"&gt;
  &lt;property name="fundsTransferService" ref="fundsTransferService"/&gt;
  ...
&lt;/bean&gt;</pre><p>&#22914;&#26524;&#20320;&#24076;&#26395;&#26126;&#30830;&#30340;&#25351;&#23450;bean&#21407;&#22411;&#23450;&#20041;&#30340;&#21517;&#23383;&#65292;&#20320;&#21487;&#20197;&#22312;&#27880;&#35299;&#20013;&#30452;&#25509;&#23450;&#20041;&#65306;</p><pre class="programlisting">package com.xyz.myapp.domain;
import org.springframework.beans.factory.annotation;

@Configurable("account")
public class Account {
   ...
</pre><p>Spring&#20250;&#26597;&#25214;&#21517;&#23383;&#20026;"account"&#30340;bean&#23450;&#20041;&#65292;&#24182;&#20351;&#29992;&#23427;&#20316;&#20026;&#21407;&#22411;&#23450;&#20041;&#26469;&#37197;&#32622;&#19968;&#20010;&#26032;&#30340;Account&#23545;&#35937;&#12290;</p><p>
			&#20320;&#20063;&#21487;&#20197;&#20351;&#29992;&#33258;&#21160;&#35013;&#37197;&#26469;&#36991;&#20813;&#25163;&#24037;&#25351;&#23450;&#21407;&#22411;&#23450;&#20041;&#30340;&#21517;&#23383;&#12290;
			&#21482;&#35201;&#35774;&#32622; <tt class="interfacename">@Configurable</tt> &#27880;&#35299;&#20013;&#30340;autowire&#23646;&#24615;&#23601;&#21487;&#20197;&#35753;Spring&#26469;&#33258;&#21160;&#35013;&#37197;&#20102;&#65306;
			<tt class="literal">@Configurable(autowire=Autowire.BY_TYPE)</tt> &#25110;&#32773; <tt class="literal">@Configurable(autowire=Autowire.BY_NAME</tt>&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#25353;&#31867;&#22411;&#25110;&#32773;&#25353;&#21517;&#23383;&#33258;&#21160;&#35013;&#37197;&#20102;&#12290;
		</p><p>
			&#26368;&#21518;&#65292;&#20320;&#21487;&#20197;&#35774;&#32622; <tt class="literal">dependencyCheck</tt> &#23646;&#24615;&#65292;&#36890;&#36807;&#35774;&#32622;&#65292;Spring&#23545;&#26032;&#21019;&#24314;&#21644;&#37197;&#32622;&#30340;&#23545;&#35937;&#30340;&#23545;&#35937;&#24341;&#29992;&#36827;&#34892;&#26657;&#39564;
			&#65288;&#20363;&#22914;&#65306;<tt class="literal">@Configurable(autowire=Autowire.BY_NAME,dependencyCheck=true)</tt> &#65289;&#12290;
			&#22914;&#26524;&#36825;&#20010;&#23646;&#24615;&#34987;&#35774;&#20026;true&#65292;Spring&#20250;&#22312;&#37197;&#32622;&#32467;&#26463;&#21518;&#26657;&#39564;&#38500;&#20102;primitives&#21644;collections&#31867;&#22411;&#30340;&#25152;&#26377;&#30340;&#23646;&#24615;&#26159;&#21542;&#37117;&#34987;&#36171;&#20540;&#20102;&#12290;
			</p><p>
			&#20165;&#20165;&#20351;&#29992;&#27880;&#35299;&#24182;&#27809;&#26377;&#20570;&#20219;&#20309;&#20107;&#24773;&#12290;&#20294;&#24403;&#27880;&#35299;&#23384;&#22312;&#26102;&#65292;spring-aspects.jar&#20013;&#30340; <tt class="literal">AnnotationBeanConfigurerAspect</tt> &#23601;&#36215;&#20316;&#29992;&#20102;&#12290;
			&#23454;&#36136;&#19978;&#20999;&#38754;&#20570;&#20102;&#36825;&#20123;&#65306;&#24403;&#21021;&#22987;&#21270;&#19968;&#20010;&#26377; <tt class="interfacename">@Configurable</tt> &#27880;&#35299;&#30340;&#26032;&#23545;&#35937;&#26102;&#65292;Spring&#25353;&#29031;&#27880;&#35299;&#20013;&#30340;&#23646;&#24615;&#26469;&#37197;&#32622;&#36825;&#20010;&#26032;&#21019;&#24314;&#30340;&#23545;&#35937;&#12290;
			&#35201;&#23454;&#29616;&#19978;&#36848;&#30340;&#25805;&#20316;&#65292;&#24050;&#27880;&#35299;&#30340;&#31867;&#22411;&#24517;&#39035;&#30001;AspectJ weaver&#26469;&#32455;&#20837; - &#20320;&#21487;&#20197;&#20351;&#29992;&#19968;&#20010; build-time ant/maven&#20219;&#21153;&#26469;&#23436;&#25104;
			&#65288;&#21442;&#35265;<a href="http://www.eclipse.org/aspectj/doc/released/devguide/antTasks.html" target="_top">AspectJ Development Environment Guide</a>&#65289;
			&#25110;&#32773;&#20351;&#29992;load-time weaving&#65288;&#21442;&#35265; <a href="aop.html#aop-aj-ltw" title="6.7.4.&nbsp;&#22312;Spring&#24212;&#29992;&#20013;&#20351;&#29992;AspectJ Load-time weaving&#65288;LTW&#65289;">Section&nbsp;6.7.4, &#8220;&#22312;Spring&#24212;&#29992;&#20013;&#20351;&#29992;AspectJ Load-time weaving&#65288;LTW&#65289;&#8221;</a>&#65289;&#12290;
			</p><p>
			&#31867; <tt class="classname">AnnotationBeanConfigurerAspect</tt> &#26412;&#36523;&#20063;&#38656;&#35201;Spring&#26469;&#37197;&#32622;&#65288;&#33719;&#24471;bean factory&#30340;&#24341;&#29992;&#65292;&#20351;&#29992;bean factory&#37197;&#32622;&#26032;&#30340;&#23545;&#35937;&#65289;&#12290;
			&#20026;&#27492;Spring AOP&#21629;&#21517;&#31354;&#38388;&#23450;&#20041;&#20102;&#19968;&#20010;&#38750;&#24120;&#26041;&#20415;&#30340;&#26631;&#31614;&#12290;&#22914;&#19979;&#25152;&#31034;&#65292;&#21487;&#20197;&#24456;&#31616;&#21333;&#30340;&#22312;application context&#37197;&#32622;&#25991;&#20214;&#21253;&#21547;&#36825;&#20010;&#26631;&#31614;&#20013;&#12290;</p><pre class="programlisting">&lt;aop:spring-configured/&gt;</pre><p>&#22914;&#26524;&#20320;&#20351;&#29992;DTD&#20195;&#26367;Schema&#65292;&#23545;&#24212;&#30340;&#23450;&#20041;&#22914;&#19979;&#65306;</p><pre class="programlisting">&lt;bean
  class="org.springframework.beans.factory.aspectj.AnnotationBeanConfigurerAspect"
  factory-method="aspectOf"/&gt;</pre><p>
			&#22312;&#20999;&#38754;&#37197;&#32622;&#23436;&#25104; <span class="emphasis"><em>&#20043;&#21069;</em></span> &#21019;&#24314;&#30340;@Configurable&#23545;&#35937;&#23454;&#20363;&#20250;&#23548;&#33268;&#22312;log&#20013;&#30041;&#19979;&#19968;&#20010;warning&#65292;&#24182;&#19988;&#20219;&#20309;&#23545;&#20110;&#35813;&#23545;&#35937;&#30340;&#37197;&#32622;&#37117;&#19981;&#20250;&#29983;&#25928;&#12290;
			&#20030;&#19968;&#20010;&#20363;&#23376;&#65292;&#19968;&#20010;Spring&#31649;&#29702;&#37197;&#32622;&#30340;bean&#22312;&#34987;Spring&#21021;&#22987;&#21270;&#30340;&#26102;&#20505;&#21019;&#24314;&#20102;&#19968;&#20010;domain object&#12290;
			&#23545;&#20110;&#36825;&#26679;&#30340;&#24773;&#20917;&#65292;&#20320;&#38656;&#35201;&#23450;&#20041;bean&#23646;&#24615;&#20013;&#30340;"depends-on"&#23646;&#24615;&#26469;&#25163;&#21160;&#25351;&#23450;&#35813;bean&#20381;&#36182;&#20110;configuration&#20999;&#38754;&#12290;
			</p><pre class="programlisting">&lt;bean id="myService"
  class="com.xzy.myapp.service.MyService"
  depends-on="org.springframework.beans.factory.aspectj.AnnotationBeanConfigurerAspect"&gt;
  ...
&lt;/bean&gt;</pre><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8094"></a>6.7.1.1.&nbsp;
					<tt class="interfacename">@Configurable</tt> object&#30340;&#21333;&#20803;&#27979;&#35797;</h4></div></div><div></div></div><p>
				&#25552;&#20379; <tt class="interfacename">@Configurable</tt> &#25903;&#25345;&#30340;&#19968;&#20010;&#30446;&#30340;&#23601;&#26159;&#20351;&#24471;domain object&#30340;&#21333;&#20803;&#27979;&#35797;&#21487;&#20197;&#29420;&#31435;&#36827;&#34892;&#65292;&#19981;&#38656;&#35201;&#36890;&#36807;&#30828;&#32534;&#30721;&#26597;&#25214;&#21508;&#31181;&#20506;&#36182;&#20851;&#31995;&#12290;
				&#22914;&#26524; <tt class="interfacename">@Configurable</tt> &#31867;&#22411;&#27809;&#26377;&#36890;&#36807;AspectJ&#32455;&#20837;&#65292;
				&#21017;&#22312;&#21333;&#20803;&#27979;&#35797;&#36807;&#31243;&#20013;&#27880;&#35299;&#19981;&#20250;&#36215;&#21040;&#20219;&#20309;&#20316;&#29992;&#65292;&#27979;&#35797;&#20013;&#20320;&#21487;&#20197;&#31616;&#21333;&#30340;&#20026;&#23545;&#35937;&#30340;mock&#25110;&#32773;stub&#23646;&#24615;&#36171;&#20540;&#65292;&#24182;&#19988;&#21644;&#27491;&#24120;&#24773;&#20917;&#19968;&#26679;&#30340;&#21435;&#20351;&#29992;&#35813;&#23545;&#35937;&#12290;
				&#22914;&#26524; <tt class="interfacename">@Configurable</tt> &#31867;&#22411;&#36890;&#36807;AspectJ&#32455;&#20837;&#65292;
				&#25105;&#20204;&#20381;&#28982;&#21487;&#20197;&#33073;&#31163;&#23481;&#22120;&#36827;&#34892;&#21333;&#20803;&#27979;&#35797;&#65292;&#19981;&#36807;&#27599;&#27425;&#21019;&#24314;&#19968;&#20010;&#26032;&#30340; <tt class="interfacename">@Configurable</tt> &#23545;&#35937;&#26102;&#37117;&#20250;&#30475;&#21040;&#19968;&#20010;warning&#26631;&#31034;&#35813;&#23545;&#35937;&#19981;&#21463;Spring&#31649;&#29702;&#37197;&#32622;&#12290;
		  </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="d0e8114"></a>6.7.1.2.&nbsp;&#22810;application context&#24773;&#20917;&#19979;&#30340;&#22788;&#29702;</h4></div></div><div></div></div><p>
					<tt class="literal">AnnotationBeanConfigurerAspect</tt> &#36890;&#36807;&#19968;&#20010;AspectJ singleton&#20999;&#38754;&#26469;&#23454;&#29616;&#23545; <tt class="interfacename">@Configurable</tt> &#30340;&#25903;&#25345;&#12290;
				&#19968;&#20010;singleton&#20999;&#38754;&#30340;&#20316;&#29992;&#22495;&#21644;&#19968;&#20010;&#38745;&#24577;&#21464;&#37327;&#30340;&#20316;&#29992;&#22495;&#26159;&#19968;&#26679;&#30340;&#65292;&#20363;&#22914;&#65292;&#23545;&#20110;&#27599;&#19968;&#20010;classloader&#26377;&#19968;&#20010;&#20999;&#38754;&#26469;&#23450;&#20041;&#31867;&#22411;&#12290;
				&#36825;&#23601;&#24847;&#21619;&#30528;&#22914;&#26524;&#20320;&#22312;&#19968;&#20010;classloader&#23618;&#27425;&#32467;&#26500;&#20013;&#23450;&#20041;&#20102;&#22810;&#20010;application context&#30340;&#26102;&#20505;&#23601;&#38656;&#35201;&#32771;&#34385;&#22312;&#21738;&#37324;&#23450;&#20041; 
				<tt class="literal">&lt;aop:spring-configured/&gt;</tt> bean&#21644;&#22312;&#21738;&#20010;classpath&#19979;&#25918;&#32622;Srping-aspects.jar&#12290;
				</p><p>
				&#32771;&#34385;&#19968;&#19979;&#20856;&#22411;&#30340;Spring web&#39033;&#30446;&#65292;&#19968;&#33324;&#37117;&#26159;&#30001;&#19968;&#20010;&#29238;application context&#23450;&#20041;&#22823;&#37096;&#20998;business service&#21644;&#25152;&#38656;&#35201;&#30340;&#20854;&#20182;&#36164;&#28304;&#65292;&#28982;&#21518;&#27599;&#19968;&#20010;servlet&#25317;&#26377;&#19968;&#20010;&#23376;application context&#23450;&#20041;&#12290;
				&#25152;&#26377;&#36825;&#20123;context&#20849;&#23384;&#20110;&#21516;&#19968;&#20010;classloader hierarchy&#19979;&#65292;&#22240;&#27492;&#23545;&#20110;&#20840;&#20307;context&#65292;<tt class="literal">AnnotationBeanConfigurerAspect</tt> &#20165;&#21487;&#20197;&#32500;&#25252;&#19968;&#20010;&#24341;&#29992;&#12290;
				&#22312;&#36825;&#26679;&#30340;&#24773;&#20917;&#19979;&#65292;&#25105;&#20204;&#25512;&#33616;&#22312;&#29238;application context&#20013;&#23450;&#20041; <tt class="literal">&lt;aop:spring-configured/&gt;</tt> bean&#65306;
				&#36825;&#37324;&#25152;&#23450;&#20041;&#30340;service&#21487;&#33021;&#26159;&#20320;&#24076;&#26395;&#27880;&#20837;domain object&#30340;&#12290;
				&#36825;&#26679;&#20570;&#30340;&#32467;&#26524;&#26159;&#20320;&#19981;&#33021;&#20026;&#23376;application context&#20013;&#20351;&#29992;@Configurable&#30340;domain object&#37197;&#32622;bean&#24341;&#29992;&#65288;&#21487;&#33021;&#20320;&#20063;&#26681;&#26412;&#23601;&#19981;&#24076;&#26395;&#37027;&#20040;&#20570;&#65281;&#65289;&#12290;
				</p><p> 
				&#24403;&#22312;&#19968;&#20010;&#23481;&#22120;&#20013;&#37096;&#32626;&#22810;&#20010;web-app&#30340;&#26102;&#20505;&#65292;&#35831;&#30830;&#20445;&#27599;&#19968;&#20010;web-application&#20351;&#29992;&#33258;&#24049;&#30340;classloader&#26469;&#21152;&#36733;spring-aspects.jar&#20013;&#30340;&#31867;&#65288;&#20363;&#22914;&#23558;spring-aspects.jar&#25918;&#22312;WEB-INF/lib&#30446;&#24405;&#19979;&#65289;&#12290;
				&#22914;&#26524;spring-aspects.jar&#34987;&#25918;&#22312;&#20102;&#23481;&#22120;&#30340;classpath&#19979;&#65288;&#22240;&#27492;&#20063;&#34987;&#29238;classloader&#21152;&#36733;&#65289;&#65292;&#21017;&#25152;&#26377;&#30340;web application&#23558;&#20849;&#20139;&#19968;&#20010;aspect&#23454;&#20363;&#65292;&#36825;&#21487;&#33021;&#24182;&#19981;&#26159;&#20320;&#25152;&#24819;&#35201;&#30340;&#12290;
				</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-ajlib-other"></a>6.7.2.&nbsp;Spring&#20013;&#20854;&#20182;&#30340;AspectJ&#20999;&#38754;</h3></div></div><div></div></div><p>
			&#38500;&#20102; <tt class="interfacename">@Configurable</tt> &#25903;&#25345;&#65292;spring-aspects.jar&#21253;&#21547;&#20102;&#19968;&#20010;AspectJ&#20999;&#38754;&#21487;&#20197;&#29992;&#26469;&#20026;&#37027;&#20123;&#20351;&#29992;&#20102;
			@Transactional annotation &#30340;&#31867;&#22411;&#21644;&#26041;&#27861;&#39537;&#21160;Spring&#20107;&#21153;&#31649;&#29702;&#65288;&#21442;&#35265; <a href="transaction.html" title="Chapter&nbsp;9.&nbsp;&#20107;&#21153;&#31649;&#29702;">Chapter&nbsp;9, <i>&#20107;&#21153;&#31649;&#29702;</i></a>&#65289;&#12290;
			&#25552;&#20379;&#36825;&#20010;&#30340;&#20027;&#35201;&#30446;&#30340;&#26159;&#26377;&#20123;&#29992;&#25143;&#24076;&#26395;&#33073;&#31163;Spring&#23481;&#22120;&#20351;&#29992;Spring&#30340;&#20107;&#21153;&#31649;&#29702;&#12290;
			</p><p>
			&#23545;&#20110;AspectJ&#31243;&#24207;&#21592;&#65292;&#24076;&#26395;&#20351;&#29992;Spring&#31649;&#29702;&#37197;&#32622;&#21644;&#20107;&#21153;&#31649;&#29702;&#25903;&#25345;&#65292;&#19981;&#36807;&#20182;&#20204;&#19981;&#24819;&#65288;&#25110;&#32773;&#19981;&#33021;&#65289;&#20351;&#29992;&#27880;&#35299;&#65292;spring-aspects.jar&#20063;&#21253;&#21547;&#20102;&#19968;&#20123;&#25277;&#35937;&#20999;&#38754;&#20379;&#20320;&#32487;&#25215;&#26469;&#25552;&#20379;&#20320;&#33258;&#24049;&#30340;&#20999;&#20837;&#28857;&#23450;&#20041;&#12290;
			&#21442;&#35265; <tt class="literal">AbstractBeanConfigurerAspect</tt> &#21644; <tt class="literal">AbstractTransactionAspect</tt> &#30340;Javadoc&#33719;&#21462;&#26356;&#22810;&#20449;&#24687;&#12290;
			&#20316;&#20026;&#19968;&#20010;&#20363;&#23376;&#65292;&#19979;&#38754;&#30340;&#20195;&#30721;&#29255;&#26029;&#23637;&#31034;&#20102;&#22914;&#20309;&#32534;&#20889;&#19968;&#20010;&#20999;&#38754;&#65292;&#28982;&#21518;&#36890;&#36807;bean&#21407;&#22411;&#23450;&#20041;&#20013;&#21644;&#31867;&#20840;&#21517;&#21305;&#37197;&#30340;&#26469;&#37197;&#32622;domian object&#20013;&#25152;&#26377;&#30340;&#23454;&#20363;&#65306;
			</p><pre class="programlisting">public aspect DomainObjectConfiguration extends AbstractBeanConfigurerAspect {

  public DomainObjectConfiguration() {
	setBeanWiringInfoResolver(new ClassNameBeanWiringInfoResolver());
  }

  /**
   * The creation of a new bean (any object in the domain model)
   */
  protected pointcut beanCreation(Object beanInstance) :
	initialization(new(..)) &amp;&amp;
	SystemArchitecture.inDomainModel() &amp;&amp;
	this(beanInstance);

}</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-aj-configure"></a>6.7.3.&nbsp;&#20351;&#29992;Spring IoC&#26469;&#37197;&#32622;AspectJ&#30340;&#20999;&#38754;</h3></div></div><div></div></div><p>
			&#24403;&#22312;Spring application&#20013;&#20351;&#29992;AspectJ&#30340;&#26102;&#20505;&#65292;&#24456;&#33258;&#28982;&#30340;&#20250;&#24819;&#21040;&#29992;Spring&#26469;&#31649;&#29702;&#36825;&#20123;&#20999;&#38754;&#12290;
			AspectJ runtime&#33258;&#36523;&#36127;&#36131;&#20999;&#38754;&#30340;&#21019;&#24314;&#65292;&#36825;&#24847;&#21619;&#30528;&#36890;&#36807;Spring&#26469;&#31649;&#29702;AspectJ
			&#21019;&#24314;&#20999;&#38754;&#20381;&#36182;&#20110;&#20999;&#38754;&#25152;&#20351;&#29992;&#30340;AspectJ instantiation model(per-clause)&#12290;
			</p><p>
			&#22823;&#22810;&#25968;AspectJ&#20999;&#38754;&#37117;&#26159; <span class="emphasis"><em>singleton</em></span> &#20999;&#38754;&#12290;
			&#31649;&#29702;&#36825;&#20123;&#20999;&#38754;&#38750;&#24120;&#23481;&#26131;&#65292;&#21644;&#36890;&#24120;&#19968;&#26679;&#21019;&#24314;&#19968;&#20010;bean&#23450;&#20041;&#24341;&#29992;&#35813;&#20999;&#38754;&#31867;&#22411;&#23601;&#21487;&#20197;&#20102;&#65292;&#24182;&#19988;&#22312;bean&#23450;&#20041;&#20013;&#21253;&#21547; <tt class="literal">factory-method="aspectOf"</tt> &#36825;&#20010;&#23646;&#24615;&#12290;
			&#36825;&#30830;&#20445;Spring&#20174;AspectJ&#33719;&#21462;&#20999;&#38754;&#23454;&#20363;&#32780;&#19981;&#26159;&#23581;&#35797;&#33258;&#24049;&#21435;&#21019;&#24314;&#35813;&#23454;&#20363;&#12290;&#31034;&#20363;&#22914;&#19979;&#65306;
			</p><pre class="programlisting">&lt;bean id="profiler" class="com.xyz.profiler.Profiler"
	  factory-method="aspectOf"&gt;
  &lt;property name="profilingStrategy" ref="jamonProfilingStrategy"/&gt;
&lt;/bean&gt;</pre><p>
	   		&#23545;&#20110;non-singleton&#30340;&#20999;&#38754;&#65292;&#26368;&#31616;&#21333;&#30340;&#37197;&#32622;&#31649;&#29702;&#26041;&#27861;&#26159;&#23450;&#20041;&#19968;&#20010;bean&#21407;&#22411;&#23450;&#20041;&#24182;&#19988;&#20351;&#29992;@Configurable&#25903;&#25345;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#22312;&#20999;&#38754;&#34987;AspectJ runtime&#21019;&#24314;&#21518;&#31649;&#29702;&#23427;&#20204;&#12290;
	   		</p><p>
	   		&#22914;&#26524;&#20320;&#24076;&#26395;&#19968;&#20123;@AspectJ&#20999;&#38754;&#20351;&#29992;AspectJ&#26469;&#32455;&#20837;&#65288;&#20363;&#22914;&#20351;&#29992;load-time&#32455;&#20837;domain object&#65289;
			&#21644;&#21478;&#19968;&#20123;@AspectJ&#20999;&#38754;&#20351;&#29992;Spring AOP&#65292;&#32780;&#36825;&#20123;&#20999;&#38754;&#37117;&#26159;&#30001;Spring&#26469;&#31649;&#29702;&#30340;&#65292;&#37027;&#20320;&#23601;&#38656;&#35201;&#21578;&#35785;Spring AOP @AspectJ&#33258;&#21160;&#20195;&#29702;&#25903;&#25345;&#37027;&#20123;&#20999;&#38754;&#38656;&#35201;&#34987;&#33258;&#21160;&#20195;&#29702;&#12290;
			&#20320;&#21487;&#20197;&#36890;&#36807;&#22312; <tt class="literal">&lt;aop:aspectj-autoproxy&gt;</tt> &#22768;&#26126;&#20013;&#20351;&#29992;&#19968;&#20010;&#25110;&#22810;&#20010; <tt class="literal">include</tt>&#12290;
	   		&#27599;&#19968;&#20010;&#25351;&#23450;&#20102;&#19968;&#31181;&#21629;&#21517;&#26684;&#24335;&#65292;&#21482;&#26377;bean&#21629;&#21517;&#33267;&#23569;&#31526;&#21512;&#20854;&#20013;&#19968;&#31181;&#24773;&#20917;&#19979;&#25165;&#20250;&#20351;&#29992;Spring AOP&#33258;&#21160;&#20195;&#29702;&#37197;&#32622;&#65306;
	   		</p><pre class="programlisting">&lt;aop:aspectj-autoproxy&gt;
  &lt;include name="thisBean"/&gt;
  &lt;include name="thatBean"/&gt;
&lt;/aop:aspectj-autoproxy&gt;</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="aop-aj-ltw"></a>6.7.4.&nbsp;&#22312;Spring&#24212;&#29992;&#20013;&#20351;&#29992;AspectJ Load-time weaving&#65288;LTW&#65289;</h3></div></div><div></div></div><p>
			Load-time weaving&#65288;LTW&#65289;&#25351;&#30340;&#26159;&#22312;&#34394;&#25311;&#26426;&#36733;&#20837;&#23383;&#33410;&#30721;&#25991;&#20214;&#26102;&#21160;&#24577;&#32455;&#20837;AspectJ&#20999;&#38754;&#12290;
			&#20851;&#20110;LTW&#30340;&#35814;&#32454;&#20449;&#24687;&#65292;&#35831;&#26597;&#30475;<a href="http://www.eclipse.org/aspectj/doc/released/devguide/ltw.html" target="_top">
			LTW section of the AspectJ Development Environment Guide</a>&#12290;
			&#22312;&#36825;&#37324;&#25105;&#20204;&#37325;&#28857;&#26469;&#30475;&#19968;&#19979;Java 5&#29615;&#22659;&#19979;Spring&#24212;&#29992;&#22914;&#20309;&#37197;&#32622;LTW&#12290;
			</p><p>
			LTW&#38656;&#35201;&#23450;&#20041;&#19968;&#20010; <tt class="literal">aop.xml</tt>&#65292;&#24182;&#23558;&#20854;&#32622;&#20110;META-INF&#30446;&#24405;&#12290;
			AspectJ&#20250;&#33258;&#21160;&#26597;&#25214;&#25152;&#26377;&#21487;&#35265;&#30340;classpath&#19979;&#30340;META-INF/aop.xml&#25991;&#20214;&#65292;&#24182;&#19988;&#36890;&#36807;&#23450;&#20041;&#20869;&#23481;&#30340;&#21512;&#38598;&#26469;&#37197;&#32622;&#33258;&#36523;&#12290;
			</p><p>&#19968;&#20010;&#22522;&#26412;&#30340;META-INF/aop.xml&#25991;&#20214;&#24212;&#35813;&#22914;&#19979;&#25152;&#31034;&#65306;</p><pre class="programlisting">&lt;!DOCTYPE aspectj PUBLIC
  "-//AspectJ//DTD//EN"	"http://www.eclipse.org/aspectj/dtd/aspectj.dtd"&gt;

&lt;aspectj&gt;
   &lt;weaver&gt;
	 &lt;include within="com.xyz.myapp..*"/&gt;
   &lt;/weaver&gt;
&lt;/aspectj&gt;</pre><p>
			'<tt class="literal">include</tt>'&#30340;&#20869;&#23481;&#21578;&#35785;AspectJ&#37027;&#20123;&#31867;&#22411;&#38656;&#35201;&#34987;&#32435;&#20837;&#32455;&#20837;&#36807;&#31243;&#12290;&#20351;&#29992;&#21253;&#21517;&#21069;&#32512;&#24182;&#21152;&#19978;"..*"&#65288;&#34920;&#31034;&#35813;&#23376;&#21253;&#20013;&#30340;&#25152;&#26377;&#31867;&#22411;&#65289;&#26159;&#19968;&#20010;&#19981;&#38169;&#30340;&#40664;&#35748;&#35774;&#23450;&#12290;
			&#20351;&#29992;include&#20803;&#32032;&#26159;&#38750;&#24120;&#37325;&#35201;&#30340;&#65292;&#19981;&#28982;AspectJ&#20250;&#26597;&#25214;&#27599;&#19968;&#20010;&#24212;&#29992;&#37324;&#38754;&#29992;&#21040;&#30340;&#31867;&#22411;&#65288;&#21253;&#25324;Spring&#30340;&#24211;&#21644;&#20854;&#23427;&#35768;&#22810;&#30456;&#20851;&#24211;&#65289;&#12290;&#36890;&#24120;&#20320;&#24182;&#19981;&#24076;&#26395;&#32455;&#20837;&#36825;&#20123;&#31867;&#22411;&#24182;&#19988;&#19981;&#24895;&#24847;&#25215;&#25285;AspectJ&#23581;&#35797;&#21435;&#21305;&#37197;&#30340;&#24320;&#38144;&#12290;
			</p><p>&#24076;&#26395;&#22312;&#26085;&#24535;&#20013;&#35760;&#24405;LTW&#30340;&#27963;&#21160;&#65292;&#35831;&#28155;&#21152;&#22914;&#19979;&#36873;&#39033;&#65306;</p><pre class="programlisting">&lt;!DOCTYPE aspectj PUBLIC
  "-//AspectJ//DTD//EN"	"http://www.eclipse.org/aspectj/dtd/aspectj.dtd"&gt;

&lt;aspectj&gt;
   &lt;weaver
	 options="-showWeaveInfo,
			  -XmessageHandlerClass:org.springframework.aop.aspectj.AspectJWeaverMessageHandler"&gt;
	 &lt;include within="com.xyz.myapp..*"/&gt;
   &lt;/weaver&gt;
&lt;/aspectj&gt;</pre><p>
			&#26368;&#21518;&#65292;&#22914;&#26524;&#24076;&#26395;&#31934;&#30830;&#30340;&#25511;&#21046;&#20351;&#29992;&#21738;&#20123;&#20999;&#38754;&#65292;&#21487;&#20197;&#20351;&#29992; <tt class="literal">aspects</tt>&#12290;
			&#40664;&#35748;&#24773;&#20917;&#19979;&#25152;&#26377;&#23450;&#20041;&#30340;&#20999;&#38754;&#37117;&#23558;&#34987;&#32455;&#20837;&#65288;spring-aspects.jar&#21253;&#21547;&#20102;META-INF/aop.xml&#65292;&#23450;&#20041;&#20102;&#37197;&#32622;&#31649;&#29702;&#21644;&#20107;&#21153;&#31649;&#29702;&#20999;&#38754;&#65289;&#12290;
			&#22914;&#26524;&#20320;&#22312;&#20351;&#29992;spring-aspects.jar&#65292;&#20294;&#26159;&#21482;&#24076;&#26395;&#20351;&#29992;&#37197;&#21046;&#31649;&#29702;&#20999;&#38754;&#32780;&#19981;&#38656;&#35201;&#20107;&#21153;&#31649;&#29702;&#30340;&#35805;&#65292;&#20320;&#21487;&#20197;&#20687;&#19979;&#38754;&#37027;&#26679;&#23450;&#20041;&#65306;
			</p><pre class="programlisting">&lt;!DOCTYPE aspectj PUBLIC
  "-//AspectJ//DTD//EN"	"http://www.eclipse.org/aspectj/dtd/aspectj.dtd"&gt;

&lt;aspectj&gt;
   &lt;aspects&gt;
	  &lt;include within="org.springframework.beans.factory.aspectj.AnnotationBeanConfigurerAspect"/&gt;
   &lt;/aspects&gt;
   &lt;weaver
	 options="-showWeaveInfo,-XmessageHandlerClass:org.springframework.aop.aspectj.AspectJWeaverMessageHandler"&gt;
	 &lt;include within="com.xyz.myapp..*"/&gt;
   &lt;/weaver&gt;
&lt;/aspectj&gt;</pre><p>&#22312;Java 5&#24179;&#21488;&#19979;&#65292;LTW&#21487;&#20197;&#36890;&#36807;&#34394;&#25311;&#26426;&#30340;&#21442;&#25968;&#26469;&#21551;&#29992;&#12290;</p><pre class="programlisting">-javaagent:&lt;path-to-ajlibs&gt;/aspectjweaver.jar</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="aop-resources"></a>6.8.&nbsp;&#20854;&#23427;&#36164;&#28304;</h2></div></div><div></div></div><p>&#26356;&#22810;&#20851;&#20110;AspectJ&#30340;&#20449;&#24687;&#21487;&#20197;&#26597;&#30475; <a href="http://www.eclipse.org/aspectj" target="_top">AspectJ home page</a>&#12290;</p><p>
			<span class="emphasis"><em>Eclipse AspectJ</em></span> by Adrian Colyer et. al. (Addison-Wesley, 2005)&#20840;&#38754;&#20171;&#32461;&#24182;&#25552;&#20379;&#20102;AspectJ&#35821;&#35328;&#21442;&#32771;&#12290;</p><p>
			<span class="emphasis"><em>AspectJ in Action</em></span> by Ramnivas Laddad (Manning, 2003)&#26159;&#19968;&#26412;&#38750;&#24120;&#20986;&#33394;&#20171;&#32461;AOP&#30340;&#20070;&#31821;&#65307;&#20840;&#20070;&#30528;&#37325;&#20171;&#32461;&#20102;AspectJ&#65292;&#20294;&#20063;&#23545;&#19968;&#20123;&#36890;&#29992;&#30340;AOP&#22330;&#26223;&#36827;&#34892;&#20102;&#27604;&#36739;&#28145;&#20837;&#30340;&#30740;&#31350;&#12290;</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="validation.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="pt01.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="aop-api.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;5.&nbsp;&#23646;&#24615;&#32534;&#36753;&#22120;&#65292;&#25968;&#25454;&#32465;&#23450;&#65292;&#26657;&#39564;&#19982;BeanWrapper&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;7.&nbsp;Spring AOP APIs</td></tr></table></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" style="background-color:#31430f;border:none;height:50px;border:1px solid black;text-align:center"><table cellspacing="0" cellpadding="0" width="100%" style="margin: 0px; padding: 0px"><tr><td width="50%" style="font-size: 110%; color: white; vertical-align: center; text-align: right">
        				Sponsored by
        			</td><td width="50%" style="padding: 0px"><a style="border:none;background: url();" href="http://www.interface21.com/" title="Brought to you by Interface21"><img style="border: none" src="images/interface21.gif"></a></td></tr></table></div></body>
<!-- Mirrored from www.redsaga.com/spring_ref/2.0RC2/html/aop.html by HTTrack Website Copier/3.x [XR&CO'2005], Tue, 17 Oct 2006 16:56:31 GMT -->
</html>
